# ForumKit 腳本目錄

這個目錄包含了 ForumKit 的核心運維腳本，提供三種不同級別的重啟和重建功能。

## 🎯 核心腳本

### 1. 🚀 `daily_restart.sh` - 日常重啟腳本
**功能**: 服務重啟 -> 健康檢查 -> 狀態驗證  
**適用**: 日常維護，不變更任何檔案，僅重啟服務  
**特點**: 
- 輕量級操作，執行速度快
- 不影響資料庫和檔案
- 適合定期維護和故障排除
- 可設置為 cron job 自動執行

**使用場景**:
- 定期系統維護
- 服務異常重啟
- 記憶體清理
- 配置重新載入

### 2. 🔨 `maintenance_restart.sh` - 維護重啟腳本
**功能**: 前後端重建 -> 資料庫保留 -> 服務重啟 -> 健康檢查  
**適用**: 維護環境，不動資料庫，僅重建前後端服務  
**特點**:
- 重建前後端容器和映像
- 自動保護資料庫資料
- 清理舊容器和網路
- 保留所有用戶數據

**使用場景**:
- 代碼更新後部署
- 容器映像更新
- 系統維護升級
- 故障修復後重啟

### 3. 🧹 `development_rebuild.sh` - 開發建制腳本
**功能**: 清理 -> 建置 -> 部署 -> 初始化 -> 驗證  
**適用**: 開發環境的乾淨重建，刪檔重新建制，清除所有數據重新開始  
**特點**:
- 完全清理所有數據和檔案
- 重新建置所有服務
- 初始化資料庫結構
- 適合開發測試環境

**使用場景**:
- 開發環境重置
- 測試環境清理
- 重大問題排查
- 全新環境部署

## 📊 腳本對比

| 腳本 | 數據保留 | 檔案變更 | 執行時間 | 風險等級 | 適用場景 |
|------|----------|----------|----------|----------|----------|
| `daily_restart.sh` | ✅ 完全保留 | ❌ 無變更 | 快 (2-3分鐘) | 🟢 低 | 日常維護 |
| `maintenance_restart.sh` | ✅ 資料庫保留 | ⚠️ 容器重建 | 中 (5-10分鐘) | 🟡 中 | 系統維護 |
| `development_rebuild.sh` | ❌ 完全清理 | ✅ 全部重建 | 慢 (15-30分鐘) | 🔴 高 | 開發重置 |

## 🚀 使用方法

### 基本執行
```bash
# 進入腳本目錄
cd scripts

# 執行腳本
./daily_restart.sh
./maintenance_restart.sh
./development_rebuild.sh
```

### 環境變數配置
```bash
# 設定專案根目錄
export PROJECT_ROOT="/path/to/ForumKit"

# 執行腳本
./daily_restart.sh
```

### 權限設定
```bash
# 給予執行權限
chmod +x *.sh

# 檢查權限
ls -la *.sh
```

## ⚠️ 注意事項

### 1. 執行前準備
- 確認當前工作目錄為 ForumKit 根目錄
- 檢查 Docker 和 Docker Compose 是否正常運行
- 確認有足夠的磁碟空間
- 備份重要數據（特別是使用 development_rebuild.sh 時）

### 2. 風險控制
- **daily_restart.sh**: 最安全，可隨時執行
- **maintenance_restart.sh**: 中等風險，建議在維護時間執行
- **development_rebuild.sh**: 高風險，會清除所有數據，僅在開發環境使用

### 3. 故障排除
- 檢查 Docker 服務狀態: `systemctl status docker`
- 檢查磁碟空間: `df -h`
- 查看容器日誌: `docker compose logs`
- 檢查腳本執行權限: `ls -la *.sh`

## 🔧 自訂配置

### 修改等待時間
```bash
# 在腳本中調整等待時間
WAIT_TIME=30  # 秒
```

### 修改備份目錄
```bash
# 設定自訂備份目錄
export BACKUP_DIR="/custom/backup/path"
```

### 啟用詳細日誌
```bash
# 設定詳細日誌輸出
export VERBOSE=1
```

## 📞 技術支援

如果在使用腳本時遇到問題：

1. 檢查腳本執行權限和依賴
2. 查看錯誤信息和退出碼
3. 檢查系統資源和 Docker 狀態
4. 參考腳本中的故障排除建議
5. 透過平台內建支援系統尋求協助

---

**注意**: 這些腳本設計用於 ForumKit 專案，請勿在其他專案中使用。執行前請務必了解腳本的功能和風險。
