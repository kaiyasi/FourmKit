# ForumKit V1.4.0 - æª”æ¡ˆæ•´ç†èˆ‡æ¸…ç†

## ç‰ˆæœ¬æ¦‚è¿°

ForumKit V1.4.0 æ˜¯ä¸€å€‹é‡è¦çš„æ¶æ§‹é‡æ§‹ç‰ˆæœ¬ï¼Œä¸»è¦å°ˆæ³¨æ–¼ç³»çµ±æ¸…ç†ã€å¤šè³‡æ–™åº«æ¶æ§‹å¯¦æ–½å’Œæ–‡æª”çµæ§‹é‡æ•´ã€‚æœ¬ç‰ˆæœ¬ç§»é™¤äº† Instagram æ•´åˆç³»çµ±ï¼Œå¯¦æ–½äº†æœå‹™åˆ†é›¢çš„å¤šè³‡æ–™åº«æ¶æ§‹ï¼Œä¸¦é‡æ–°æ•´ç†äº†æ•´å€‹æ–‡æª”ç³»çµ±ã€‚

## ä¸»è¦è®Šæ›´

### 1. Instagram æœå‹™ç§»é™¤

#### 1.1 åŠŸèƒ½æ¸…ç†
- **å®Œå…¨ç§»é™¤ Instagram ç›¸é—œåŠŸèƒ½å’Œç¨‹å¼ç¢¼**
- ç§»é™¤ `routes/routes_cdn.py` ä¸­çš„ Instagram é è¦½è·¯ç”±
- ç§»é™¤ `utils/sanitize.py` ä¸­çš„ Instagram ç‰¹å®šè¨»è§£
- æ›´æ–° `check_db_state.py` å’Œ `update_to_latest.py`
- æ¸…ç† `app.py` ä¸­çš„ Instagram è¨»è§£

#### 1.2 å½±éŸ¿ç¯„åœ
- ç”¨æˆ¶ç„¡æ³•å†ä½¿ç”¨ Instagram è‡ªå‹•ç™¼å¸ƒåŠŸèƒ½
- ç®¡ç†å¾Œå°ç§»é™¤ Instagram ç®¡ç†é é¢
- ç›¸é—œçš„ API ç«¯é»å’Œè³‡æ–™åº«è¡¨è¢«ç§»é™¤
- æ¨¡æ¿ç³»çµ±å’Œæ¬Šæ–ç®¡ç†åŠŸèƒ½åœç”¨

### 2. å¤šè³‡æ–™åº«æ¶æ§‹å¯¦æ–½

#### 2.1 æ¶æ§‹è¨­è¨ˆ
- **æœå‹™åˆ†é›¢çš„å¤šè³‡æ–™åº«ç³»çµ±**
- æ ¸å¿ƒåŠŸèƒ½ (forumkit_core.db)
- æ”¯æ´ç³»çµ± (forumkit_support.db)
- èŠå¤©å®¤ (forumkit_chat.db)
- å¯©æ ¸ç®¡ç† (forumkit_moderation.db)
- çµ„ç¹”ç®¡ç† (forumkit_organization.db)

#### 2.2 æŠ€è¡“å¯¦ç¾
- æ–°å¢ `utils/multi_db.py` å’Œ `utils/db_multi.py` å¤šè³‡æ–™åº«ç®¡ç†
- æ–°å¢ `init_multi_db.py` è³‡æ–™åº«åˆå§‹åŒ–è…³æœ¬
- æ–°å¢ `scripts/migrate_to_multi_db.py` é·ç§»è…³æœ¬
- æ›´æ–°è³‡æ–™åº«ç‰ˆæœ¬æ¨™è­˜ç‚º `2025_09_02_remove_instagram_system`

#### 2.3 å„ªå‹¢
- æœå‹™é–“éš”é›¢ï¼Œæé«˜ç³»çµ±ç©©å®šæ€§
- è³‡æ–™åº«æ€§èƒ½å„ªåŒ–ï¼Œæ”¯æ´ä¸¦ç™¼è¨ªå•
- ä¾¿æ–¼ç¶­è­·å’Œæ“´å±•
- é™ä½å–®é»æ•…éšœé¢¨éšª

### 3. æ–‡æª”çµæ§‹é‡æ•´

#### 3.1 ç›®éŒ„é‡çµ„
- é‡æ–°æ•´ç† `documentation/` è³‡æ–™å¤¾çµæ§‹
- åˆ†é¡è‡³ `features/`, `architecture/`, `guides/`, `versions/`
- èˆŠæ–‡æª”æ­¸æª”è‡³ `documentation_archive/`

#### 3.2 æ–‡æª”åˆ†é¡
- **features/**: åŠŸèƒ½èªªæ˜æ–‡æª”
- **architecture/**: ç³»çµ±æ¶æ§‹æ–‡æª”
- **guides/**: ä½¿ç”¨æŒ‡å—å’Œé–‹ç™¼æŒ‡å—
- **versions/**: ç‰ˆæœ¬è¨˜éŒ„å’Œå‡ç´šæŒ‡å—

### 4. ç³»çµ±å„ªåŒ–

#### 4.1 è³‡æ–™åº«å„ªåŒ–
- è³‡æ–™åº«é€£æ¥æ± å„ªåŒ–
- è‡ªå‹•å‚™ä»½æ©Ÿåˆ¶æ”¹å–„
- ç³»çµ±ç›£æ§å¢å¼·
- éŒ¯èª¤è¿½è¹¤æ”¹é€²

#### 4.2 æ€§èƒ½æå‡
- å¤šè³‡æ–™åº«ä¸¦ç™¼è¨ªå•
- æŸ¥è©¢æ€§èƒ½å„ªåŒ–
- è¨˜æ†¶é«”ä½¿ç”¨å„ªåŒ–
- å•Ÿå‹•æ™‚é–“ç¸®çŸ­

## æŠ€è¡“å¯¦ç¾

### 1. å¤šè³‡æ–™åº«ç®¡ç†

#### 1.1 æ ¸å¿ƒæ¨¡çµ„
```python
# utils/multi_db.py
class MultiDatabaseManager:
    def __init__(self):
        self.databases = {}
        self.connections = {}
    
    def init_database(self, name, config):
        # åˆå§‹åŒ–æŒ‡å®šè³‡æ–™åº«
        
    def get_connection(self, name):
        # ç²å–è³‡æ–™åº«é€£æ¥
        
    def close_all(self):
        # é—œé–‰æ‰€æœ‰é€£æ¥
```

#### 1.2 è³‡æ–™åº«é…ç½®
```python
# è³‡æ–™åº«é…ç½®ç¤ºä¾‹
DATABASES = {
    'core': {
        'url': 'sqlite:///forumkit_core.db',
        'echo': False
    },
    'support': {
        'url': 'sqlite:///forumkit_support.db',
        'echo': False
    },
    'chat': {
        'url': 'sqlite:///forumkit_chat.db',
        'echo': False
    }
}
```

### 2. é·ç§»è…³æœ¬

#### 2.1 åˆå§‹åŒ–è…³æœ¬
```bash
# init_multi_db.py
python init_multi_db.py --create-all
python init_multi_db.py --migrate-data
python init_multi_db.py --verify
```

#### 2.2 é·ç§»è…³æœ¬
```bash
# migrate_to_multi_db.py
python migrate_to_multi_db.py --source single.db
python migrate_to_multi_db.py --target-dir ./databases
python migrate_to_multi_db.py --dry-run
```

## å‡ç´šæŒ‡å—

### 1. å‡ç´šå‰æº–å‚™

#### 1.1 å‚™ä»½è³‡æ–™
- å®Œæ•´å‚™ä»½ç¾æœ‰è³‡æ–™åº«
- å‚™ä»½é‡è¦é…ç½®æª”æ¡ˆ
- è¨˜éŒ„ç•¶å‰ç³»çµ±ç‹€æ…‹

#### 1.2 ç’°å¢ƒæª¢æŸ¥
- ç¢ºèª Docker å’Œ Docker Compose ç‰ˆæœ¬
- æª¢æŸ¥ç£ç¢Ÿç©ºé–“æ˜¯å¦å……è¶³
- é©—è­‰ç¶²è·¯é€£æ¥ç©©å®šæ€§

### 2. å‡ç´šæ­¥é©Ÿ

#### 2.1 åœæ­¢æœå‹™
```bash
docker compose down
```

#### 2.2 åŸ·è¡Œé·ç§»
```bash
# å‚™ä»½ç¾æœ‰è³‡æ–™
cp -r data/ data_backup_$(date +%Y%m%d_%H%M%S)/

# åŸ·è¡Œé·ç§»è…³æœ¬
python scripts/migrate_to_multi_db.py --source data/forumkit.db

# åˆå§‹åŒ–å¤šè³‡æ–™åº«
python init_multi_db.py --create-all
```

#### 2.3 é‡å•Ÿæœå‹™
```bash
docker compose up -d --build
```

### 3. å‡ç´šå¾Œé©—è­‰

#### 3.1 åŠŸèƒ½æ¸¬è©¦
- æ¸¬è©¦ç”¨æˆ¶ç™»å…¥å’Œè¨»å†Š
- é©—è­‰è²¼æ–‡ç™¼å¸ƒå’Œå¯©æ ¸
- æª¢æŸ¥æ”¯æ´å·¥å–®ç³»çµ±
- ç¢ºèªèŠå¤©å®¤åŠŸèƒ½

#### 3.2 æ€§èƒ½æª¢æŸ¥
- ç›£æ§è³‡æ–™åº«é€£æ¥ç‹€æ…‹
- æª¢æŸ¥ç³»çµ±éŸ¿æ‡‰æ™‚é–“
- é©—è­‰ä¸¦ç™¼è¨ªå•èƒ½åŠ›
- ç¢ºèªéŒ¯èª¤æ—¥èªŒæ­£å¸¸

## å·²çŸ¥å•é¡Œ

### 1. ç›¸å®¹æ€§å•é¡Œ
- èˆŠç‰ˆæœ¬çš„ Instagram ç›¸é—œåŠŸèƒ½å®Œå…¨ä¸å¯ç”¨
- éƒ¨åˆ†ç¬¬ä¸‰æ–¹æ•´åˆå¯èƒ½éœ€è¦é‡æ–°é…ç½®
- æŸäº›è‡ªè¨‚è…³æœ¬å¯èƒ½éœ€è¦æ›´æ–°

### 2. æ€§èƒ½è€ƒé‡
- å¤šè³‡æ–™åº«æ¶æ§‹åˆæœŸå¯èƒ½å¢åŠ è¨˜æ†¶é«”ä½¿ç”¨
- éœ€è¦é©ç•¶çš„é€£æ¥æ± é…ç½®
- å»ºè­°å®šæœŸç›£æ§è³‡æ–™åº«æ€§èƒ½

## æœªä¾†è¦åŠƒ

### 1. çŸ­æœŸç›®æ¨™
- å„ªåŒ–å¤šè³‡æ–™åº«æŸ¥è©¢æ€§èƒ½
- å®Œå–„ç›£æ§å’Œæ—¥èªŒç³»çµ±
- å¢å¼·éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

### 2. é•·æœŸè¦åŠƒ
- è€ƒæ…®æ”¯æ´å…¶ä»–è³‡æ–™åº«é¡å‹
- å¯¦ç¾è³‡æ–™åº«åˆ†ç‰‡åŠŸèƒ½
- é–‹ç™¼è‡ªå‹•åŒ–ç¶­è­·å·¥å…·

---

*ğŸ“… æœ€å¾Œæ›´æ–°ï¼š2025-09-03*
*ğŸ¢ é–‹ç™¼åœ˜éšŠï¼šSerelix Studio*
*ğŸ“§ æŠ€è¡“æ”¯æ´ï¼šé€éå¹³å°å…§å»ºæ”¯æ´ç³»çµ±*

---