# 開發進度

完成 - 前端基礎架構 - React + TypeScript + Tailwind CSS + Vite
完成 - 響應式主題系統 - 5種預設主題 + 深淺模式自動切換
完成 - 後端 API 框架 - Flask + Socket.IO + 事件驅動架構
完成 - 容器化部署 - Docker Compose + Nginx 反向代理 + 健康檢查
完成 - Discord 整合 - Webhook 通知 + 主題建議 + 問題回報
完成 - 安全性強化 - CORS限制 + CSP設定 + 輸入驗證 + 速率限制
完成 - Socket.IO 即時通訊 - WebSocket 連線 + 事件廣播 + 斷線重連
完成 - 開發者工具 - 顏色搭配器 + 進度追蹤 + 模式切換面板
完成 - 前端間距重構 - 統一間距管理 + 響應式佈局優化
完成 - 小裝置排版優化 - 手機/平板體驗改善 + 觸控交互優化
完成 - 檔案讀取改善 - CHANGELOG.txt 權限問題修復 + 錯誤處理強化
完成 - 登入系統 - 前端登入頁 + JWT 認證 + 模式切換保護
完成 - 無限城事件 - 修復前端渲染錯誤，避免同一貼文被無限重複顯示
開發中 - 討論區功能 - 匿名發文 + 即時回覆 + 投票系統
計畫 - 內容管理 - 文章審核 + 垃圾訊息過濾 + 備份機制
計畫 - 管理後台 - 用戶管理 + 統計分析 + 系統監控

# 開發紀錄

-2025-08-22 審核體驗強化：文章核准→媒體自動核准並移至 public；退件→媒體同步退件並嘗試刪除已公開檔案；新增管理端媒體預覽 API（支援 pending/public）
-2025-08-22 後台媒體預覽：GeneralAdminPage 改為帶授權 blob 預覽 pending 檔，public 走 /uploads；詳情滑出面板加入上一筆/下一筆與固定操作列
-2025-08-22 聊天室監看：/admin/rooms 新增房間搜尋、清空訊息（POST /api/rooms/:room/clear）、匯出 CSV；每 5 秒自動刷新選項
-2025-08-22 統一錯誤頁：新增 ErrorPage，套用於 Router 錯誤、貼文詳情與後台頁；CreatePost 未登入顯示 401 友善提示
-2025-08-22 發文規則：/mode 新增 enforce_min_post_chars 與 min_post_chars 設定；純文字受最小字數限制；with-media 可略過字數，但仍需通過型別/魔數/sanitize
-2025-08-22 Nginx 主站反代 /uploads → cdn，public 媒體以同網域提供；pending 媒體僅供管理端 API 預覽

-2025-08-21 新增 CDN 服務（Nginx）提供 uploads/public；安全標頭、阻擋危險副檔名、快取 1 週；compose 支援 CDN_PORT 覆寫
-2025-08-21 Alembic 初始遷移以 SAVEPOINT 包裹 create_table，避免 InFailedSqlTransaction；強化重複建表容忍
-2025-08-21 新增遷移：posts/media 加入 client_id/ip 欄位，支援來源追蹤；後台佇列顯示來源
-2025-08-21 解析進度：/api/progress 接受「# 開發進度 / # 開發紀錄」（允許 # 後空白）；DEV_RECORD 作備援解析
-2025-08-21 抽離 ticket 產生器至 utils.ticket，修復 routes_abuse 與 app 的循環匯入
-2025-08-21 擴權：審核佇列允許 admin/dev_admin/campus_admin/cross_admin/moderator 類型；核准/退件/日誌限各類 admin
-2025-08-21 HTTP 錯誤整合：前端 http 包裝支援 data/直傳兩種回傳；避免 queue 讀取 undefined 導致崩潰
-2025-08-21 前端導覽：Navbar 統一圖標＋文字；ModePage 加返回鈕；全域輸入框樣式隨主題變化
-2025-08-21 運維腳本：dev_full_rebuild/prod_maintenance_restart 等候就緒＋遷移 fallback；新增 scripts/diagnose_502.sh
-2025-08-21 環境變數映射：compose 將 DISCORD_THEME_WEBHOOK、DISCORD_REPORT_WEBHOOK、ALLOWED_ORIGINS、SOCKETIO_ORIGINS 傳入 backend
-2025-08-21 修正 Alembic 初始遷移在已建表情境的容忍邏輯（避免 pg_type 型別重複）；補上 posts/media 的 client_id、ip 欄位遷移；
           抽離 ticket 產生器至 utils.ticket 避免循環匯入；擴充後台審核 API 角色；
           前端 http 包裝支援直傳/包裹 data 兩種風格；Navbar 統一圖標+文字；ModePage 加返回鍵；新增 502 診斷腳本；
           強化 dev rebuild 腳本（等待就緒 + 遷移 fallback）。
-2025-08-17 重新組織專案資料夾結構，提升程式碼可維護性
-2025-08-17 整理前端組件分類（layout/ui/forms 資料夾）
-2025-08-17 重構後端路由結構（routes/config/scripts 資料夾）
-2025-08-17 移除測試用舊檔案，創建缺失的認證路由
-2025-08-17 修正所有 import 路徑引用，確保建置正常
-2025-08-17 為模式切換功能加入確認對話框
-2025-08-17 優化更新紀錄顯示格式，每條記錄獨立顯示日期
-2025-08-17 **無限城事件：修復前端渲染程式錯誤，避免同一貼文在列表/詳情中被無限重複顯示**
-2025-08-16 新增登入頁（React + Tailwind），可呼叫 `/api/auth/login`
-2025-08-16 整合 JWT token，支援 localStorage 儲存與帶入請求
-2025-08-16 模式切換與公告 API 增加權限檢查（需管理員登入）
-2025-08-16 修正前端白畫面問題，補上 Nginx 靜態資源設定
-2025-08-15 完成小裝置螢幕排版全面優化，改善手機使用體驗
-2025-08-15 重構 CHANGELOG.txt 讀取機制，解決 Docker 容器權限問題
-2025-08-15 增強錯誤處理和調試資訊，提供詳細的檔案查找記錄
-2025-08-15 優化響應式間距設計，增加更細緻的斷點控制
-2025-08-15 改善觸控交互體驗，符合無障礙設計標準
-2025-08-15 完成前端間距重構，統一使用響應式間距管理
-2025-08-15 修正 Socket.IO 導入問題，改用默認導入方式
-2025-08-15 優化開發模式首頁佈局，解決間距衝突問題
-2025-08-15 重構 JSX 結構，提升代碼可維護性
-2025-08-14 完成全面安全性檢查與強化
-2025-08-14 實施 CORS 來源限制與環境變數控制
-2025-08-14 加入 CSP、速率限制與安全標頭
-2025-08-14 優化 Docker 容器安全性（最小權限原則）
-2025-08-14 修復 Socket.IO 連線問題（改用 npm 套件）
-2025-08-14 解決 Nginx 502 錯誤與反向代理設定
-2025-08-14 修復後端 request\_id 初始化錯誤
-2025-08-14 完成維護模式 API 存取控制
-2025-08-14 恢復開發模式主題切換功能
-2025-08-14 修復顏色選擇器輸入欄位缺失
-2025-08-14 優化非 Normal 模式下的導航列隱藏
-2025-08-14 修復 CHANGELOG.txt 權限問題與預設資料機制
-2025-08-13 完成開發模式介面設計
-2025-08-13 實現顏色搭配器功能
-2025-08-13 修復 Docker 權限問題

