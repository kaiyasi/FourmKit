(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))i(d);new MutationObserver(d=>{for(const u of d)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function l(d){const u={};return d.integrity&&(u.integrity=d.integrity),d.referrerPolicy&&(u.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?u.credentials="include":d.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(d){if(d.ep)return;d.ep=!0;const u=l(d);fetch(d.href,u)}})();function cf(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var yc={exports:{}},Oa={},vc={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rh;function mg(){if(rh)return Oe;rh=1;var s=Symbol.for("react.element"),a=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.iterator;function j(T){return T===null||typeof T!="object"?null:(T=b&&T[b]||T["@@iterator"],typeof T=="function"?T:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,E={};function S(T,K,fe){this.props=T,this.context=K,this.refs=E,this.updater=fe||R}S.prototype.isReactComponent={},S.prototype.setState=function(T,K){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,K,"setState")},S.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function k(){}k.prototype=S.prototype;function C(T,K,fe){this.props=T,this.context=K,this.refs=E,this.updater=fe||R}var N=C.prototype=new k;N.constructor=C,M(N,S.prototype),N.isPureReactComponent=!0;var O=Array.isArray,B=Object.prototype.hasOwnProperty,w={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function A(T,K,fe){var ge,Re={},Ee=null,$e=null;if(K!=null)for(ge in K.ref!==void 0&&($e=K.ref),K.key!==void 0&&(Ee=""+K.key),K)B.call(K,ge)&&!I.hasOwnProperty(ge)&&(Re[ge]=K[ge]);var Ie=arguments.length-2;if(Ie===1)Re.children=fe;else if(1<Ie){for(var de=Array(Ie),be=0;be<Ie;be++)de[be]=arguments[be+2];Re.children=de}if(T&&T.defaultProps)for(ge in Ie=T.defaultProps,Ie)Re[ge]===void 0&&(Re[ge]=Ie[ge]);return{$$typeof:s,type:T,key:Ee,ref:$e,props:Re,_owner:w.current}}function J(T,K){return{$$typeof:s,type:T.type,key:K,ref:T.ref,props:T.props,_owner:T._owner}}function ae(T){return typeof T=="object"&&T!==null&&T.$$typeof===s}function Y(T){var K={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(fe){return K[fe]})}var Z=/\/+/g;function V(T,K){return typeof T=="object"&&T!==null&&T.key!=null?Y(""+T.key):K.toString(36)}function $(T,K,fe,ge,Re){var Ee=typeof T;(Ee==="undefined"||Ee==="boolean")&&(T=null);var $e=!1;if(T===null)$e=!0;else switch(Ee){case"string":case"number":$e=!0;break;case"object":switch(T.$$typeof){case s:case a:$e=!0}}if($e)return $e=T,Re=Re($e),T=ge===""?"."+V($e,0):ge,O(Re)?(fe="",T!=null&&(fe=T.replace(Z,"$&/")+"/"),$(Re,K,fe,"",function(be){return be})):Re!=null&&(ae(Re)&&(Re=J(Re,fe+(!Re.key||$e&&$e.key===Re.key?"":(""+Re.key).replace(Z,"$&/")+"/")+T)),K.push(Re)),1;if($e=0,ge=ge===""?".":ge+":",O(T))for(var Ie=0;Ie<T.length;Ie++){Ee=T[Ie];var de=ge+V(Ee,Ie);$e+=$(Ee,K,fe,de,Re)}else if(de=j(T),typeof de=="function")for(T=de.call(T),Ie=0;!(Ee=T.next()).done;)Ee=Ee.value,de=ge+V(Ee,Ie++),$e+=$(Ee,K,fe,de,Re);else if(Ee==="object")throw K=String(T),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return $e}function z(T,K,fe){if(T==null)return T;var ge=[],Re=0;return $(T,ge,"","",function(Ee){return K.call(fe,Ee,Re++)}),ge}function q(T){if(T._status===-1){var K=T._result;K=K(),K.then(function(fe){(T._status===0||T._status===-1)&&(T._status=1,T._result=fe)},function(fe){(T._status===0||T._status===-1)&&(T._status=2,T._result=fe)}),T._status===-1&&(T._status=0,T._result=K)}if(T._status===1)return T._result.default;throw T._result}var se={current:null},G={transition:null},re={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:G,ReactCurrentOwner:w};function ee(){throw Error("act(...) is not supported in production builds of React.")}return Oe.Children={map:z,forEach:function(T,K,fe){z(T,function(){K.apply(this,arguments)},fe)},count:function(T){var K=0;return z(T,function(){K++}),K},toArray:function(T){return z(T,function(K){return K})||[]},only:function(T){if(!ae(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},Oe.Component=S,Oe.Fragment=l,Oe.Profiler=d,Oe.PureComponent=C,Oe.StrictMode=i,Oe.Suspense=x,Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,Oe.act=ee,Oe.cloneElement=function(T,K,fe){if(T==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+T+".");var ge=M({},T.props),Re=T.key,Ee=T.ref,$e=T._owner;if(K!=null){if(K.ref!==void 0&&(Ee=K.ref,$e=w.current),K.key!==void 0&&(Re=""+K.key),T.type&&T.type.defaultProps)var Ie=T.type.defaultProps;for(de in K)B.call(K,de)&&!I.hasOwnProperty(de)&&(ge[de]=K[de]===void 0&&Ie!==void 0?Ie[de]:K[de])}var de=arguments.length-2;if(de===1)ge.children=fe;else if(1<de){Ie=Array(de);for(var be=0;be<de;be++)Ie[be]=arguments[be+2];ge.children=Ie}return{$$typeof:s,type:T.type,key:Re,ref:Ee,props:ge,_owner:$e}},Oe.createContext=function(T){return T={$$typeof:f,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},T.Provider={$$typeof:u,_context:T},T.Consumer=T},Oe.createElement=A,Oe.createFactory=function(T){var K=A.bind(null,T);return K.type=T,K},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(T){return{$$typeof:p,render:T}},Oe.isValidElement=ae,Oe.lazy=function(T){return{$$typeof:v,_payload:{_status:-1,_result:T},_init:q}},Oe.memo=function(T,K){return{$$typeof:g,type:T,compare:K===void 0?null:K}},Oe.startTransition=function(T){var K=G.transition;G.transition={};try{T()}finally{G.transition=K}},Oe.unstable_act=ee,Oe.useCallback=function(T,K){return se.current.useCallback(T,K)},Oe.useContext=function(T){return se.current.useContext(T)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(T){return se.current.useDeferredValue(T)},Oe.useEffect=function(T,K){return se.current.useEffect(T,K)},Oe.useId=function(){return se.current.useId()},Oe.useImperativeHandle=function(T,K,fe){return se.current.useImperativeHandle(T,K,fe)},Oe.useInsertionEffect=function(T,K){return se.current.useInsertionEffect(T,K)},Oe.useLayoutEffect=function(T,K){return se.current.useLayoutEffect(T,K)},Oe.useMemo=function(T,K){return se.current.useMemo(T,K)},Oe.useReducer=function(T,K,fe){return se.current.useReducer(T,K,fe)},Oe.useRef=function(T){return se.current.useRef(T)},Oe.useState=function(T){return se.current.useState(T)},Oe.useSyncExternalStore=function(T,K,fe){return se.current.useSyncExternalStore(T,K,fe)},Oe.useTransition=function(){return se.current.useTransition()},Oe.version="18.3.1",Oe}var sh;function sd(){return sh||(sh=1,vc.exports=mg()),vc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nh;function hg(){if(nh)return Oa;nh=1;var s=sd(),a=Symbol.for("react.element"),l=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,d=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function f(p,x,g){var v,b={},j=null,R=null;g!==void 0&&(j=""+g),x.key!==void 0&&(j=""+x.key),x.ref!==void 0&&(R=x.ref);for(v in x)i.call(x,v)&&!u.hasOwnProperty(v)&&(b[v]=x[v]);if(p&&p.defaultProps)for(v in x=p.defaultProps,x)b[v]===void 0&&(b[v]=x[v]);return{$$typeof:a,type:p,key:j,ref:R,props:b,_owner:d.current}}return Oa.Fragment=l,Oa.jsx=f,Oa.jsxs=f,Oa}var ah;function fg(){return ah||(ah=1,yc.exports=hg()),yc.exports}var t=fg(),h=sd();const pg=cf(h);var lo={},bc={exports:{}},Yt={},jc={exports:{}},wc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lh;function xg(){return lh||(lh=1,(function(s){function a(G,re){var ee=G.length;G.push(re);e:for(;0<ee;){var T=ee-1>>>1,K=G[T];if(0<d(K,re))G[T]=re,G[ee]=K,ee=T;else break e}}function l(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var re=G[0],ee=G.pop();if(ee!==re){G[0]=ee;e:for(var T=0,K=G.length,fe=K>>>1;T<fe;){var ge=2*(T+1)-1,Re=G[ge],Ee=ge+1,$e=G[Ee];if(0>d(Re,ee))Ee<K&&0>d($e,Re)?(G[T]=$e,G[Ee]=ee,T=Ee):(G[T]=Re,G[ge]=ee,T=ge);else if(Ee<K&&0>d($e,ee))G[T]=$e,G[Ee]=ee,T=Ee;else break e}}return re}function d(G,re){var ee=G.sortIndex-re.sortIndex;return ee!==0?ee:G.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var f=Date,p=f.now();s.unstable_now=function(){return f.now()-p}}var x=[],g=[],v=1,b=null,j=3,R=!1,M=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(G){for(var re=l(g);re!==null;){if(re.callback===null)i(g);else if(re.startTime<=G)i(g),re.sortIndex=re.expirationTime,a(x,re);else break;re=l(g)}}function O(G){if(E=!1,N(G),!M)if(l(x)!==null)M=!0,q(B);else{var re=l(g);re!==null&&se(O,re.startTime-G)}}function B(G,re){M=!1,E&&(E=!1,k(A),A=-1),R=!0;var ee=j;try{for(N(re),b=l(x);b!==null&&(!(b.expirationTime>re)||G&&!Y());){var T=b.callback;if(typeof T=="function"){b.callback=null,j=b.priorityLevel;var K=T(b.expirationTime<=re);re=s.unstable_now(),typeof K=="function"?b.callback=K:b===l(x)&&i(x),N(re)}else i(x);b=l(x)}if(b!==null)var fe=!0;else{var ge=l(g);ge!==null&&se(O,ge.startTime-re),fe=!1}return fe}finally{b=null,j=ee,R=!1}}var w=!1,I=null,A=-1,J=5,ae=-1;function Y(){return!(s.unstable_now()-ae<J)}function Z(){if(I!==null){var G=s.unstable_now();ae=G;var re=!0;try{re=I(!0,G)}finally{re?V():(w=!1,I=null)}}else w=!1}var V;if(typeof C=="function")V=function(){C(Z)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,z=$.port2;$.port1.onmessage=Z,V=function(){z.postMessage(null)}}else V=function(){S(Z,0)};function q(G){I=G,w||(w=!0,V())}function se(G,re){A=S(function(){G(s.unstable_now())},re)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(G){G.callback=null},s.unstable_continueExecution=function(){M||R||(M=!0,q(B))},s.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<G?Math.floor(1e3/G):5},s.unstable_getCurrentPriorityLevel=function(){return j},s.unstable_getFirstCallbackNode=function(){return l(x)},s.unstable_next=function(G){switch(j){case 1:case 2:case 3:var re=3;break;default:re=j}var ee=j;j=re;try{return G()}finally{j=ee}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(G,re){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ee=j;j=G;try{return re()}finally{j=ee}},s.unstable_scheduleCallback=function(G,re,ee){var T=s.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?T+ee:T):ee=T,G){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ee+K,G={id:v++,callback:re,priorityLevel:G,startTime:ee,expirationTime:K,sortIndex:-1},ee>T?(G.sortIndex=ee,a(g,G),l(x)===null&&G===l(g)&&(E?(k(A),A=-1):E=!0,se(O,ee-T))):(G.sortIndex=K,a(x,G),M||R||(M=!0,q(B))),G},s.unstable_shouldYield=Y,s.unstable_wrapCallback=function(G){var re=j;return function(){var ee=j;j=re;try{return G.apply(this,arguments)}finally{j=ee}}}})(wc)),wc}var oh;function gg(){return oh||(oh=1,jc.exports=xg()),jc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ih;function yg(){if(ih)return Yt;ih=1;var s=sd(),a=gg();function l(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)r+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,d={};function u(e,r){f(e,r),f(e+"Capture",r)}function f(e,r){for(d[e]=r,e=0;e<r.length;e++)i.add(r[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},b={};function j(e){return x.call(b,e)?!0:x.call(v,e)?!1:g.test(e)?b[e]=!0:(v[e]=!0,!1)}function R(e,r,n,o){if(n!==null&&n.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function M(e,r,n,o){if(r===null||typeof r>"u"||R(e,r,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function E(e,r,n,o,c,m,y){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=o,this.attributeNamespace=c,this.mustUseProperty=n,this.propertyName=e,this.type=r,this.sanitizeURL=m,this.removeEmptyString=y}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){S[e]=new E(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];S[r]=new E(r,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){S[e]=new E(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){S[e]=new E(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){S[e]=new E(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){S[e]=new E(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){S[e]=new E(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){S[e]=new E(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){S[e]=new E(e,5,!1,e.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function C(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(k,C);S[r]=new E(r,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(k,C);S[r]=new E(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(k,C);S[r]=new E(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){S[e]=new E(e,1,!1,e.toLowerCase(),null,!1,!1)}),S.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){S[e]=new E(e,1,!1,e.toLowerCase(),null,!0,!0)});function N(e,r,n,o){var c=S.hasOwnProperty(r)?S[r]:null;(c!==null?c.type!==0:o||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(M(r,n,c,o)&&(n=null),o||c===null?j(r)&&(n===null?e.removeAttribute(r):e.setAttribute(r,""+n)):c.mustUseProperty?e[c.propertyName]=n===null?c.type===3?!1:"":n:(r=c.attributeName,o=c.attributeNamespace,n===null?e.removeAttribute(r):(c=c.type,n=c===3||c===4&&n===!0?"":""+n,o?e.setAttributeNS(o,r,n):e.setAttribute(r,n))))}var O=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=Symbol.for("react.element"),w=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),ae=Symbol.for("react.provider"),Y=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),se=Symbol.for("react.offscreen"),G=Symbol.iterator;function re(e){return e===null||typeof e!="object"?null:(e=G&&e[G]||e["@@iterator"],typeof e=="function"?e:null)}var ee=Object.assign,T;function K(e){if(T===void 0)try{throw Error()}catch(n){var r=n.stack.trim().match(/\n( *(at )?)/);T=r&&r[1]||""}return`
`+T+e}var fe=!1;function ge(e,r){if(!e||fe)return"";fe=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(Q){var o=Q}Reflect.construct(e,[],r)}else{try{r.call()}catch(Q){o=Q}e.call(r.prototype)}else{try{throw Error()}catch(Q){o=Q}e()}}catch(Q){if(Q&&o&&typeof Q.stack=="string"){for(var c=Q.stack.split(`
`),m=o.stack.split(`
`),y=c.length-1,_=m.length-1;1<=y&&0<=_&&c[y]!==m[_];)_--;for(;1<=y&&0<=_;y--,_--)if(c[y]!==m[_]){if(y!==1||_!==1)do if(y--,_--,0>_||c[y]!==m[_]){var P=`
`+c[y].replace(" at new "," at ");return e.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",e.displayName)),P}while(1<=y&&0<=_);break}}}finally{fe=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?K(e):""}function Re(e){switch(e.tag){case 5:return K(e.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return e=ge(e.type,!1),e;case 11:return e=ge(e.type.render,!1),e;case 1:return e=ge(e.type,!0),e;default:return""}}function Ee(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case I:return"Fragment";case w:return"Portal";case J:return"Profiler";case A:return"StrictMode";case V:return"Suspense";case $:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Y:return(e.displayName||"Context")+".Consumer";case ae:return(e._context.displayName||"Context")+".Provider";case Z:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case z:return r=e.displayName||null,r!==null?r:Ee(e.type)||"Memo";case q:r=e._payload,e=e._init;try{return Ee(e(r))}catch{}}return null}function $e(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ee(r);case 8:return r===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ie(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function de(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function be(e){var r=de(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),o=""+e[r];if(!e.hasOwnProperty(r)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var c=n.get,m=n.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return c.call(this)},set:function(y){o=""+y,m.call(this,y)}}),Object.defineProperty(e,r,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(y){o=""+y},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function De(e){e._valueTracker||(e._valueTracker=be(e))}function Ke(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var n=r.getValue(),o="";return e&&(o=de(e)?e.checked?"true":"false":e.value),e=o,e!==n?(r.setValue(e),!0):!1}function mt(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function xt(e,r){var n=r.checked;return ee({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function ie(e,r){var n=r.defaultValue==null?"":r.defaultValue,o=r.checked!=null?r.checked:r.defaultChecked;n=Ie(r.value!=null?r.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function He(e,r){r=r.checked,r!=null&&N(e,"checked",r,!1)}function sr(e,r){He(e,r);var n=Ie(r.value),o=r.type;if(n!=null)o==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?nr(e,r.type,n):r.hasOwnProperty("defaultValue")&&nr(e,r.type,Ie(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function Zr(e,r,n){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var o=r.type;if(!(o!=="submit"&&o!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,n||r===e.value||(e.value=r),e.defaultValue=r}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function nr(e,r,n){(r!=="number"||mt(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ht=Array.isArray;function Ht(e,r,n,o){if(e=e.options,r){r={};for(var c=0;c<n.length;c++)r["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=r.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&o&&(e[n].defaultSelected=!0)}else{for(n=""+Ie(n),r=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,o&&(e[c].defaultSelected=!0);return}r!==null||e[c].disabled||(r=e[c])}r!==null&&(r.selected=!0)}}function Ct(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(l(91));return ee({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vt(e,r){var n=r.value;if(n==null){if(n=r.children,r=r.defaultValue,n!=null){if(r!=null)throw Error(l(92));if(ht(n)){if(1<n.length)throw Error(l(93));n=n[0]}r=n}r==null&&(r=""),n=r}e._wrapperState={initialValue:Ie(n)}}function rn(e,r){var n=Ie(r.value),o=Ie(r.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),r.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),o!=null&&(e.defaultValue=""+o)}function ys(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function ar(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function At(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?ar(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var es,vs=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,n,o,c){MSApp.execUnsafeLocalFunction(function(){return e(r,n,o,c)})}:e})(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(es=es||document.createElement("div"),es.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=es.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function W(e,r){if(r){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=r;return}}e.textContent=r}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xe=["Webkit","ms","Moz","O"];Object.keys(me).forEach(function(e){Xe.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),me[r]=me[e]})});function Pt(e,r,n){return r==null||typeof r=="boolean"||r===""?"":n||typeof r!="number"||r===0||me.hasOwnProperty(e)&&me[e]?(""+r).trim():r+"px"}function gt(e,r){e=e.style;for(var n in r)if(r.hasOwnProperty(n)){var o=n.indexOf("--")===0,c=Pt(n,r[n],o);n==="float"&&(n="cssFloat"),o?e.setProperty(n,c):e[n]=c}}var Ur=ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ts(e,r){if(r){if(Ur[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(l(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(l(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(l(61))}if(r.style!=null&&typeof r.style!="object")throw Error(l(62))}}function hr(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rs=null;function ss(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sn=null,Rr=null,Lr=null;function ns(e){if(e=wa(e)){if(typeof sn!="function")throw Error(l(280));var r=e.stateNode;r&&(r=jl(r),sn(e.stateNode,e.type,r))}}function lr(e){Rr?Lr?Lr.push(e):Lr=[e]:Rr=e}function bs(){if(Rr){var e=Rr,r=Lr;if(Lr=Rr=null,ns(e),r)for(e=0;e<r.length;e++)ns(r[e])}}function Mt(e,r){return e(r)}function Rt(){}var L=!1;function F(e,r,n){if(L)return e(r,n);L=!0;try{return Mt(e,r,n)}finally{L=!1,(Rr!==null||Lr!==null)&&(Rt(),bs())}}function X(e,r){var n=e.stateNode;if(n===null)return null;var o=jl(n);if(o===null)return null;n=o[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,r,typeof n));return n}var oe=!1;if(p)try{var he={};Object.defineProperty(he,"passive",{get:function(){oe=!0}}),window.addEventListener("test",he,he),window.removeEventListener("test",he,he)}catch{oe=!1}function Se(e,r,n,o,c,m,y,_,P){var Q=Array.prototype.slice.call(arguments,3);try{r.apply(n,Q)}catch(ne){this.onError(ne)}}var we=!1,ye=null,ke=!1,Le=null,_e={onError:function(e){we=!0,ye=e}};function Ce(e,r,n,o,c,m,y,_,P){we=!1,ye=null,Se.apply(_e,arguments)}function ze(e,r,n,o,c,m,y,_,P){if(Ce.apply(this,arguments),we){if(we){var Q=ye;we=!1,ye=null}else throw Error(l(198));ke||(ke=!0,Le=Q)}}function We(e){var r=e,n=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,(r.flags&4098)!==0&&(n=r.return),e=r.return;while(e)}return r.tag===3?n:null}function yt(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function jt(e){if(We(e)!==e)throw Error(l(188))}function tt(e){var r=e.alternate;if(!r){if(r=We(e),r===null)throw Error(l(188));return r!==e?null:e}for(var n=e,o=r;;){var c=n.return;if(c===null)break;var m=c.alternate;if(m===null){if(o=c.return,o!==null){n=o;continue}break}if(c.child===m.child){for(m=c.child;m;){if(m===n)return jt(c),e;if(m===o)return jt(c),r;m=m.sibling}throw Error(l(188))}if(n.return!==o.return)n=c,o=m;else{for(var y=!1,_=c.child;_;){if(_===n){y=!0,n=c,o=m;break}if(_===o){y=!0,o=c,n=m;break}_=_.sibling}if(!y){for(_=m.child;_;){if(_===n){y=!0,n=m,o=c;break}if(_===o){y=!0,o=m,n=c;break}_=_.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==o)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:r}function Qe(e){return e=tt(e),e!==null?Hr(e):null}function Hr(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=Hr(e);if(r!==null)return r;e=e.sibling}return null}var js=a.unstable_scheduleCallback,Tr=a.unstable_cancelCallback,fr=a.unstable_shouldYield,sa=a.unstable_requestPaint,Ye=a.unstable_now,as=a.unstable_getCurrentPriorityLevel,ws=a.unstable_ImmediatePriority,nn=a.unstable_UserBlockingPriority,Fe=a.unstable_NormalPriority,wt=a.unstable_LowPriority,an=a.unstable_IdlePriority,Vr=null,qe=null;function kn(e){if(qe&&typeof qe.onCommitFiberRoot=="function")try{qe.onCommitFiberRoot(Vr,e,void 0,(e.current.flags&128)===128)}catch{}}var Wt=Math.clz32?Math.clz32:Lp,Ao=Math.log,Rp=Math.LN2;function Lp(e){return e>>>=0,e===0?32:31-(Ao(e)/Rp|0)|0}var sl=64,nl=4194304;function na(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function al(e,r){var n=e.pendingLanes;if(n===0)return 0;var o=0,c=e.suspendedLanes,m=e.pingedLanes,y=n&268435455;if(y!==0){var _=y&~c;_!==0?o=na(_):(m&=y,m!==0&&(o=na(m)))}else y=n&~c,y!==0?o=na(y):m!==0&&(o=na(m));if(o===0)return 0;if(r!==0&&r!==o&&(r&c)===0&&(c=o&-o,m=r&-r,c>=m||c===16&&(m&4194240)!==0))return r;if((o&4)!==0&&(o|=n&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=o;0<r;)n=31-Wt(r),c=1<<n,o|=e[n],r&=~c;return o}function Tp(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pp(e,r){for(var n=e.suspendedLanes,o=e.pingedLanes,c=e.expirationTimes,m=e.pendingLanes;0<m;){var y=31-Wt(m),_=1<<y,P=c[y];P===-1?((_&n)===0||(_&o)!==0)&&(c[y]=Tp(_,r)):P<=r&&(e.expiredLanes|=_),m&=~_}}function zo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Md(){var e=sl;return sl<<=1,(sl&4194240)===0&&(sl=64),e}function Fo(e){for(var r=[],n=0;31>n;n++)r.push(e);return r}function aa(e,r,n){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Wt(r),e[r]=n}function Mp(e,r){var n=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var c=31-Wt(n),m=1<<c;r[c]=0,o[c]=-1,e[c]=-1,n&=~m}}function Bo(e,r){var n=e.entangledLanes|=r;for(e=e.entanglements;n;){var o=31-Wt(n),c=1<<o;c&r|e[o]&r&&(e[o]|=r),n&=~c}}var Je=0;function Id(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var $d,Uo,Dd,Od,Ad,Ho=!1,ll=[],Ns=null,ks=null,Ss=null,la=new Map,oa=new Map,_s=[],Ip="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zd(e,r){switch(e){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Ss=null;break;case"pointerover":case"pointerout":la.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":oa.delete(r.pointerId)}}function ia(e,r,n,o,c,m){return e===null||e.nativeEvent!==m?(e={blockedOn:r,domEventName:n,eventSystemFlags:o,nativeEvent:m,targetContainers:[c]},r!==null&&(r=wa(r),r!==null&&Uo(r)),e):(e.eventSystemFlags|=o,r=e.targetContainers,c!==null&&r.indexOf(c)===-1&&r.push(c),e)}function $p(e,r,n,o,c){switch(r){case"focusin":return Ns=ia(Ns,e,r,n,o,c),!0;case"dragenter":return ks=ia(ks,e,r,n,o,c),!0;case"mouseover":return Ss=ia(Ss,e,r,n,o,c),!0;case"pointerover":var m=c.pointerId;return la.set(m,ia(la.get(m)||null,e,r,n,o,c)),!0;case"gotpointercapture":return m=c.pointerId,oa.set(m,ia(oa.get(m)||null,e,r,n,o,c)),!0}return!1}function Fd(e){var r=ln(e.target);if(r!==null){var n=We(r);if(n!==null){if(r=n.tag,r===13){if(r=yt(n),r!==null){e.blockedOn=r,Ad(e.priority,function(){Dd(n)});return}}else if(r===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ol(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var n=Wo(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var o=new n.constructor(n.type,n);rs=o,n.target.dispatchEvent(o),rs=null}else return r=wa(n),r!==null&&Uo(r),e.blockedOn=n,!1;r.shift()}return!0}function Bd(e,r,n){ol(e)&&n.delete(r)}function Dp(){Ho=!1,Ns!==null&&ol(Ns)&&(Ns=null),ks!==null&&ol(ks)&&(ks=null),Ss!==null&&ol(Ss)&&(Ss=null),la.forEach(Bd),oa.forEach(Bd)}function ca(e,r){e.blockedOn===r&&(e.blockedOn=null,Ho||(Ho=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Dp)))}function da(e){function r(c){return ca(c,e)}if(0<ll.length){ca(ll[0],e);for(var n=1;n<ll.length;n++){var o=ll[n];o.blockedOn===e&&(o.blockedOn=null)}}for(Ns!==null&&ca(Ns,e),ks!==null&&ca(ks,e),Ss!==null&&ca(Ss,e),la.forEach(r),oa.forEach(r),n=0;n<_s.length;n++)o=_s[n],o.blockedOn===e&&(o.blockedOn=null);for(;0<_s.length&&(n=_s[0],n.blockedOn===null);)Fd(n),n.blockedOn===null&&_s.shift()}var Sn=O.ReactCurrentBatchConfig,il=!0;function Op(e,r,n,o){var c=Je,m=Sn.transition;Sn.transition=null;try{Je=1,Vo(e,r,n,o)}finally{Je=c,Sn.transition=m}}function Ap(e,r,n,o){var c=Je,m=Sn.transition;Sn.transition=null;try{Je=4,Vo(e,r,n,o)}finally{Je=c,Sn.transition=m}}function Vo(e,r,n,o){if(il){var c=Wo(e,r,n,o);if(c===null)ii(e,r,o,cl,n),zd(e,o);else if($p(c,e,r,n,o))o.stopPropagation();else if(zd(e,o),r&4&&-1<Ip.indexOf(e)){for(;c!==null;){var m=wa(c);if(m!==null&&$d(m),m=Wo(e,r,n,o),m===null&&ii(e,r,o,cl,n),m===c)break;c=m}c!==null&&o.stopPropagation()}else ii(e,r,o,null,n)}}var cl=null;function Wo(e,r,n,o){if(cl=null,e=ss(o),e=ln(e),e!==null)if(r=We(e),r===null)e=null;else if(n=r.tag,n===13){if(e=yt(r),e!==null)return e;e=null}else if(n===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return cl=e,null}function Ud(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(as()){case ws:return 1;case nn:return 4;case Fe:case wt:return 16;case an:return 536870912;default:return 16}default:return 16}}var Es=null,qo=null,dl=null;function Hd(){if(dl)return dl;var e,r=qo,n=r.length,o,c="value"in Es?Es.value:Es.textContent,m=c.length;for(e=0;e<n&&r[e]===c[e];e++);var y=n-e;for(o=1;o<=y&&r[n-o]===c[m-o];o++);return dl=c.slice(e,1<o?1-o:void 0)}function ul(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function ml(){return!0}function Vd(){return!1}function or(e){function r(n,o,c,m,y){this._reactName=n,this._targetInst=c,this.type=o,this.nativeEvent=m,this.target=y,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(n=e[_],this[_]=n?n(m):m[_]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?ml:Vd,this.isPropagationStopped=Vd,this}return ee(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ml)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ml)},persist:function(){},isPersistent:ml}),r}var _n={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jo=or(_n),ua=ee({},_n,{view:0,detail:0}),zp=or(ua),Ko,Qo,ma,hl=ee({},ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ma&&(ma&&e.type==="mousemove"?(Ko=e.screenX-ma.screenX,Qo=e.screenY-ma.screenY):Qo=Ko=0,ma=e),Ko)},movementY:function(e){return"movementY"in e?e.movementY:Qo}}),Wd=or(hl),Fp=ee({},hl,{dataTransfer:0}),Bp=or(Fp),Up=ee({},ua,{relatedTarget:0}),Xo=or(Up),Hp=ee({},_n,{animationName:0,elapsedTime:0,pseudoElement:0}),Vp=or(Hp),Wp=ee({},_n,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),qp=or(Wp),Jp=ee({},_n,{data:0}),qd=or(Jp),Kp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yp(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=Xp[e])?!!r[e]:!1}function Yo(){return Yp}var Gp=ee({},ua,{key:function(e){if(e.key){var r=Kp[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=ul(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Qp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yo,charCode:function(e){return e.type==="keypress"?ul(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ul(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Zp=or(Gp),ex=ee({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jd=or(ex),tx=ee({},ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yo}),rx=or(tx),sx=ee({},_n,{propertyName:0,elapsedTime:0,pseudoElement:0}),nx=or(sx),ax=ee({},hl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),lx=or(ax),ox=[9,13,27,32],Go=p&&"CompositionEvent"in window,ha=null;p&&"documentMode"in document&&(ha=document.documentMode);var ix=p&&"TextEvent"in window&&!ha,Kd=p&&(!Go||ha&&8<ha&&11>=ha),Qd=" ",Xd=!1;function Yd(e,r){switch(e){case"keyup":return ox.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var En=!1;function cx(e,r){switch(e){case"compositionend":return Gd(r);case"keypress":return r.which!==32?null:(Xd=!0,Qd);case"textInput":return e=r.data,e===Qd&&Xd?null:e;default:return null}}function dx(e,r){if(En)return e==="compositionend"||!Go&&Yd(e,r)?(e=Hd(),dl=qo=Es=null,En=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Kd&&r.locale!=="ko"?null:r.data;default:return null}}var ux={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zd(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!ux[e.type]:r==="textarea"}function eu(e,r,n,o){lr(o),r=yl(r,"onChange"),0<r.length&&(n=new Jo("onChange","change",null,n,o),e.push({event:n,listeners:r}))}var fa=null,pa=null;function mx(e){yu(e,0)}function fl(e){var r=Pn(e);if(Ke(r))return e}function hx(e,r){if(e==="change")return r}var tu=!1;if(p){var Zo;if(p){var ei="oninput"in document;if(!ei){var ru=document.createElement("div");ru.setAttribute("oninput","return;"),ei=typeof ru.oninput=="function"}Zo=ei}else Zo=!1;tu=Zo&&(!document.documentMode||9<document.documentMode)}function su(){fa&&(fa.detachEvent("onpropertychange",nu),pa=fa=null)}function nu(e){if(e.propertyName==="value"&&fl(pa)){var r=[];eu(r,pa,e,ss(e)),F(mx,r)}}function fx(e,r,n){e==="focusin"?(su(),fa=r,pa=n,fa.attachEvent("onpropertychange",nu)):e==="focusout"&&su()}function px(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return fl(pa)}function xx(e,r){if(e==="click")return fl(r)}function gx(e,r){if(e==="input"||e==="change")return fl(r)}function yx(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Pr=typeof Object.is=="function"?Object.is:yx;function xa(e,r){if(Pr(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var n=Object.keys(e),o=Object.keys(r);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var c=n[o];if(!x.call(r,c)||!Pr(e[c],r[c]))return!1}return!0}function au(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lu(e,r){var n=au(e);e=0;for(var o;n;){if(n.nodeType===3){if(o=e+n.textContent.length,e<=r&&o>=r)return{node:n,offset:r-e};e=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=au(n)}}function ou(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?ou(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function iu(){for(var e=window,r=mt();r instanceof e.HTMLIFrameElement;){try{var n=typeof r.contentWindow.location.href=="string"}catch{n=!1}if(n)e=r.contentWindow;else break;r=mt(e.document)}return r}function ti(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function vx(e){var r=iu(),n=e.focusedElem,o=e.selectionRange;if(r!==n&&n&&n.ownerDocument&&ou(n.ownerDocument.documentElement,n)){if(o!==null&&ti(n)){if(r=o.start,e=o.end,e===void 0&&(e=r),"selectionStart"in n)n.selectionStart=r,n.selectionEnd=Math.min(e,n.value.length);else if(e=(r=n.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var c=n.textContent.length,m=Math.min(o.start,c);o=o.end===void 0?m:Math.min(o.end,c),!e.extend&&m>o&&(c=o,o=m,m=c),c=lu(n,m);var y=lu(n,o);c&&y&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==y.node||e.focusOffset!==y.offset)&&(r=r.createRange(),r.setStart(c.node,c.offset),e.removeAllRanges(),m>o?(e.addRange(r),e.extend(y.node,y.offset)):(r.setEnd(y.node,y.offset),e.addRange(r)))}}for(r=[],e=n;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<r.length;n++)e=r[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var bx=p&&"documentMode"in document&&11>=document.documentMode,Cn=null,ri=null,ga=null,si=!1;function cu(e,r,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;si||Cn==null||Cn!==mt(o)||(o=Cn,"selectionStart"in o&&ti(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),ga&&xa(ga,o)||(ga=o,o=yl(ri,"onSelect"),0<o.length&&(r=new Jo("onSelect","select",null,r,n),e.push({event:r,listeners:o}),r.target=Cn)))}function pl(e,r){var n={};return n[e.toLowerCase()]=r.toLowerCase(),n["Webkit"+e]="webkit"+r,n["Moz"+e]="moz"+r,n}var Rn={animationend:pl("Animation","AnimationEnd"),animationiteration:pl("Animation","AnimationIteration"),animationstart:pl("Animation","AnimationStart"),transitionend:pl("Transition","TransitionEnd")},ni={},du={};p&&(du=document.createElement("div").style,"AnimationEvent"in window||(delete Rn.animationend.animation,delete Rn.animationiteration.animation,delete Rn.animationstart.animation),"TransitionEvent"in window||delete Rn.transitionend.transition);function xl(e){if(ni[e])return ni[e];if(!Rn[e])return e;var r=Rn[e],n;for(n in r)if(r.hasOwnProperty(n)&&n in du)return ni[e]=r[n];return e}var uu=xl("animationend"),mu=xl("animationiteration"),hu=xl("animationstart"),fu=xl("transitionend"),pu=new Map,xu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cs(e,r){pu.set(e,r),u(r,[e])}for(var ai=0;ai<xu.length;ai++){var li=xu[ai],jx=li.toLowerCase(),wx=li[0].toUpperCase()+li.slice(1);Cs(jx,"on"+wx)}Cs(uu,"onAnimationEnd"),Cs(mu,"onAnimationIteration"),Cs(hu,"onAnimationStart"),Cs("dblclick","onDoubleClick"),Cs("focusin","onFocus"),Cs("focusout","onBlur"),Cs(fu,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ya="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nx=new Set("cancel close invalid load scroll toggle".split(" ").concat(ya));function gu(e,r,n){var o=e.type||"unknown-event";e.currentTarget=n,ze(o,r,void 0,e),e.currentTarget=null}function yu(e,r){r=(r&4)!==0;for(var n=0;n<e.length;n++){var o=e[n],c=o.event;o=o.listeners;e:{var m=void 0;if(r)for(var y=o.length-1;0<=y;y--){var _=o[y],P=_.instance,Q=_.currentTarget;if(_=_.listener,P!==m&&c.isPropagationStopped())break e;gu(c,_,Q),m=P}else for(y=0;y<o.length;y++){if(_=o[y],P=_.instance,Q=_.currentTarget,_=_.listener,P!==m&&c.isPropagationStopped())break e;gu(c,_,Q),m=P}}}if(ke)throw e=Le,ke=!1,Le=null,e}function rt(e,r){var n=r[fi];n===void 0&&(n=r[fi]=new Set);var o=e+"__bubble";n.has(o)||(vu(r,e,2,!1),n.add(o))}function oi(e,r,n){var o=0;r&&(o|=4),vu(n,e,o,r)}var gl="_reactListening"+Math.random().toString(36).slice(2);function va(e){if(!e[gl]){e[gl]=!0,i.forEach(function(n){n!=="selectionchange"&&(Nx.has(n)||oi(n,!1,e),oi(n,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[gl]||(r[gl]=!0,oi("selectionchange",!1,r))}}function vu(e,r,n,o){switch(Ud(r)){case 1:var c=Op;break;case 4:c=Ap;break;default:c=Vo}n=c.bind(null,r,n,e),c=void 0,!oe||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(c=!0),o?c!==void 0?e.addEventListener(r,n,{capture:!0,passive:c}):e.addEventListener(r,n,!0):c!==void 0?e.addEventListener(r,n,{passive:c}):e.addEventListener(r,n,!1)}function ii(e,r,n,o,c){var m=o;if((r&1)===0&&(r&2)===0&&o!==null)e:for(;;){if(o===null)return;var y=o.tag;if(y===3||y===4){var _=o.stateNode.containerInfo;if(_===c||_.nodeType===8&&_.parentNode===c)break;if(y===4)for(y=o.return;y!==null;){var P=y.tag;if((P===3||P===4)&&(P=y.stateNode.containerInfo,P===c||P.nodeType===8&&P.parentNode===c))return;y=y.return}for(;_!==null;){if(y=ln(_),y===null)return;if(P=y.tag,P===5||P===6){o=m=y;continue e}_=_.parentNode}}o=o.return}F(function(){var Q=m,ne=ss(n),le=[];e:{var te=pu.get(e);if(te!==void 0){var pe=Jo,ve=e;switch(e){case"keypress":if(ul(n)===0)break e;case"keydown":case"keyup":pe=Zp;break;case"focusin":ve="focus",pe=Xo;break;case"focusout":ve="blur",pe=Xo;break;case"beforeblur":case"afterblur":pe=Xo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=Wd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=Bp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=rx;break;case uu:case mu:case hu:pe=Vp;break;case fu:pe=nx;break;case"scroll":pe=zp;break;case"wheel":pe=lx;break;case"copy":case"cut":case"paste":pe=qp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=Jd}var je=(r&4)!==0,ut=!je&&e==="scroll",U=je?te!==null?te+"Capture":null:te;je=[];for(var D=Q,H;D!==null;){H=D;var ue=H.stateNode;if(H.tag===5&&ue!==null&&(H=ue,U!==null&&(ue=X(D,U),ue!=null&&je.push(ba(D,ue,H)))),ut)break;D=D.return}0<je.length&&(te=new pe(te,ve,null,n,ne),le.push({event:te,listeners:je}))}}if((r&7)===0){e:{if(te=e==="mouseover"||e==="pointerover",pe=e==="mouseout"||e==="pointerout",te&&n!==rs&&(ve=n.relatedTarget||n.fromElement)&&(ln(ve)||ve[ls]))break e;if((pe||te)&&(te=ne.window===ne?ne:(te=ne.ownerDocument)?te.defaultView||te.parentWindow:window,pe?(ve=n.relatedTarget||n.toElement,pe=Q,ve=ve?ln(ve):null,ve!==null&&(ut=We(ve),ve!==ut||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(pe=null,ve=Q),pe!==ve)){if(je=Wd,ue="onMouseLeave",U="onMouseEnter",D="mouse",(e==="pointerout"||e==="pointerover")&&(je=Jd,ue="onPointerLeave",U="onPointerEnter",D="pointer"),ut=pe==null?te:Pn(pe),H=ve==null?te:Pn(ve),te=new je(ue,D+"leave",pe,n,ne),te.target=ut,te.relatedTarget=H,ue=null,ln(ne)===Q&&(je=new je(U,D+"enter",ve,n,ne),je.target=H,je.relatedTarget=ut,ue=je),ut=ue,pe&&ve)t:{for(je=pe,U=ve,D=0,H=je;H;H=Ln(H))D++;for(H=0,ue=U;ue;ue=Ln(ue))H++;for(;0<D-H;)je=Ln(je),D--;for(;0<H-D;)U=Ln(U),H--;for(;D--;){if(je===U||U!==null&&je===U.alternate)break t;je=Ln(je),U=Ln(U)}je=null}else je=null;pe!==null&&bu(le,te,pe,je,!1),ve!==null&&ut!==null&&bu(le,ut,ve,je,!0)}}e:{if(te=Q?Pn(Q):window,pe=te.nodeName&&te.nodeName.toLowerCase(),pe==="select"||pe==="input"&&te.type==="file")var Ne=hx;else if(Zd(te))if(tu)Ne=gx;else{Ne=px;var Te=fx}else(pe=te.nodeName)&&pe.toLowerCase()==="input"&&(te.type==="checkbox"||te.type==="radio")&&(Ne=xx);if(Ne&&(Ne=Ne(e,Q))){eu(le,Ne,n,ne);break e}Te&&Te(e,te,Q),e==="focusout"&&(Te=te._wrapperState)&&Te.controlled&&te.type==="number"&&nr(te,"number",te.value)}switch(Te=Q?Pn(Q):window,e){case"focusin":(Zd(Te)||Te.contentEditable==="true")&&(Cn=Te,ri=Q,ga=null);break;case"focusout":ga=ri=Cn=null;break;case"mousedown":si=!0;break;case"contextmenu":case"mouseup":case"dragend":si=!1,cu(le,n,ne);break;case"selectionchange":if(bx)break;case"keydown":case"keyup":cu(le,n,ne)}var Pe;if(Go)e:{switch(e){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else En?Yd(e,n)&&(Me="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Me="onCompositionStart");Me&&(Kd&&n.locale!=="ko"&&(En||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&En&&(Pe=Hd()):(Es=ne,qo="value"in Es?Es.value:Es.textContent,En=!0)),Te=yl(Q,Me),0<Te.length&&(Me=new qd(Me,e,null,n,ne),le.push({event:Me,listeners:Te}),Pe?Me.data=Pe:(Pe=Gd(n),Pe!==null&&(Me.data=Pe)))),(Pe=ix?cx(e,n):dx(e,n))&&(Q=yl(Q,"onBeforeInput"),0<Q.length&&(ne=new qd("onBeforeInput","beforeinput",null,n,ne),le.push({event:ne,listeners:Q}),ne.data=Pe))}yu(le,r)})}function ba(e,r,n){return{instance:e,listener:r,currentTarget:n}}function yl(e,r){for(var n=r+"Capture",o=[];e!==null;){var c=e,m=c.stateNode;c.tag===5&&m!==null&&(c=m,m=X(e,n),m!=null&&o.unshift(ba(e,m,c)),m=X(e,r),m!=null&&o.push(ba(e,m,c))),e=e.return}return o}function Ln(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bu(e,r,n,o,c){for(var m=r._reactName,y=[];n!==null&&n!==o;){var _=n,P=_.alternate,Q=_.stateNode;if(P!==null&&P===o)break;_.tag===5&&Q!==null&&(_=Q,c?(P=X(n,m),P!=null&&y.unshift(ba(n,P,_))):c||(P=X(n,m),P!=null&&y.push(ba(n,P,_)))),n=n.return}y.length!==0&&e.push({event:r,listeners:y})}var kx=/\r\n?/g,Sx=/\u0000|\uFFFD/g;function ju(e){return(typeof e=="string"?e:""+e).replace(kx,`
`).replace(Sx,"")}function vl(e,r,n){if(r=ju(r),ju(e)!==r&&n)throw Error(l(425))}function bl(){}var ci=null,di=null;function ui(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var mi=typeof setTimeout=="function"?setTimeout:void 0,_x=typeof clearTimeout=="function"?clearTimeout:void 0,wu=typeof Promise=="function"?Promise:void 0,Ex=typeof queueMicrotask=="function"?queueMicrotask:typeof wu<"u"?function(e){return wu.resolve(null).then(e).catch(Cx)}:mi;function Cx(e){setTimeout(function(){throw e})}function hi(e,r){var n=r,o=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(o===0){e.removeChild(c),da(r);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=c}while(n);da(r)}function Rs(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function Nu(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(r===0)return e;r--}else n==="/$"&&r++}e=e.previousSibling}return null}var Tn=Math.random().toString(36).slice(2),Wr="__reactFiber$"+Tn,ja="__reactProps$"+Tn,ls="__reactContainer$"+Tn,fi="__reactEvents$"+Tn,Rx="__reactListeners$"+Tn,Lx="__reactHandles$"+Tn;function ln(e){var r=e[Wr];if(r)return r;for(var n=e.parentNode;n;){if(r=n[ls]||n[Wr]){if(n=r.alternate,r.child!==null||n!==null&&n.child!==null)for(e=Nu(e);e!==null;){if(n=e[Wr])return n;e=Nu(e)}return r}e=n,n=e.parentNode}return null}function wa(e){return e=e[Wr]||e[ls],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Pn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(l(33))}function jl(e){return e[ja]||null}var pi=[],Mn=-1;function Ls(e){return{current:e}}function st(e){0>Mn||(e.current=pi[Mn],pi[Mn]=null,Mn--)}function Ze(e,r){Mn++,pi[Mn]=e.current,e.current=r}var Ts={},It=Ls(Ts),qt=Ls(!1),on=Ts;function In(e,r){var n=e.type.contextTypes;if(!n)return Ts;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===r)return o.__reactInternalMemoizedMaskedChildContext;var c={},m;for(m in n)c[m]=r[m];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=c),c}function Jt(e){return e=e.childContextTypes,e!=null}function wl(){st(qt),st(It)}function ku(e,r,n){if(It.current!==Ts)throw Error(l(168));Ze(It,r),Ze(qt,n)}function Su(e,r,n){var o=e.stateNode;if(r=r.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var c in o)if(!(c in r))throw Error(l(108,$e(e)||"Unknown",c));return ee({},n,o)}function Nl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ts,on=It.current,Ze(It,e),Ze(qt,qt.current),!0}function _u(e,r,n){var o=e.stateNode;if(!o)throw Error(l(169));n?(e=Su(e,r,on),o.__reactInternalMemoizedMergedChildContext=e,st(qt),st(It),Ze(It,e)):st(qt),Ze(qt,n)}var os=null,kl=!1,xi=!1;function Eu(e){os===null?os=[e]:os.push(e)}function Tx(e){kl=!0,Eu(e)}function Ps(){if(!xi&&os!==null){xi=!0;var e=0,r=Je;try{var n=os;for(Je=1;e<n.length;e++){var o=n[e];do o=o(!0);while(o!==null)}os=null,kl=!1}catch(c){throw os!==null&&(os=os.slice(e+1)),js(ws,Ps),c}finally{Je=r,xi=!1}}return null}var $n=[],Dn=0,Sl=null,_l=0,pr=[],xr=0,cn=null,is=1,cs="";function dn(e,r){$n[Dn++]=_l,$n[Dn++]=Sl,Sl=e,_l=r}function Cu(e,r,n){pr[xr++]=is,pr[xr++]=cs,pr[xr++]=cn,cn=e;var o=is;e=cs;var c=32-Wt(o)-1;o&=~(1<<c),n+=1;var m=32-Wt(r)+c;if(30<m){var y=c-c%5;m=(o&(1<<y)-1).toString(32),o>>=y,c-=y,is=1<<32-Wt(r)+c|n<<c|o,cs=m+e}else is=1<<m|n<<c|o,cs=e}function gi(e){e.return!==null&&(dn(e,1),Cu(e,1,0))}function yi(e){for(;e===Sl;)Sl=$n[--Dn],$n[Dn]=null,_l=$n[--Dn],$n[Dn]=null;for(;e===cn;)cn=pr[--xr],pr[xr]=null,cs=pr[--xr],pr[xr]=null,is=pr[--xr],pr[xr]=null}var ir=null,cr=null,nt=!1,Mr=null;function Ru(e,r){var n=br(5,null,null,0);n.elementType="DELETED",n.stateNode=r,n.return=e,r=e.deletions,r===null?(e.deletions=[n],e.flags|=16):r.push(n)}function Lu(e,r){switch(e.tag){case 5:var n=e.type;return r=r.nodeType!==1||n.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,ir=e,cr=Rs(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,ir=e,cr=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(n=cn!==null?{id:is,overflow:cs}:null,e.memoizedState={dehydrated:r,treeContext:n,retryLane:1073741824},n=br(18,null,null,0),n.stateNode=r,n.return=e,e.child=n,ir=e,cr=null,!0):!1;default:return!1}}function vi(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bi(e){if(nt){var r=cr;if(r){var n=r;if(!Lu(e,r)){if(vi(e))throw Error(l(418));r=Rs(n.nextSibling);var o=ir;r&&Lu(e,r)?Ru(o,n):(e.flags=e.flags&-4097|2,nt=!1,ir=e)}}else{if(vi(e))throw Error(l(418));e.flags=e.flags&-4097|2,nt=!1,ir=e}}}function Tu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ir=e}function El(e){if(e!==ir)return!1;if(!nt)return Tu(e),nt=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!ui(e.type,e.memoizedProps)),r&&(r=cr)){if(vi(e))throw Pu(),Error(l(418));for(;r;)Ru(e,r),r=Rs(r.nextSibling)}if(Tu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(r===0){cr=Rs(e.nextSibling);break e}r--}else n!=="$"&&n!=="$!"&&n!=="$?"||r++}e=e.nextSibling}cr=null}}else cr=ir?Rs(e.stateNode.nextSibling):null;return!0}function Pu(){for(var e=cr;e;)e=Rs(e.nextSibling)}function On(){cr=ir=null,nt=!1}function ji(e){Mr===null?Mr=[e]:Mr.push(e)}var Px=O.ReactCurrentBatchConfig;function Na(e,r,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(l(309));var o=n.stateNode}if(!o)throw Error(l(147,e));var c=o,m=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===m?r.ref:(r=function(y){var _=c.refs;y===null?delete _[m]:_[m]=y},r._stringRef=m,r)}if(typeof e!="string")throw Error(l(284));if(!n._owner)throw Error(l(290,e))}return e}function Cl(e,r){throw e=Object.prototype.toString.call(r),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function Mu(e){var r=e._init;return r(e._payload)}function Iu(e){function r(U,D){if(e){var H=U.deletions;H===null?(U.deletions=[D],U.flags|=16):H.push(D)}}function n(U,D){if(!e)return null;for(;D!==null;)r(U,D),D=D.sibling;return null}function o(U,D){for(U=new Map;D!==null;)D.key!==null?U.set(D.key,D):U.set(D.index,D),D=D.sibling;return U}function c(U,D){return U=Fs(U,D),U.index=0,U.sibling=null,U}function m(U,D,H){return U.index=H,e?(H=U.alternate,H!==null?(H=H.index,H<D?(U.flags|=2,D):H):(U.flags|=2,D)):(U.flags|=1048576,D)}function y(U){return e&&U.alternate===null&&(U.flags|=2),U}function _(U,D,H,ue){return D===null||D.tag!==6?(D=mc(H,U.mode,ue),D.return=U,D):(D=c(D,H),D.return=U,D)}function P(U,D,H,ue){var Ne=H.type;return Ne===I?ne(U,D,H.props.children,ue,H.key):D!==null&&(D.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===q&&Mu(Ne)===D.type)?(ue=c(D,H.props),ue.ref=Na(U,D,H),ue.return=U,ue):(ue=Gl(H.type,H.key,H.props,null,U.mode,ue),ue.ref=Na(U,D,H),ue.return=U,ue)}function Q(U,D,H,ue){return D===null||D.tag!==4||D.stateNode.containerInfo!==H.containerInfo||D.stateNode.implementation!==H.implementation?(D=hc(H,U.mode,ue),D.return=U,D):(D=c(D,H.children||[]),D.return=U,D)}function ne(U,D,H,ue,Ne){return D===null||D.tag!==7?(D=yn(H,U.mode,ue,Ne),D.return=U,D):(D=c(D,H),D.return=U,D)}function le(U,D,H){if(typeof D=="string"&&D!==""||typeof D=="number")return D=mc(""+D,U.mode,H),D.return=U,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case B:return H=Gl(D.type,D.key,D.props,null,U.mode,H),H.ref=Na(U,null,D),H.return=U,H;case w:return D=hc(D,U.mode,H),D.return=U,D;case q:var ue=D._init;return le(U,ue(D._payload),H)}if(ht(D)||re(D))return D=yn(D,U.mode,H,null),D.return=U,D;Cl(U,D)}return null}function te(U,D,H,ue){var Ne=D!==null?D.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return Ne!==null?null:_(U,D,""+H,ue);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case B:return H.key===Ne?P(U,D,H,ue):null;case w:return H.key===Ne?Q(U,D,H,ue):null;case q:return Ne=H._init,te(U,D,Ne(H._payload),ue)}if(ht(H)||re(H))return Ne!==null?null:ne(U,D,H,ue,null);Cl(U,H)}return null}function pe(U,D,H,ue,Ne){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return U=U.get(H)||null,_(D,U,""+ue,Ne);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case B:return U=U.get(ue.key===null?H:ue.key)||null,P(D,U,ue,Ne);case w:return U=U.get(ue.key===null?H:ue.key)||null,Q(D,U,ue,Ne);case q:var Te=ue._init;return pe(U,D,H,Te(ue._payload),Ne)}if(ht(ue)||re(ue))return U=U.get(H)||null,ne(D,U,ue,Ne,null);Cl(D,ue)}return null}function ve(U,D,H,ue){for(var Ne=null,Te=null,Pe=D,Me=D=0,St=null;Pe!==null&&Me<H.length;Me++){Pe.index>Me?(St=Pe,Pe=null):St=Pe.sibling;var Ve=te(U,Pe,H[Me],ue);if(Ve===null){Pe===null&&(Pe=St);break}e&&Pe&&Ve.alternate===null&&r(U,Pe),D=m(Ve,D,Me),Te===null?Ne=Ve:Te.sibling=Ve,Te=Ve,Pe=St}if(Me===H.length)return n(U,Pe),nt&&dn(U,Me),Ne;if(Pe===null){for(;Me<H.length;Me++)Pe=le(U,H[Me],ue),Pe!==null&&(D=m(Pe,D,Me),Te===null?Ne=Pe:Te.sibling=Pe,Te=Pe);return nt&&dn(U,Me),Ne}for(Pe=o(U,Pe);Me<H.length;Me++)St=pe(Pe,U,Me,H[Me],ue),St!==null&&(e&&St.alternate!==null&&Pe.delete(St.key===null?Me:St.key),D=m(St,D,Me),Te===null?Ne=St:Te.sibling=St,Te=St);return e&&Pe.forEach(function(Bs){return r(U,Bs)}),nt&&dn(U,Me),Ne}function je(U,D,H,ue){var Ne=re(H);if(typeof Ne!="function")throw Error(l(150));if(H=Ne.call(H),H==null)throw Error(l(151));for(var Te=Ne=null,Pe=D,Me=D=0,St=null,Ve=H.next();Pe!==null&&!Ve.done;Me++,Ve=H.next()){Pe.index>Me?(St=Pe,Pe=null):St=Pe.sibling;var Bs=te(U,Pe,Ve.value,ue);if(Bs===null){Pe===null&&(Pe=St);break}e&&Pe&&Bs.alternate===null&&r(U,Pe),D=m(Bs,D,Me),Te===null?Ne=Bs:Te.sibling=Bs,Te=Bs,Pe=St}if(Ve.done)return n(U,Pe),nt&&dn(U,Me),Ne;if(Pe===null){for(;!Ve.done;Me++,Ve=H.next())Ve=le(U,Ve.value,ue),Ve!==null&&(D=m(Ve,D,Me),Te===null?Ne=Ve:Te.sibling=Ve,Te=Ve);return nt&&dn(U,Me),Ne}for(Pe=o(U,Pe);!Ve.done;Me++,Ve=H.next())Ve=pe(Pe,U,Me,Ve.value,ue),Ve!==null&&(e&&Ve.alternate!==null&&Pe.delete(Ve.key===null?Me:Ve.key),D=m(Ve,D,Me),Te===null?Ne=Ve:Te.sibling=Ve,Te=Ve);return e&&Pe.forEach(function(ug){return r(U,ug)}),nt&&dn(U,Me),Ne}function ut(U,D,H,ue){if(typeof H=="object"&&H!==null&&H.type===I&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case B:e:{for(var Ne=H.key,Te=D;Te!==null;){if(Te.key===Ne){if(Ne=H.type,Ne===I){if(Te.tag===7){n(U,Te.sibling),D=c(Te,H.props.children),D.return=U,U=D;break e}}else if(Te.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===q&&Mu(Ne)===Te.type){n(U,Te.sibling),D=c(Te,H.props),D.ref=Na(U,Te,H),D.return=U,U=D;break e}n(U,Te);break}else r(U,Te);Te=Te.sibling}H.type===I?(D=yn(H.props.children,U.mode,ue,H.key),D.return=U,U=D):(ue=Gl(H.type,H.key,H.props,null,U.mode,ue),ue.ref=Na(U,D,H),ue.return=U,U=ue)}return y(U);case w:e:{for(Te=H.key;D!==null;){if(D.key===Te)if(D.tag===4&&D.stateNode.containerInfo===H.containerInfo&&D.stateNode.implementation===H.implementation){n(U,D.sibling),D=c(D,H.children||[]),D.return=U,U=D;break e}else{n(U,D);break}else r(U,D);D=D.sibling}D=hc(H,U.mode,ue),D.return=U,U=D}return y(U);case q:return Te=H._init,ut(U,D,Te(H._payload),ue)}if(ht(H))return ve(U,D,H,ue);if(re(H))return je(U,D,H,ue);Cl(U,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,D!==null&&D.tag===6?(n(U,D.sibling),D=c(D,H),D.return=U,U=D):(n(U,D),D=mc(H,U.mode,ue),D.return=U,U=D),y(U)):n(U,D)}return ut}var An=Iu(!0),$u=Iu(!1),Rl=Ls(null),Ll=null,zn=null,wi=null;function Ni(){wi=zn=Ll=null}function ki(e){var r=Rl.current;st(Rl),e._currentValue=r}function Si(e,r,n){for(;e!==null;){var o=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,o!==null&&(o.childLanes|=r)):o!==null&&(o.childLanes&r)!==r&&(o.childLanes|=r),e===n)break;e=e.return}}function Fn(e,r){Ll=e,wi=zn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&r)!==0&&(Kt=!0),e.firstContext=null)}function gr(e){var r=e._currentValue;if(wi!==e)if(e={context:e,memoizedValue:r,next:null},zn===null){if(Ll===null)throw Error(l(308));zn=e,Ll.dependencies={lanes:0,firstContext:e}}else zn=zn.next=e;return r}var un=null;function _i(e){un===null?un=[e]:un.push(e)}function Du(e,r,n,o){var c=r.interleaved;return c===null?(n.next=n,_i(r)):(n.next=c.next,c.next=n),r.interleaved=n,ds(e,o)}function ds(e,r){e.lanes|=r;var n=e.alternate;for(n!==null&&(n.lanes|=r),n=e,e=e.return;e!==null;)e.childLanes|=r,n=e.alternate,n!==null&&(n.childLanes|=r),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ms=!1;function Ei(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ou(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function us(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Is(e,r,n){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(Ue&2)!==0){var c=o.pending;return c===null?r.next=r:(r.next=c.next,c.next=r),o.pending=r,ds(e,n)}return c=o.interleaved,c===null?(r.next=r,_i(o)):(r.next=c.next,c.next=r),o.interleaved=r,ds(e,n)}function Tl(e,r,n){if(r=r.updateQueue,r!==null&&(r=r.shared,(n&4194240)!==0)){var o=r.lanes;o&=e.pendingLanes,n|=o,r.lanes=n,Bo(e,n)}}function Au(e,r){var n=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var c=null,m=null;if(n=n.firstBaseUpdate,n!==null){do{var y={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};m===null?c=m=y:m=m.next=y,n=n.next}while(n!==null);m===null?c=m=r:m=m.next=r}else c=m=r;n={baseState:o.baseState,firstBaseUpdate:c,lastBaseUpdate:m,shared:o.shared,effects:o.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=r:e.next=r,n.lastBaseUpdate=r}function Pl(e,r,n,o){var c=e.updateQueue;Ms=!1;var m=c.firstBaseUpdate,y=c.lastBaseUpdate,_=c.shared.pending;if(_!==null){c.shared.pending=null;var P=_,Q=P.next;P.next=null,y===null?m=Q:y.next=Q,y=P;var ne=e.alternate;ne!==null&&(ne=ne.updateQueue,_=ne.lastBaseUpdate,_!==y&&(_===null?ne.firstBaseUpdate=Q:_.next=Q,ne.lastBaseUpdate=P))}if(m!==null){var le=c.baseState;y=0,ne=Q=P=null,_=m;do{var te=_.lane,pe=_.eventTime;if((o&te)===te){ne!==null&&(ne=ne.next={eventTime:pe,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var ve=e,je=_;switch(te=r,pe=n,je.tag){case 1:if(ve=je.payload,typeof ve=="function"){le=ve.call(pe,le,te);break e}le=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=je.payload,te=typeof ve=="function"?ve.call(pe,le,te):ve,te==null)break e;le=ee({},le,te);break e;case 2:Ms=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,te=c.effects,te===null?c.effects=[_]:te.push(_))}else pe={eventTime:pe,lane:te,tag:_.tag,payload:_.payload,callback:_.callback,next:null},ne===null?(Q=ne=pe,P=le):ne=ne.next=pe,y|=te;if(_=_.next,_===null){if(_=c.shared.pending,_===null)break;te=_,_=te.next,te.next=null,c.lastBaseUpdate=te,c.shared.pending=null}}while(!0);if(ne===null&&(P=le),c.baseState=P,c.firstBaseUpdate=Q,c.lastBaseUpdate=ne,r=c.shared.interleaved,r!==null){c=r;do y|=c.lane,c=c.next;while(c!==r)}else m===null&&(c.shared.lanes=0);fn|=y,e.lanes=y,e.memoizedState=le}}function zu(e,r,n){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var o=e[r],c=o.callback;if(c!==null){if(o.callback=null,o=n,typeof c!="function")throw Error(l(191,c));c.call(o)}}}var ka={},qr=Ls(ka),Sa=Ls(ka),_a=Ls(ka);function mn(e){if(e===ka)throw Error(l(174));return e}function Ci(e,r){switch(Ze(_a,r),Ze(Sa,e),Ze(qr,ka),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:At(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=At(r,e)}st(qr),Ze(qr,r)}function Bn(){st(qr),st(Sa),st(_a)}function Fu(e){mn(_a.current);var r=mn(qr.current),n=At(r,e.type);r!==n&&(Ze(Sa,e),Ze(qr,n))}function Ri(e){Sa.current===e&&(st(qr),st(Sa))}var lt=Ls(0);function Ml(e){for(var r=e;r!==null;){if(r.tag===13){var n=r.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Li=[];function Ti(){for(var e=0;e<Li.length;e++)Li[e]._workInProgressVersionPrimary=null;Li.length=0}var Il=O.ReactCurrentDispatcher,Pi=O.ReactCurrentBatchConfig,hn=0,ot=null,vt=null,Nt=null,$l=!1,Ea=!1,Ca=0,Mx=0;function $t(){throw Error(l(321))}function Mi(e,r){if(r===null)return!1;for(var n=0;n<r.length&&n<e.length;n++)if(!Pr(e[n],r[n]))return!1;return!0}function Ii(e,r,n,o,c,m){if(hn=m,ot=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Il.current=e===null||e.memoizedState===null?Ox:Ax,e=n(o,c),Ea){m=0;do{if(Ea=!1,Ca=0,25<=m)throw Error(l(301));m+=1,Nt=vt=null,r.updateQueue=null,Il.current=zx,e=n(o,c)}while(Ea)}if(Il.current=Al,r=vt!==null&&vt.next!==null,hn=0,Nt=vt=ot=null,$l=!1,r)throw Error(l(300));return e}function $i(){var e=Ca!==0;return Ca=0,e}function Jr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?ot.memoizedState=Nt=e:Nt=Nt.next=e,Nt}function yr(){if(vt===null){var e=ot.alternate;e=e!==null?e.memoizedState:null}else e=vt.next;var r=Nt===null?ot.memoizedState:Nt.next;if(r!==null)Nt=r,vt=e;else{if(e===null)throw Error(l(310));vt=e,e={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},Nt===null?ot.memoizedState=Nt=e:Nt=Nt.next=e}return Nt}function Ra(e,r){return typeof r=="function"?r(e):r}function Di(e){var r=yr(),n=r.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var o=vt,c=o.baseQueue,m=n.pending;if(m!==null){if(c!==null){var y=c.next;c.next=m.next,m.next=y}o.baseQueue=c=m,n.pending=null}if(c!==null){m=c.next,o=o.baseState;var _=y=null,P=null,Q=m;do{var ne=Q.lane;if((hn&ne)===ne)P!==null&&(P=P.next={lane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),o=Q.hasEagerState?Q.eagerState:e(o,Q.action);else{var le={lane:ne,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null};P===null?(_=P=le,y=o):P=P.next=le,ot.lanes|=ne,fn|=ne}Q=Q.next}while(Q!==null&&Q!==m);P===null?y=o:P.next=_,Pr(o,r.memoizedState)||(Kt=!0),r.memoizedState=o,r.baseState=y,r.baseQueue=P,n.lastRenderedState=o}if(e=n.interleaved,e!==null){c=e;do m=c.lane,ot.lanes|=m,fn|=m,c=c.next;while(c!==e)}else c===null&&(n.lanes=0);return[r.memoizedState,n.dispatch]}function Oi(e){var r=yr(),n=r.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var o=n.dispatch,c=n.pending,m=r.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do m=e(m,y.action),y=y.next;while(y!==c);Pr(m,r.memoizedState)||(Kt=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),n.lastRenderedState=m}return[m,o]}function Bu(){}function Uu(e,r){var n=ot,o=yr(),c=r(),m=!Pr(o.memoizedState,c);if(m&&(o.memoizedState=c,Kt=!0),o=o.queue,Ai(Wu.bind(null,n,o,e),[e]),o.getSnapshot!==r||m||Nt!==null&&Nt.memoizedState.tag&1){if(n.flags|=2048,La(9,Vu.bind(null,n,o,c,r),void 0,null),kt===null)throw Error(l(349));(hn&30)!==0||Hu(n,r,c)}return c}function Hu(e,r,n){e.flags|=16384,e={getSnapshot:r,value:n},r=ot.updateQueue,r===null?(r={lastEffect:null,stores:null},ot.updateQueue=r,r.stores=[e]):(n=r.stores,n===null?r.stores=[e]:n.push(e))}function Vu(e,r,n,o){r.value=n,r.getSnapshot=o,qu(r)&&Ju(e)}function Wu(e,r,n){return n(function(){qu(r)&&Ju(e)})}function qu(e){var r=e.getSnapshot;e=e.value;try{var n=r();return!Pr(e,n)}catch{return!0}}function Ju(e){var r=ds(e,1);r!==null&&Or(r,e,1,-1)}function Ku(e){var r=Jr();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:e},r.queue=e,e=e.dispatch=Dx.bind(null,ot,e),[r.memoizedState,e]}function La(e,r,n,o){return e={tag:e,create:r,destroy:n,deps:o,next:null},r=ot.updateQueue,r===null?(r={lastEffect:null,stores:null},ot.updateQueue=r,r.lastEffect=e.next=e):(n=r.lastEffect,n===null?r.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,r.lastEffect=e)),e}function Qu(){return yr().memoizedState}function Dl(e,r,n,o){var c=Jr();ot.flags|=e,c.memoizedState=La(1|r,n,void 0,o===void 0?null:o)}function Ol(e,r,n,o){var c=yr();o=o===void 0?null:o;var m=void 0;if(vt!==null){var y=vt.memoizedState;if(m=y.destroy,o!==null&&Mi(o,y.deps)){c.memoizedState=La(r,n,m,o);return}}ot.flags|=e,c.memoizedState=La(1|r,n,m,o)}function Xu(e,r){return Dl(8390656,8,e,r)}function Ai(e,r){return Ol(2048,8,e,r)}function Yu(e,r){return Ol(4,2,e,r)}function Gu(e,r){return Ol(4,4,e,r)}function Zu(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function em(e,r,n){return n=n!=null?n.concat([e]):null,Ol(4,4,Zu.bind(null,r,e),n)}function zi(){}function tm(e,r){var n=yr();r=r===void 0?null:r;var o=n.memoizedState;return o!==null&&r!==null&&Mi(r,o[1])?o[0]:(n.memoizedState=[e,r],e)}function rm(e,r){var n=yr();r=r===void 0?null:r;var o=n.memoizedState;return o!==null&&r!==null&&Mi(r,o[1])?o[0]:(e=e(),n.memoizedState=[e,r],e)}function sm(e,r,n){return(hn&21)===0?(e.baseState&&(e.baseState=!1,Kt=!0),e.memoizedState=n):(Pr(n,r)||(n=Md(),ot.lanes|=n,fn|=n,e.baseState=!0),r)}function Ix(e,r){var n=Je;Je=n!==0&&4>n?n:4,e(!0);var o=Pi.transition;Pi.transition={};try{e(!1),r()}finally{Je=n,Pi.transition=o}}function nm(){return yr().memoizedState}function $x(e,r,n){var o=As(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},am(e))lm(r,n);else if(n=Du(e,r,n,o),n!==null){var c=Ft();Or(n,e,o,c),om(n,r,o)}}function Dx(e,r,n){var o=As(e),c={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(am(e))lm(r,c);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var y=r.lastRenderedState,_=m(y,n);if(c.hasEagerState=!0,c.eagerState=_,Pr(_,y)){var P=r.interleaved;P===null?(c.next=c,_i(r)):(c.next=P.next,P.next=c),r.interleaved=c;return}}catch{}finally{}n=Du(e,r,c,o),n!==null&&(c=Ft(),Or(n,e,o,c),om(n,r,o))}}function am(e){var r=e.alternate;return e===ot||r!==null&&r===ot}function lm(e,r){Ea=$l=!0;var n=e.pending;n===null?r.next=r:(r.next=n.next,n.next=r),e.pending=r}function om(e,r,n){if((n&4194240)!==0){var o=r.lanes;o&=e.pendingLanes,n|=o,r.lanes=n,Bo(e,n)}}var Al={readContext:gr,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},Ox={readContext:gr,useCallback:function(e,r){return Jr().memoizedState=[e,r===void 0?null:r],e},useContext:gr,useEffect:Xu,useImperativeHandle:function(e,r,n){return n=n!=null?n.concat([e]):null,Dl(4194308,4,Zu.bind(null,r,e),n)},useLayoutEffect:function(e,r){return Dl(4194308,4,e,r)},useInsertionEffect:function(e,r){return Dl(4,2,e,r)},useMemo:function(e,r){var n=Jr();return r=r===void 0?null:r,e=e(),n.memoizedState=[e,r],e},useReducer:function(e,r,n){var o=Jr();return r=n!==void 0?n(r):r,o.memoizedState=o.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},o.queue=e,e=e.dispatch=$x.bind(null,ot,e),[o.memoizedState,e]},useRef:function(e){var r=Jr();return e={current:e},r.memoizedState=e},useState:Ku,useDebugValue:zi,useDeferredValue:function(e){return Jr().memoizedState=e},useTransition:function(){var e=Ku(!1),r=e[0];return e=Ix.bind(null,e[1]),Jr().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,n){var o=ot,c=Jr();if(nt){if(n===void 0)throw Error(l(407));n=n()}else{if(n=r(),kt===null)throw Error(l(349));(hn&30)!==0||Hu(o,r,n)}c.memoizedState=n;var m={value:n,getSnapshot:r};return c.queue=m,Xu(Wu.bind(null,o,m,e),[e]),o.flags|=2048,La(9,Vu.bind(null,o,m,n,r),void 0,null),n},useId:function(){var e=Jr(),r=kt.identifierPrefix;if(nt){var n=cs,o=is;n=(o&~(1<<32-Wt(o)-1)).toString(32)+n,r=":"+r+"R"+n,n=Ca++,0<n&&(r+="H"+n.toString(32)),r+=":"}else n=Mx++,r=":"+r+"r"+n.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},Ax={readContext:gr,useCallback:tm,useContext:gr,useEffect:Ai,useImperativeHandle:em,useInsertionEffect:Yu,useLayoutEffect:Gu,useMemo:rm,useReducer:Di,useRef:Qu,useState:function(){return Di(Ra)},useDebugValue:zi,useDeferredValue:function(e){var r=yr();return sm(r,vt.memoizedState,e)},useTransition:function(){var e=Di(Ra)[0],r=yr().memoizedState;return[e,r]},useMutableSource:Bu,useSyncExternalStore:Uu,useId:nm,unstable_isNewReconciler:!1},zx={readContext:gr,useCallback:tm,useContext:gr,useEffect:Ai,useImperativeHandle:em,useInsertionEffect:Yu,useLayoutEffect:Gu,useMemo:rm,useReducer:Oi,useRef:Qu,useState:function(){return Oi(Ra)},useDebugValue:zi,useDeferredValue:function(e){var r=yr();return vt===null?r.memoizedState=e:sm(r,vt.memoizedState,e)},useTransition:function(){var e=Oi(Ra)[0],r=yr().memoizedState;return[e,r]},useMutableSource:Bu,useSyncExternalStore:Uu,useId:nm,unstable_isNewReconciler:!1};function Ir(e,r){if(e&&e.defaultProps){r=ee({},r),e=e.defaultProps;for(var n in e)r[n]===void 0&&(r[n]=e[n]);return r}return r}function Fi(e,r,n,o){r=e.memoizedState,n=n(o,r),n=n==null?r:ee({},r,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var zl={isMounted:function(e){return(e=e._reactInternals)?We(e)===e:!1},enqueueSetState:function(e,r,n){e=e._reactInternals;var o=Ft(),c=As(e),m=us(o,c);m.payload=r,n!=null&&(m.callback=n),r=Is(e,m,c),r!==null&&(Or(r,e,c,o),Tl(r,e,c))},enqueueReplaceState:function(e,r,n){e=e._reactInternals;var o=Ft(),c=As(e),m=us(o,c);m.tag=1,m.payload=r,n!=null&&(m.callback=n),r=Is(e,m,c),r!==null&&(Or(r,e,c,o),Tl(r,e,c))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var n=Ft(),o=As(e),c=us(n,o);c.tag=2,r!=null&&(c.callback=r),r=Is(e,c,o),r!==null&&(Or(r,e,o,n),Tl(r,e,o))}};function im(e,r,n,o,c,m,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,m,y):r.prototype&&r.prototype.isPureReactComponent?!xa(n,o)||!xa(c,m):!0}function cm(e,r,n){var o=!1,c=Ts,m=r.contextType;return typeof m=="object"&&m!==null?m=gr(m):(c=Jt(r)?on:It.current,o=r.contextTypes,m=(o=o!=null)?In(e,c):Ts),r=new r(n,m),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=zl,e.stateNode=r,r._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=m),r}function dm(e,r,n,o){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(n,o),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(n,o),r.state!==e&&zl.enqueueReplaceState(r,r.state,null)}function Bi(e,r,n,o){var c=e.stateNode;c.props=n,c.state=e.memoizedState,c.refs={},Ei(e);var m=r.contextType;typeof m=="object"&&m!==null?c.context=gr(m):(m=Jt(r)?on:It.current,c.context=In(e,m)),c.state=e.memoizedState,m=r.getDerivedStateFromProps,typeof m=="function"&&(Fi(e,r,m,n),c.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(r=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),r!==c.state&&zl.enqueueReplaceState(c,c.state,null),Pl(e,n,c,o),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function Un(e,r){try{var n="",o=r;do n+=Re(o),o=o.return;while(o);var c=n}catch(m){c=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:r,stack:c,digest:null}}function Ui(e,r,n){return{value:e,source:null,stack:n??null,digest:r??null}}function Hi(e,r){try{console.error(r.value)}catch(n){setTimeout(function(){throw n})}}var Fx=typeof WeakMap=="function"?WeakMap:Map;function um(e,r,n){n=us(-1,n),n.tag=3,n.payload={element:null};var o=r.value;return n.callback=function(){ql||(ql=!0,nc=o),Hi(e,r)},n}function mm(e,r,n){n=us(-1,n),n.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var c=r.value;n.payload=function(){return o(c)},n.callback=function(){Hi(e,r)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(n.callback=function(){Hi(e,r),typeof o!="function"&&(Ds===null?Ds=new Set([this]):Ds.add(this));var y=r.stack;this.componentDidCatch(r.value,{componentStack:y!==null?y:""})}),n}function hm(e,r,n){var o=e.pingCache;if(o===null){o=e.pingCache=new Fx;var c=new Set;o.set(r,c)}else c=o.get(r),c===void 0&&(c=new Set,o.set(r,c));c.has(n)||(c.add(n),e=eg.bind(null,e,r,n),r.then(e,e))}function fm(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function pm(e,r,n,o,c){return(e.mode&1)===0?(e===r?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(r=us(-1,1),r.tag=2,Is(n,r,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=c,e)}var Bx=O.ReactCurrentOwner,Kt=!1;function zt(e,r,n,o){r.child=e===null?$u(r,null,n,o):An(r,e.child,n,o)}function xm(e,r,n,o,c){n=n.render;var m=r.ref;return Fn(r,c),o=Ii(e,r,n,o,m,c),n=$i(),e!==null&&!Kt?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~c,ms(e,r,c)):(nt&&n&&gi(r),r.flags|=1,zt(e,r,o,c),r.child)}function gm(e,r,n,o,c){if(e===null){var m=n.type;return typeof m=="function"&&!uc(m)&&m.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(r.tag=15,r.type=m,ym(e,r,m,o,c)):(e=Gl(n.type,null,o,r,r.mode,c),e.ref=r.ref,e.return=r,r.child=e)}if(m=e.child,(e.lanes&c)===0){var y=m.memoizedProps;if(n=n.compare,n=n!==null?n:xa,n(y,o)&&e.ref===r.ref)return ms(e,r,c)}return r.flags|=1,e=Fs(m,o),e.ref=r.ref,e.return=r,r.child=e}function ym(e,r,n,o,c){if(e!==null){var m=e.memoizedProps;if(xa(m,o)&&e.ref===r.ref)if(Kt=!1,r.pendingProps=o=m,(e.lanes&c)!==0)(e.flags&131072)!==0&&(Kt=!0);else return r.lanes=e.lanes,ms(e,r,c)}return Vi(e,r,n,o,c)}function vm(e,r,n){var o=r.pendingProps,c=o.children,m=e!==null?e.memoizedState:null;if(o.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Vn,dr),dr|=n;else{if((n&1073741824)===0)return e=m!==null?m.baseLanes|n:n,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,Ze(Vn,dr),dr|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=m!==null?m.baseLanes:n,Ze(Vn,dr),dr|=o}else m!==null?(o=m.baseLanes|n,r.memoizedState=null):o=n,Ze(Vn,dr),dr|=o;return zt(e,r,c,n),r.child}function bm(e,r){var n=r.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(r.flags|=512,r.flags|=2097152)}function Vi(e,r,n,o,c){var m=Jt(n)?on:It.current;return m=In(r,m),Fn(r,c),n=Ii(e,r,n,o,m,c),o=$i(),e!==null&&!Kt?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~c,ms(e,r,c)):(nt&&o&&gi(r),r.flags|=1,zt(e,r,n,c),r.child)}function jm(e,r,n,o,c){if(Jt(n)){var m=!0;Nl(r)}else m=!1;if(Fn(r,c),r.stateNode===null)Bl(e,r),cm(r,n,o),Bi(r,n,o,c),o=!0;else if(e===null){var y=r.stateNode,_=r.memoizedProps;y.props=_;var P=y.context,Q=n.contextType;typeof Q=="object"&&Q!==null?Q=gr(Q):(Q=Jt(n)?on:It.current,Q=In(r,Q));var ne=n.getDerivedStateFromProps,le=typeof ne=="function"||typeof y.getSnapshotBeforeUpdate=="function";le||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(_!==o||P!==Q)&&dm(r,y,o,Q),Ms=!1;var te=r.memoizedState;y.state=te,Pl(r,o,y,c),P=r.memoizedState,_!==o||te!==P||qt.current||Ms?(typeof ne=="function"&&(Fi(r,n,ne,o),P=r.memoizedState),(_=Ms||im(r,n,_,o,te,P,Q))?(le||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=o,r.memoizedState=P),y.props=o,y.state=P,y.context=Q,o=_):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),o=!1)}else{y=r.stateNode,Ou(e,r),_=r.memoizedProps,Q=r.type===r.elementType?_:Ir(r.type,_),y.props=Q,le=r.pendingProps,te=y.context,P=n.contextType,typeof P=="object"&&P!==null?P=gr(P):(P=Jt(n)?on:It.current,P=In(r,P));var pe=n.getDerivedStateFromProps;(ne=typeof pe=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(_!==le||te!==P)&&dm(r,y,o,P),Ms=!1,te=r.memoizedState,y.state=te,Pl(r,o,y,c);var ve=r.memoizedState;_!==le||te!==ve||qt.current||Ms?(typeof pe=="function"&&(Fi(r,n,pe,o),ve=r.memoizedState),(Q=Ms||im(r,n,Q,o,te,ve,P)||!1)?(ne||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(o,ve,P),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(o,ve,P)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||_===e.memoizedProps&&te===e.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&te===e.memoizedState||(r.flags|=1024),r.memoizedProps=o,r.memoizedState=ve),y.props=o,y.state=ve,y.context=P,o=Q):(typeof y.componentDidUpdate!="function"||_===e.memoizedProps&&te===e.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&te===e.memoizedState||(r.flags|=1024),o=!1)}return Wi(e,r,n,o,m,c)}function Wi(e,r,n,o,c,m){bm(e,r);var y=(r.flags&128)!==0;if(!o&&!y)return c&&_u(r,n,!1),ms(e,r,m);o=r.stateNode,Bx.current=r;var _=y&&typeof n.getDerivedStateFromError!="function"?null:o.render();return r.flags|=1,e!==null&&y?(r.child=An(r,e.child,null,m),r.child=An(r,null,_,m)):zt(e,r,_,m),r.memoizedState=o.state,c&&_u(r,n,!0),r.child}function wm(e){var r=e.stateNode;r.pendingContext?ku(e,r.pendingContext,r.pendingContext!==r.context):r.context&&ku(e,r.context,!1),Ci(e,r.containerInfo)}function Nm(e,r,n,o,c){return On(),ji(c),r.flags|=256,zt(e,r,n,o),r.child}var qi={dehydrated:null,treeContext:null,retryLane:0};function Ji(e){return{baseLanes:e,cachePool:null,transitions:null}}function km(e,r,n){var o=r.pendingProps,c=lt.current,m=!1,y=(r.flags&128)!==0,_;if((_=y)||(_=e!==null&&e.memoizedState===null?!1:(c&2)!==0),_?(m=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),Ze(lt,c&1),e===null)return bi(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((r.mode&1)===0?r.lanes=1:e.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(y=o.children,e=o.fallback,m?(o=r.mode,m=r.child,y={mode:"hidden",children:y},(o&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=y):m=Zl(y,o,0,null),e=yn(e,o,n,null),m.return=r,e.return=r,m.sibling=e,r.child=m,r.child.memoizedState=Ji(n),r.memoizedState=qi,e):Ki(r,y));if(c=e.memoizedState,c!==null&&(_=c.dehydrated,_!==null))return Ux(e,r,y,o,_,c,n);if(m){m=o.fallback,y=r.mode,c=e.child,_=c.sibling;var P={mode:"hidden",children:o.children};return(y&1)===0&&r.child!==c?(o=r.child,o.childLanes=0,o.pendingProps=P,r.deletions=null):(o=Fs(c,P),o.subtreeFlags=c.subtreeFlags&14680064),_!==null?m=Fs(_,m):(m=yn(m,y,n,null),m.flags|=2),m.return=r,o.return=r,o.sibling=m,r.child=o,o=m,m=r.child,y=e.child.memoizedState,y=y===null?Ji(n):{baseLanes:y.baseLanes|n,cachePool:null,transitions:y.transitions},m.memoizedState=y,m.childLanes=e.childLanes&~n,r.memoizedState=qi,o}return m=e.child,e=m.sibling,o=Fs(m,{mode:"visible",children:o.children}),(r.mode&1)===0&&(o.lanes=n),o.return=r,o.sibling=null,e!==null&&(n=r.deletions,n===null?(r.deletions=[e],r.flags|=16):n.push(e)),r.child=o,r.memoizedState=null,o}function Ki(e,r){return r=Zl({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function Fl(e,r,n,o){return o!==null&&ji(o),An(r,e.child,null,n),e=Ki(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function Ux(e,r,n,o,c,m,y){if(n)return r.flags&256?(r.flags&=-257,o=Ui(Error(l(422))),Fl(e,r,y,o)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(m=o.fallback,c=r.mode,o=Zl({mode:"visible",children:o.children},c,0,null),m=yn(m,c,y,null),m.flags|=2,o.return=r,m.return=r,o.sibling=m,r.child=o,(r.mode&1)!==0&&An(r,e.child,null,y),r.child.memoizedState=Ji(y),r.memoizedState=qi,m);if((r.mode&1)===0)return Fl(e,r,y,null);if(c.data==="$!"){if(o=c.nextSibling&&c.nextSibling.dataset,o)var _=o.dgst;return o=_,m=Error(l(419)),o=Ui(m,o,void 0),Fl(e,r,y,o)}if(_=(y&e.childLanes)!==0,Kt||_){if(o=kt,o!==null){switch(y&-y){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=(c&(o.suspendedLanes|y))!==0?0:c,c!==0&&c!==m.retryLane&&(m.retryLane=c,ds(e,c),Or(o,e,c,-1))}return dc(),o=Ui(Error(l(421))),Fl(e,r,y,o)}return c.data==="$?"?(r.flags|=128,r.child=e.child,r=tg.bind(null,e),c._reactRetry=r,null):(e=m.treeContext,cr=Rs(c.nextSibling),ir=r,nt=!0,Mr=null,e!==null&&(pr[xr++]=is,pr[xr++]=cs,pr[xr++]=cn,is=e.id,cs=e.overflow,cn=r),r=Ki(r,o.children),r.flags|=4096,r)}function Sm(e,r,n){e.lanes|=r;var o=e.alternate;o!==null&&(o.lanes|=r),Si(e.return,r,n)}function Qi(e,r,n,o,c){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:c}:(m.isBackwards=r,m.rendering=null,m.renderingStartTime=0,m.last=o,m.tail=n,m.tailMode=c)}function _m(e,r,n){var o=r.pendingProps,c=o.revealOrder,m=o.tail;if(zt(e,r,o.children,n),o=lt.current,(o&2)!==0)o=o&1|2,r.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Sm(e,n,r);else if(e.tag===19)Sm(e,n,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Ze(lt,o),(r.mode&1)===0)r.memoizedState=null;else switch(c){case"forwards":for(n=r.child,c=null;n!==null;)e=n.alternate,e!==null&&Ml(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=r.child,r.child=null):(c=n.sibling,n.sibling=null),Qi(r,!1,c,n,m);break;case"backwards":for(n=null,c=r.child,r.child=null;c!==null;){if(e=c.alternate,e!==null&&Ml(e)===null){r.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}Qi(r,!0,n,null,m);break;case"together":Qi(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Bl(e,r){(r.mode&1)===0&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function ms(e,r,n){if(e!==null&&(r.dependencies=e.dependencies),fn|=r.lanes,(n&r.childLanes)===0)return null;if(e!==null&&r.child!==e.child)throw Error(l(153));if(r.child!==null){for(e=r.child,n=Fs(e,e.pendingProps),r.child=n,n.return=r;e.sibling!==null;)e=e.sibling,n=n.sibling=Fs(e,e.pendingProps),n.return=r;n.sibling=null}return r.child}function Hx(e,r,n){switch(r.tag){case 3:wm(r),On();break;case 5:Fu(r);break;case 1:Jt(r.type)&&Nl(r);break;case 4:Ci(r,r.stateNode.containerInfo);break;case 10:var o=r.type._context,c=r.memoizedProps.value;Ze(Rl,o._currentValue),o._currentValue=c;break;case 13:if(o=r.memoizedState,o!==null)return o.dehydrated!==null?(Ze(lt,lt.current&1),r.flags|=128,null):(n&r.child.childLanes)!==0?km(e,r,n):(Ze(lt,lt.current&1),e=ms(e,r,n),e!==null?e.sibling:null);Ze(lt,lt.current&1);break;case 19:if(o=(n&r.childLanes)!==0,(e.flags&128)!==0){if(o)return _m(e,r,n);r.flags|=128}if(c=r.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Ze(lt,lt.current),o)break;return null;case 22:case 23:return r.lanes=0,vm(e,r,n)}return ms(e,r,n)}var Em,Xi,Cm,Rm;Em=function(e,r){for(var n=r.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Xi=function(){},Cm=function(e,r,n,o){var c=e.memoizedProps;if(c!==o){e=r.stateNode,mn(qr.current);var m=null;switch(n){case"input":c=xt(e,c),o=xt(e,o),m=[];break;case"select":c=ee({},c,{value:void 0}),o=ee({},o,{value:void 0}),m=[];break;case"textarea":c=Ct(e,c),o=Ct(e,o),m=[];break;default:typeof c.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=bl)}ts(n,o);var y;n=null;for(Q in c)if(!o.hasOwnProperty(Q)&&c.hasOwnProperty(Q)&&c[Q]!=null)if(Q==="style"){var _=c[Q];for(y in _)_.hasOwnProperty(y)&&(n||(n={}),n[y]="")}else Q!=="dangerouslySetInnerHTML"&&Q!=="children"&&Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(d.hasOwnProperty(Q)?m||(m=[]):(m=m||[]).push(Q,null));for(Q in o){var P=o[Q];if(_=c?.[Q],o.hasOwnProperty(Q)&&P!==_&&(P!=null||_!=null))if(Q==="style")if(_){for(y in _)!_.hasOwnProperty(y)||P&&P.hasOwnProperty(y)||(n||(n={}),n[y]="");for(y in P)P.hasOwnProperty(y)&&_[y]!==P[y]&&(n||(n={}),n[y]=P[y])}else n||(m||(m=[]),m.push(Q,n)),n=P;else Q==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,_=_?_.__html:void 0,P!=null&&_!==P&&(m=m||[]).push(Q,P)):Q==="children"?typeof P!="string"&&typeof P!="number"||(m=m||[]).push(Q,""+P):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&(d.hasOwnProperty(Q)?(P!=null&&Q==="onScroll"&&rt("scroll",e),m||_===P||(m=[])):(m=m||[]).push(Q,P))}n&&(m=m||[]).push("style",n);var Q=m;(r.updateQueue=Q)&&(r.flags|=4)}},Rm=function(e,r,n,o){n!==o&&(r.flags|=4)};function Ta(e,r){if(!nt)switch(e.tailMode){case"hidden":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Dt(e){var r=e.alternate!==null&&e.alternate.child===e.child,n=0,o=0;if(r)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,o|=c.subtreeFlags&14680064,o|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,o|=c.subtreeFlags,o|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=o,e.childLanes=n,r}function Vx(e,r,n){var o=r.pendingProps;switch(yi(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(r),null;case 1:return Jt(r.type)&&wl(),Dt(r),null;case 3:return o=r.stateNode,Bn(),st(qt),st(It),Ti(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(El(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Mr!==null&&(oc(Mr),Mr=null))),Xi(e,r),Dt(r),null;case 5:Ri(r);var c=mn(_a.current);if(n=r.type,e!==null&&r.stateNode!=null)Cm(e,r,n,o,c),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!o){if(r.stateNode===null)throw Error(l(166));return Dt(r),null}if(e=mn(qr.current),El(r)){o=r.stateNode,n=r.type;var m=r.memoizedProps;switch(o[Wr]=r,o[ja]=m,e=(r.mode&1)!==0,n){case"dialog":rt("cancel",o),rt("close",o);break;case"iframe":case"object":case"embed":rt("load",o);break;case"video":case"audio":for(c=0;c<ya.length;c++)rt(ya[c],o);break;case"source":rt("error",o);break;case"img":case"image":case"link":rt("error",o),rt("load",o);break;case"details":rt("toggle",o);break;case"input":ie(o,m),rt("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!m.multiple},rt("invalid",o);break;case"textarea":Vt(o,m),rt("invalid",o)}ts(n,m),c=null;for(var y in m)if(m.hasOwnProperty(y)){var _=m[y];y==="children"?typeof _=="string"?o.textContent!==_&&(m.suppressHydrationWarning!==!0&&vl(o.textContent,_,e),c=["children",_]):typeof _=="number"&&o.textContent!==""+_&&(m.suppressHydrationWarning!==!0&&vl(o.textContent,_,e),c=["children",""+_]):d.hasOwnProperty(y)&&_!=null&&y==="onScroll"&&rt("scroll",o)}switch(n){case"input":De(o),Zr(o,m,!0);break;case"textarea":De(o),ys(o);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(o.onclick=bl)}o=c,r.updateQueue=o,o!==null&&(r.flags|=4)}else{y=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ar(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=y.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=y.createElement(n,{is:o.is}):(e=y.createElement(n),n==="select"&&(y=e,o.multiple?y.multiple=!0:o.size&&(y.size=o.size))):e=y.createElementNS(e,n),e[Wr]=r,e[ja]=o,Em(e,r,!1,!1),r.stateNode=e;e:{switch(y=hr(n,o),n){case"dialog":rt("cancel",e),rt("close",e),c=o;break;case"iframe":case"object":case"embed":rt("load",e),c=o;break;case"video":case"audio":for(c=0;c<ya.length;c++)rt(ya[c],e);c=o;break;case"source":rt("error",e),c=o;break;case"img":case"image":case"link":rt("error",e),rt("load",e),c=o;break;case"details":rt("toggle",e),c=o;break;case"input":ie(e,o),c=xt(e,o),rt("invalid",e);break;case"option":c=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},c=ee({},o,{value:void 0}),rt("invalid",e);break;case"textarea":Vt(e,o),c=Ct(e,o),rt("invalid",e);break;default:c=o}ts(n,c),_=c;for(m in _)if(_.hasOwnProperty(m)){var P=_[m];m==="style"?gt(e,P):m==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&vs(e,P)):m==="children"?typeof P=="string"?(n!=="textarea"||P!=="")&&W(e,P):typeof P=="number"&&W(e,""+P):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(d.hasOwnProperty(m)?P!=null&&m==="onScroll"&&rt("scroll",e):P!=null&&N(e,m,P,y))}switch(n){case"input":De(e),Zr(e,o,!1);break;case"textarea":De(e),ys(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Ie(o.value));break;case"select":e.multiple=!!o.multiple,m=o.value,m!=null?Ht(e,!!o.multiple,m,!1):o.defaultValue!=null&&Ht(e,!!o.multiple,o.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=bl)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Dt(r),null;case 6:if(e&&r.stateNode!=null)Rm(e,r,e.memoizedProps,o);else{if(typeof o!="string"&&r.stateNode===null)throw Error(l(166));if(n=mn(_a.current),mn(qr.current),El(r)){if(o=r.stateNode,n=r.memoizedProps,o[Wr]=r,(m=o.nodeValue!==n)&&(e=ir,e!==null))switch(e.tag){case 3:vl(o.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&vl(o.nodeValue,n,(e.mode&1)!==0)}m&&(r.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[Wr]=r,r.stateNode=o}return Dt(r),null;case 13:if(st(lt),o=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(nt&&cr!==null&&(r.mode&1)!==0&&(r.flags&128)===0)Pu(),On(),r.flags|=98560,m=!1;else if(m=El(r),o!==null&&o.dehydrated!==null){if(e===null){if(!m)throw Error(l(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(l(317));m[Wr]=r}else On(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Dt(r),m=!1}else Mr!==null&&(oc(Mr),Mr=null),m=!0;if(!m)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=n,r):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(r.child.flags|=8192,(r.mode&1)!==0&&(e===null||(lt.current&1)!==0?bt===0&&(bt=3):dc())),r.updateQueue!==null&&(r.flags|=4),Dt(r),null);case 4:return Bn(),Xi(e,r),e===null&&va(r.stateNode.containerInfo),Dt(r),null;case 10:return ki(r.type._context),Dt(r),null;case 17:return Jt(r.type)&&wl(),Dt(r),null;case 19:if(st(lt),m=r.memoizedState,m===null)return Dt(r),null;if(o=(r.flags&128)!==0,y=m.rendering,y===null)if(o)Ta(m,!1);else{if(bt!==0||e!==null&&(e.flags&128)!==0)for(e=r.child;e!==null;){if(y=Ml(e),y!==null){for(r.flags|=128,Ta(m,!1),o=y.updateQueue,o!==null&&(r.updateQueue=o,r.flags|=4),r.subtreeFlags=0,o=n,n=r.child;n!==null;)m=n,e=o,m.flags&=14680066,y=m.alternate,y===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=y.childLanes,m.lanes=y.lanes,m.child=y.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=y.memoizedProps,m.memoizedState=y.memoizedState,m.updateQueue=y.updateQueue,m.type=y.type,e=y.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ze(lt,lt.current&1|2),r.child}e=e.sibling}m.tail!==null&&Ye()>Wn&&(r.flags|=128,o=!0,Ta(m,!1),r.lanes=4194304)}else{if(!o)if(e=Ml(y),e!==null){if(r.flags|=128,o=!0,n=e.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),Ta(m,!0),m.tail===null&&m.tailMode==="hidden"&&!y.alternate&&!nt)return Dt(r),null}else 2*Ye()-m.renderingStartTime>Wn&&n!==1073741824&&(r.flags|=128,o=!0,Ta(m,!1),r.lanes=4194304);m.isBackwards?(y.sibling=r.child,r.child=y):(n=m.last,n!==null?n.sibling=y:r.child=y,m.last=y)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=Ye(),r.sibling=null,n=lt.current,Ze(lt,o?n&1|2:n&1),r):(Dt(r),null);case 22:case 23:return cc(),o=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(r.flags|=8192),o&&(r.mode&1)!==0?(dr&1073741824)!==0&&(Dt(r),r.subtreeFlags&6&&(r.flags|=8192)):Dt(r),null;case 24:return null;case 25:return null}throw Error(l(156,r.tag))}function Wx(e,r){switch(yi(r),r.tag){case 1:return Jt(r.type)&&wl(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Bn(),st(qt),st(It),Ti(),e=r.flags,(e&65536)!==0&&(e&128)===0?(r.flags=e&-65537|128,r):null;case 5:return Ri(r),null;case 13:if(st(lt),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(l(340));On()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return st(lt),null;case 4:return Bn(),null;case 10:return ki(r.type._context),null;case 22:case 23:return cc(),null;case 24:return null;default:return null}}var Ul=!1,Ot=!1,qx=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Hn(e,r){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){it(e,r,o)}else n.current=null}function Yi(e,r,n){try{n()}catch(o){it(e,r,o)}}var Lm=!1;function Jx(e,r){if(ci=il,e=iu(),ti(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var c=o.anchorOffset,m=o.focusNode;o=o.focusOffset;try{n.nodeType,m.nodeType}catch{n=null;break e}var y=0,_=-1,P=-1,Q=0,ne=0,le=e,te=null;t:for(;;){for(var pe;le!==n||c!==0&&le.nodeType!==3||(_=y+c),le!==m||o!==0&&le.nodeType!==3||(P=y+o),le.nodeType===3&&(y+=le.nodeValue.length),(pe=le.firstChild)!==null;)te=le,le=pe;for(;;){if(le===e)break t;if(te===n&&++Q===c&&(_=y),te===m&&++ne===o&&(P=y),(pe=le.nextSibling)!==null)break;le=te,te=le.parentNode}le=pe}n=_===-1||P===-1?null:{start:_,end:P}}else n=null}n=n||{start:0,end:0}}else n=null;for(di={focusedElem:e,selectionRange:n},il=!1,xe=r;xe!==null;)if(r=xe,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,xe=e;else for(;xe!==null;){r=xe;try{var ve=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var je=ve.memoizedProps,ut=ve.memoizedState,U=r.stateNode,D=U.getSnapshotBeforeUpdate(r.elementType===r.type?je:Ir(r.type,je),ut);U.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var H=r.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(ue){it(r,r.return,ue)}if(e=r.sibling,e!==null){e.return=r.return,xe=e;break}xe=r.return}return ve=Lm,Lm=!1,ve}function Pa(e,r,n){var o=r.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&e)===e){var m=c.destroy;c.destroy=void 0,m!==void 0&&Yi(r,n,m)}c=c.next}while(c!==o)}}function Hl(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==r)}}function Gi(e){var r=e.ref;if(r!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof r=="function"?r(e):r.current=e}}function Tm(e){var r=e.alternate;r!==null&&(e.alternate=null,Tm(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Wr],delete r[ja],delete r[fi],delete r[Rx],delete r[Lx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Pm(e){return e.tag===5||e.tag===3||e.tag===4}function Mm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Pm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Zi(e,r,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,r?n.nodeType===8?n.parentNode.insertBefore(e,r):n.insertBefore(e,r):(n.nodeType===8?(r=n.parentNode,r.insertBefore(e,n)):(r=n,r.appendChild(e)),n=n._reactRootContainer,n!=null||r.onclick!==null||(r.onclick=bl));else if(o!==4&&(e=e.child,e!==null))for(Zi(e,r,n),e=e.sibling;e!==null;)Zi(e,r,n),e=e.sibling}function ec(e,r,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,r?n.insertBefore(e,r):n.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(ec(e,r,n),e=e.sibling;e!==null;)ec(e,r,n),e=e.sibling}var Lt=null,$r=!1;function $s(e,r,n){for(n=n.child;n!==null;)Im(e,r,n),n=n.sibling}function Im(e,r,n){if(qe&&typeof qe.onCommitFiberUnmount=="function")try{qe.onCommitFiberUnmount(Vr,n)}catch{}switch(n.tag){case 5:Ot||Hn(n,r);case 6:var o=Lt,c=$r;Lt=null,$s(e,r,n),Lt=o,$r=c,Lt!==null&&($r?(e=Lt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Lt.removeChild(n.stateNode));break;case 18:Lt!==null&&($r?(e=Lt,n=n.stateNode,e.nodeType===8?hi(e.parentNode,n):e.nodeType===1&&hi(e,n),da(e)):hi(Lt,n.stateNode));break;case 4:o=Lt,c=$r,Lt=n.stateNode.containerInfo,$r=!0,$s(e,r,n),Lt=o,$r=c;break;case 0:case 11:case 14:case 15:if(!Ot&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){c=o=o.next;do{var m=c,y=m.destroy;m=m.tag,y!==void 0&&((m&2)!==0||(m&4)!==0)&&Yi(n,r,y),c=c.next}while(c!==o)}$s(e,r,n);break;case 1:if(!Ot&&(Hn(n,r),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(_){it(n,r,_)}$s(e,r,n);break;case 21:$s(e,r,n);break;case 22:n.mode&1?(Ot=(o=Ot)||n.memoizedState!==null,$s(e,r,n),Ot=o):$s(e,r,n);break;default:$s(e,r,n)}}function $m(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new qx),r.forEach(function(o){var c=rg.bind(null,e,o);n.has(o)||(n.add(o),o.then(c,c))})}}function Dr(e,r){var n=r.deletions;if(n!==null)for(var o=0;o<n.length;o++){var c=n[o];try{var m=e,y=r,_=y;e:for(;_!==null;){switch(_.tag){case 5:Lt=_.stateNode,$r=!1;break e;case 3:Lt=_.stateNode.containerInfo,$r=!0;break e;case 4:Lt=_.stateNode.containerInfo,$r=!0;break e}_=_.return}if(Lt===null)throw Error(l(160));Im(m,y,c),Lt=null,$r=!1;var P=c.alternate;P!==null&&(P.return=null),c.return=null}catch(Q){it(c,r,Q)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Dm(r,e),r=r.sibling}function Dm(e,r){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Dr(r,e),Kr(e),o&4){try{Pa(3,e,e.return),Hl(3,e)}catch(je){it(e,e.return,je)}try{Pa(5,e,e.return)}catch(je){it(e,e.return,je)}}break;case 1:Dr(r,e),Kr(e),o&512&&n!==null&&Hn(n,n.return);break;case 5:if(Dr(r,e),Kr(e),o&512&&n!==null&&Hn(n,n.return),e.flags&32){var c=e.stateNode;try{W(c,"")}catch(je){it(e,e.return,je)}}if(o&4&&(c=e.stateNode,c!=null)){var m=e.memoizedProps,y=n!==null?n.memoizedProps:m,_=e.type,P=e.updateQueue;if(e.updateQueue=null,P!==null)try{_==="input"&&m.type==="radio"&&m.name!=null&&He(c,m),hr(_,y);var Q=hr(_,m);for(y=0;y<P.length;y+=2){var ne=P[y],le=P[y+1];ne==="style"?gt(c,le):ne==="dangerouslySetInnerHTML"?vs(c,le):ne==="children"?W(c,le):N(c,ne,le,Q)}switch(_){case"input":sr(c,m);break;case"textarea":rn(c,m);break;case"select":var te=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!m.multiple;var pe=m.value;pe!=null?Ht(c,!!m.multiple,pe,!1):te!==!!m.multiple&&(m.defaultValue!=null?Ht(c,!!m.multiple,m.defaultValue,!0):Ht(c,!!m.multiple,m.multiple?[]:"",!1))}c[ja]=m}catch(je){it(e,e.return,je)}}break;case 6:if(Dr(r,e),Kr(e),o&4){if(e.stateNode===null)throw Error(l(162));c=e.stateNode,m=e.memoizedProps;try{c.nodeValue=m}catch(je){it(e,e.return,je)}}break;case 3:if(Dr(r,e),Kr(e),o&4&&n!==null&&n.memoizedState.isDehydrated)try{da(r.containerInfo)}catch(je){it(e,e.return,je)}break;case 4:Dr(r,e),Kr(e);break;case 13:Dr(r,e),Kr(e),c=e.child,c.flags&8192&&(m=c.memoizedState!==null,c.stateNode.isHidden=m,!m||c.alternate!==null&&c.alternate.memoizedState!==null||(sc=Ye())),o&4&&$m(e);break;case 22:if(ne=n!==null&&n.memoizedState!==null,e.mode&1?(Ot=(Q=Ot)||ne,Dr(r,e),Ot=Q):Dr(r,e),Kr(e),o&8192){if(Q=e.memoizedState!==null,(e.stateNode.isHidden=Q)&&!ne&&(e.mode&1)!==0)for(xe=e,ne=e.child;ne!==null;){for(le=xe=ne;xe!==null;){switch(te=xe,pe=te.child,te.tag){case 0:case 11:case 14:case 15:Pa(4,te,te.return);break;case 1:Hn(te,te.return);var ve=te.stateNode;if(typeof ve.componentWillUnmount=="function"){o=te,n=te.return;try{r=o,ve.props=r.memoizedProps,ve.state=r.memoizedState,ve.componentWillUnmount()}catch(je){it(o,n,je)}}break;case 5:Hn(te,te.return);break;case 22:if(te.memoizedState!==null){zm(le);continue}}pe!==null?(pe.return=te,xe=pe):zm(le)}ne=ne.sibling}e:for(ne=null,le=e;;){if(le.tag===5){if(ne===null){ne=le;try{c=le.stateNode,Q?(m=c.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(_=le.stateNode,P=le.memoizedProps.style,y=P!=null&&P.hasOwnProperty("display")?P.display:null,_.style.display=Pt("display",y))}catch(je){it(e,e.return,je)}}}else if(le.tag===6){if(ne===null)try{le.stateNode.nodeValue=Q?"":le.memoizedProps}catch(je){it(e,e.return,je)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===e)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===e)break e;for(;le.sibling===null;){if(le.return===null||le.return===e)break e;ne===le&&(ne=null),le=le.return}ne===le&&(ne=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:Dr(r,e),Kr(e),o&4&&$m(e);break;case 21:break;default:Dr(r,e),Kr(e)}}function Kr(e){var r=e.flags;if(r&2){try{e:{for(var n=e.return;n!==null;){if(Pm(n)){var o=n;break e}n=n.return}throw Error(l(160))}switch(o.tag){case 5:var c=o.stateNode;o.flags&32&&(W(c,""),o.flags&=-33);var m=Mm(e);ec(e,m,c);break;case 3:case 4:var y=o.stateNode.containerInfo,_=Mm(e);Zi(e,_,y);break;default:throw Error(l(161))}}catch(P){it(e,e.return,P)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function Kx(e,r,n){xe=e,Om(e)}function Om(e,r,n){for(var o=(e.mode&1)!==0;xe!==null;){var c=xe,m=c.child;if(c.tag===22&&o){var y=c.memoizedState!==null||Ul;if(!y){var _=c.alternate,P=_!==null&&_.memoizedState!==null||Ot;_=Ul;var Q=Ot;if(Ul=y,(Ot=P)&&!Q)for(xe=c;xe!==null;)y=xe,P=y.child,y.tag===22&&y.memoizedState!==null?Fm(c):P!==null?(P.return=y,xe=P):Fm(c);for(;m!==null;)xe=m,Om(m),m=m.sibling;xe=c,Ul=_,Ot=Q}Am(e)}else(c.subtreeFlags&8772)!==0&&m!==null?(m.return=c,xe=m):Am(e)}}function Am(e){for(;xe!==null;){var r=xe;if((r.flags&8772)!==0){var n=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:Ot||Hl(5,r);break;case 1:var o=r.stateNode;if(r.flags&4&&!Ot)if(n===null)o.componentDidMount();else{var c=r.elementType===r.type?n.memoizedProps:Ir(r.type,n.memoizedProps);o.componentDidUpdate(c,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var m=r.updateQueue;m!==null&&zu(r,m,o);break;case 3:var y=r.updateQueue;if(y!==null){if(n=null,r.child!==null)switch(r.child.tag){case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}zu(r,y,n)}break;case 5:var _=r.stateNode;if(n===null&&r.flags&4){n=_;var P=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&n.focus();break;case"img":P.src&&(n.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var Q=r.alternate;if(Q!==null){var ne=Q.memoizedState;if(ne!==null){var le=ne.dehydrated;le!==null&&da(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(l(163))}Ot||r.flags&512&&Gi(r)}catch(te){it(r,r.return,te)}}if(r===e){xe=null;break}if(n=r.sibling,n!==null){n.return=r.return,xe=n;break}xe=r.return}}function zm(e){for(;xe!==null;){var r=xe;if(r===e){xe=null;break}var n=r.sibling;if(n!==null){n.return=r.return,xe=n;break}xe=r.return}}function Fm(e){for(;xe!==null;){var r=xe;try{switch(r.tag){case 0:case 11:case 15:var n=r.return;try{Hl(4,r)}catch(P){it(r,n,P)}break;case 1:var o=r.stateNode;if(typeof o.componentDidMount=="function"){var c=r.return;try{o.componentDidMount()}catch(P){it(r,c,P)}}var m=r.return;try{Gi(r)}catch(P){it(r,m,P)}break;case 5:var y=r.return;try{Gi(r)}catch(P){it(r,y,P)}}}catch(P){it(r,r.return,P)}if(r===e){xe=null;break}var _=r.sibling;if(_!==null){_.return=r.return,xe=_;break}xe=r.return}}var Qx=Math.ceil,Vl=O.ReactCurrentDispatcher,tc=O.ReactCurrentOwner,vr=O.ReactCurrentBatchConfig,Ue=0,kt=null,ft=null,Tt=0,dr=0,Vn=Ls(0),bt=0,Ma=null,fn=0,Wl=0,rc=0,Ia=null,Qt=null,sc=0,Wn=1/0,hs=null,ql=!1,nc=null,Ds=null,Jl=!1,Os=null,Kl=0,$a=0,ac=null,Ql=-1,Xl=0;function Ft(){return(Ue&6)!==0?Ye():Ql!==-1?Ql:Ql=Ye()}function As(e){return(e.mode&1)===0?1:(Ue&2)!==0&&Tt!==0?Tt&-Tt:Px.transition!==null?(Xl===0&&(Xl=Md()),Xl):(e=Je,e!==0||(e=window.event,e=e===void 0?16:Ud(e.type)),e)}function Or(e,r,n,o){if(50<$a)throw $a=0,ac=null,Error(l(185));aa(e,n,o),((Ue&2)===0||e!==kt)&&(e===kt&&((Ue&2)===0&&(Wl|=n),bt===4&&zs(e,Tt)),Xt(e,o),n===1&&Ue===0&&(r.mode&1)===0&&(Wn=Ye()+500,kl&&Ps()))}function Xt(e,r){var n=e.callbackNode;Pp(e,r);var o=al(e,e===kt?Tt:0);if(o===0)n!==null&&Tr(n),e.callbackNode=null,e.callbackPriority=0;else if(r=o&-o,e.callbackPriority!==r){if(n!=null&&Tr(n),r===1)e.tag===0?Tx(Um.bind(null,e)):Eu(Um.bind(null,e)),Ex(function(){(Ue&6)===0&&Ps()}),n=null;else{switch(Id(o)){case 1:n=ws;break;case 4:n=nn;break;case 16:n=Fe;break;case 536870912:n=an;break;default:n=Fe}n=Xm(n,Bm.bind(null,e))}e.callbackPriority=r,e.callbackNode=n}}function Bm(e,r){if(Ql=-1,Xl=0,(Ue&6)!==0)throw Error(l(327));var n=e.callbackNode;if(qn()&&e.callbackNode!==n)return null;var o=al(e,e===kt?Tt:0);if(o===0)return null;if((o&30)!==0||(o&e.expiredLanes)!==0||r)r=Yl(e,o);else{r=o;var c=Ue;Ue|=2;var m=Vm();(kt!==e||Tt!==r)&&(hs=null,Wn=Ye()+500,xn(e,r));do try{Gx();break}catch(_){Hm(e,_)}while(!0);Ni(),Vl.current=m,Ue=c,ft!==null?r=0:(kt=null,Tt=0,r=bt)}if(r!==0){if(r===2&&(c=zo(e),c!==0&&(o=c,r=lc(e,c))),r===1)throw n=Ma,xn(e,0),zs(e,o),Xt(e,Ye()),n;if(r===6)zs(e,o);else{if(c=e.current.alternate,(o&30)===0&&!Xx(c)&&(r=Yl(e,o),r===2&&(m=zo(e),m!==0&&(o=m,r=lc(e,m))),r===1))throw n=Ma,xn(e,0),zs(e,o),Xt(e,Ye()),n;switch(e.finishedWork=c,e.finishedLanes=o,r){case 0:case 1:throw Error(l(345));case 2:gn(e,Qt,hs);break;case 3:if(zs(e,o),(o&130023424)===o&&(r=sc+500-Ye(),10<r)){if(al(e,0)!==0)break;if(c=e.suspendedLanes,(c&o)!==o){Ft(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=mi(gn.bind(null,e,Qt,hs),r);break}gn(e,Qt,hs);break;case 4:if(zs(e,o),(o&4194240)===o)break;for(r=e.eventTimes,c=-1;0<o;){var y=31-Wt(o);m=1<<y,y=r[y],y>c&&(c=y),o&=~m}if(o=c,o=Ye()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Qx(o/1960))-o,10<o){e.timeoutHandle=mi(gn.bind(null,e,Qt,hs),o);break}gn(e,Qt,hs);break;case 5:gn(e,Qt,hs);break;default:throw Error(l(329))}}}return Xt(e,Ye()),e.callbackNode===n?Bm.bind(null,e):null}function lc(e,r){var n=Ia;return e.current.memoizedState.isDehydrated&&(xn(e,r).flags|=256),e=Yl(e,r),e!==2&&(r=Qt,Qt=n,r!==null&&oc(r)),e}function oc(e){Qt===null?Qt=e:Qt.push.apply(Qt,e)}function Xx(e){for(var r=e;;){if(r.flags&16384){var n=r.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var c=n[o],m=c.getSnapshot;c=c.value;try{if(!Pr(m(),c))return!1}catch{return!1}}}if(n=r.child,r.subtreeFlags&16384&&n!==null)n.return=r,r=n;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function zs(e,r){for(r&=~rc,r&=~Wl,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var n=31-Wt(r),o=1<<n;e[n]=-1,r&=~o}}function Um(e){if((Ue&6)!==0)throw Error(l(327));qn();var r=al(e,0);if((r&1)===0)return Xt(e,Ye()),null;var n=Yl(e,r);if(e.tag!==0&&n===2){var o=zo(e);o!==0&&(r=o,n=lc(e,o))}if(n===1)throw n=Ma,xn(e,0),zs(e,r),Xt(e,Ye()),n;if(n===6)throw Error(l(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,gn(e,Qt,hs),Xt(e,Ye()),null}function ic(e,r){var n=Ue;Ue|=1;try{return e(r)}finally{Ue=n,Ue===0&&(Wn=Ye()+500,kl&&Ps())}}function pn(e){Os!==null&&Os.tag===0&&(Ue&6)===0&&qn();var r=Ue;Ue|=1;var n=vr.transition,o=Je;try{if(vr.transition=null,Je=1,e)return e()}finally{Je=o,vr.transition=n,Ue=r,(Ue&6)===0&&Ps()}}function cc(){dr=Vn.current,st(Vn)}function xn(e,r){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,_x(n)),ft!==null)for(n=ft.return;n!==null;){var o=n;switch(yi(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&wl();break;case 3:Bn(),st(qt),st(It),Ti();break;case 5:Ri(o);break;case 4:Bn();break;case 13:st(lt);break;case 19:st(lt);break;case 10:ki(o.type._context);break;case 22:case 23:cc()}n=n.return}if(kt=e,ft=e=Fs(e.current,null),Tt=dr=r,bt=0,Ma=null,rc=Wl=fn=0,Qt=Ia=null,un!==null){for(r=0;r<un.length;r++)if(n=un[r],o=n.interleaved,o!==null){n.interleaved=null;var c=o.next,m=n.pending;if(m!==null){var y=m.next;m.next=c,o.next=y}n.pending=o}un=null}return e}function Hm(e,r){do{var n=ft;try{if(Ni(),Il.current=Al,$l){for(var o=ot.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}$l=!1}if(hn=0,Nt=vt=ot=null,Ea=!1,Ca=0,tc.current=null,n===null||n.return===null){bt=1,Ma=r,ft=null;break}e:{var m=e,y=n.return,_=n,P=r;if(r=Tt,_.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var Q=P,ne=_,le=ne.tag;if((ne.mode&1)===0&&(le===0||le===11||le===15)){var te=ne.alternate;te?(ne.updateQueue=te.updateQueue,ne.memoizedState=te.memoizedState,ne.lanes=te.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var pe=fm(y);if(pe!==null){pe.flags&=-257,pm(pe,y,_,m,r),pe.mode&1&&hm(m,Q,r),r=pe,P=Q;var ve=r.updateQueue;if(ve===null){var je=new Set;je.add(P),r.updateQueue=je}else ve.add(P);break e}else{if((r&1)===0){hm(m,Q,r),dc();break e}P=Error(l(426))}}else if(nt&&_.mode&1){var ut=fm(y);if(ut!==null){(ut.flags&65536)===0&&(ut.flags|=256),pm(ut,y,_,m,r),ji(Un(P,_));break e}}m=P=Un(P,_),bt!==4&&(bt=2),Ia===null?Ia=[m]:Ia.push(m),m=y;do{switch(m.tag){case 3:m.flags|=65536,r&=-r,m.lanes|=r;var U=um(m,P,r);Au(m,U);break e;case 1:_=P;var D=m.type,H=m.stateNode;if((m.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Ds===null||!Ds.has(H)))){m.flags|=65536,r&=-r,m.lanes|=r;var ue=mm(m,_,r);Au(m,ue);break e}}m=m.return}while(m!==null)}qm(n)}catch(Ne){r=Ne,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function Vm(){var e=Vl.current;return Vl.current=Al,e===null?Al:e}function dc(){(bt===0||bt===3||bt===2)&&(bt=4),kt===null||(fn&268435455)===0&&(Wl&268435455)===0||zs(kt,Tt)}function Yl(e,r){var n=Ue;Ue|=2;var o=Vm();(kt!==e||Tt!==r)&&(hs=null,xn(e,r));do try{Yx();break}catch(c){Hm(e,c)}while(!0);if(Ni(),Ue=n,Vl.current=o,ft!==null)throw Error(l(261));return kt=null,Tt=0,bt}function Yx(){for(;ft!==null;)Wm(ft)}function Gx(){for(;ft!==null&&!fr();)Wm(ft)}function Wm(e){var r=Qm(e.alternate,e,dr);e.memoizedProps=e.pendingProps,r===null?qm(e):ft=r,tc.current=null}function qm(e){var r=e;do{var n=r.alternate;if(e=r.return,(r.flags&32768)===0){if(n=Vx(n,r,dr),n!==null){ft=n;return}}else{if(n=Wx(n,r),n!==null){n.flags&=32767,ft=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{bt=6,ft=null;return}}if(r=r.sibling,r!==null){ft=r;return}ft=r=e}while(r!==null);bt===0&&(bt=5)}function gn(e,r,n){var o=Je,c=vr.transition;try{vr.transition=null,Je=1,Zx(e,r,n,o)}finally{vr.transition=c,Je=o}return null}function Zx(e,r,n,o){do qn();while(Os!==null);if((Ue&6)!==0)throw Error(l(327));n=e.finishedWork;var c=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(l(177));e.callbackNode=null,e.callbackPriority=0;var m=n.lanes|n.childLanes;if(Mp(e,m),e===kt&&(ft=kt=null,Tt=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Jl||(Jl=!0,Xm(Fe,function(){return qn(),null})),m=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||m){m=vr.transition,vr.transition=null;var y=Je;Je=1;var _=Ue;Ue|=4,tc.current=null,Jx(e,n),Dm(n,e),vx(di),il=!!ci,di=ci=null,e.current=n,Kx(n),sa(),Ue=_,Je=y,vr.transition=m}else e.current=n;if(Jl&&(Jl=!1,Os=e,Kl=c),m=e.pendingLanes,m===0&&(Ds=null),kn(n.stateNode),Xt(e,Ye()),r!==null)for(o=e.onRecoverableError,n=0;n<r.length;n++)c=r[n],o(c.value,{componentStack:c.stack,digest:c.digest});if(ql)throw ql=!1,e=nc,nc=null,e;return(Kl&1)!==0&&e.tag!==0&&qn(),m=e.pendingLanes,(m&1)!==0?e===ac?$a++:($a=0,ac=e):$a=0,Ps(),null}function qn(){if(Os!==null){var e=Id(Kl),r=vr.transition,n=Je;try{if(vr.transition=null,Je=16>e?16:e,Os===null)var o=!1;else{if(e=Os,Os=null,Kl=0,(Ue&6)!==0)throw Error(l(331));var c=Ue;for(Ue|=4,xe=e.current;xe!==null;){var m=xe,y=m.child;if((xe.flags&16)!==0){var _=m.deletions;if(_!==null){for(var P=0;P<_.length;P++){var Q=_[P];for(xe=Q;xe!==null;){var ne=xe;switch(ne.tag){case 0:case 11:case 15:Pa(8,ne,m)}var le=ne.child;if(le!==null)le.return=ne,xe=le;else for(;xe!==null;){ne=xe;var te=ne.sibling,pe=ne.return;if(Tm(ne),ne===Q){xe=null;break}if(te!==null){te.return=pe,xe=te;break}xe=pe}}}var ve=m.alternate;if(ve!==null){var je=ve.child;if(je!==null){ve.child=null;do{var ut=je.sibling;je.sibling=null,je=ut}while(je!==null)}}xe=m}}if((m.subtreeFlags&2064)!==0&&y!==null)y.return=m,xe=y;else e:for(;xe!==null;){if(m=xe,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:Pa(9,m,m.return)}var U=m.sibling;if(U!==null){U.return=m.return,xe=U;break e}xe=m.return}}var D=e.current;for(xe=D;xe!==null;){y=xe;var H=y.child;if((y.subtreeFlags&2064)!==0&&H!==null)H.return=y,xe=H;else e:for(y=D;xe!==null;){if(_=xe,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:Hl(9,_)}}catch(Ne){it(_,_.return,Ne)}if(_===y){xe=null;break e}var ue=_.sibling;if(ue!==null){ue.return=_.return,xe=ue;break e}xe=_.return}}if(Ue=c,Ps(),qe&&typeof qe.onPostCommitFiberRoot=="function")try{qe.onPostCommitFiberRoot(Vr,e)}catch{}o=!0}return o}finally{Je=n,vr.transition=r}}return!1}function Jm(e,r,n){r=Un(n,r),r=um(e,r,1),e=Is(e,r,1),r=Ft(),e!==null&&(aa(e,1,r),Xt(e,r))}function it(e,r,n){if(e.tag===3)Jm(e,e,n);else for(;r!==null;){if(r.tag===3){Jm(r,e,n);break}else if(r.tag===1){var o=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ds===null||!Ds.has(o))){e=Un(n,e),e=mm(r,e,1),r=Is(r,e,1),e=Ft(),r!==null&&(aa(r,1,e),Xt(r,e));break}}r=r.return}}function eg(e,r,n){var o=e.pingCache;o!==null&&o.delete(r),r=Ft(),e.pingedLanes|=e.suspendedLanes&n,kt===e&&(Tt&n)===n&&(bt===4||bt===3&&(Tt&130023424)===Tt&&500>Ye()-sc?xn(e,0):rc|=n),Xt(e,r)}function Km(e,r){r===0&&((e.mode&1)===0?r=1:(r=nl,nl<<=1,(nl&130023424)===0&&(nl=4194304)));var n=Ft();e=ds(e,r),e!==null&&(aa(e,r,n),Xt(e,n))}function tg(e){var r=e.memoizedState,n=0;r!==null&&(n=r.retryLane),Km(e,n)}function rg(e,r){var n=0;switch(e.tag){case 13:var o=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(l(314))}o!==null&&o.delete(r),Km(e,n)}var Qm;Qm=function(e,r,n){if(e!==null)if(e.memoizedProps!==r.pendingProps||qt.current)Kt=!0;else{if((e.lanes&n)===0&&(r.flags&128)===0)return Kt=!1,Hx(e,r,n);Kt=(e.flags&131072)!==0}else Kt=!1,nt&&(r.flags&1048576)!==0&&Cu(r,_l,r.index);switch(r.lanes=0,r.tag){case 2:var o=r.type;Bl(e,r),e=r.pendingProps;var c=In(r,It.current);Fn(r,n),c=Ii(null,r,o,e,c,n);var m=$i();return r.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Jt(o)?(m=!0,Nl(r)):m=!1,r.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,Ei(r),c.updater=zl,r.stateNode=c,c._reactInternals=r,Bi(r,o,e,n),r=Wi(null,r,o,!0,m,n)):(r.tag=0,nt&&m&&gi(r),zt(null,r,c,n),r=r.child),r;case 16:o=r.elementType;e:{switch(Bl(e,r),e=r.pendingProps,c=o._init,o=c(o._payload),r.type=o,c=r.tag=ng(o),e=Ir(o,e),c){case 0:r=Vi(null,r,o,e,n);break e;case 1:r=jm(null,r,o,e,n);break e;case 11:r=xm(null,r,o,e,n);break e;case 14:r=gm(null,r,o,Ir(o.type,e),n);break e}throw Error(l(306,o,""))}return r;case 0:return o=r.type,c=r.pendingProps,c=r.elementType===o?c:Ir(o,c),Vi(e,r,o,c,n);case 1:return o=r.type,c=r.pendingProps,c=r.elementType===o?c:Ir(o,c),jm(e,r,o,c,n);case 3:e:{if(wm(r),e===null)throw Error(l(387));o=r.pendingProps,m=r.memoizedState,c=m.element,Ou(e,r),Pl(r,o,null,n);var y=r.memoizedState;if(o=y.element,m.isDehydrated)if(m={element:o,isDehydrated:!1,cache:y.cache,pendingSuspenseBoundaries:y.pendingSuspenseBoundaries,transitions:y.transitions},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){c=Un(Error(l(423)),r),r=Nm(e,r,o,n,c);break e}else if(o!==c){c=Un(Error(l(424)),r),r=Nm(e,r,o,n,c);break e}else for(cr=Rs(r.stateNode.containerInfo.firstChild),ir=r,nt=!0,Mr=null,n=$u(r,null,o,n),r.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(On(),o===c){r=ms(e,r,n);break e}zt(e,r,o,n)}r=r.child}return r;case 5:return Fu(r),e===null&&bi(r),o=r.type,c=r.pendingProps,m=e!==null?e.memoizedProps:null,y=c.children,ui(o,c)?y=null:m!==null&&ui(o,m)&&(r.flags|=32),bm(e,r),zt(e,r,y,n),r.child;case 6:return e===null&&bi(r),null;case 13:return km(e,r,n);case 4:return Ci(r,r.stateNode.containerInfo),o=r.pendingProps,e===null?r.child=An(r,null,o,n):zt(e,r,o,n),r.child;case 11:return o=r.type,c=r.pendingProps,c=r.elementType===o?c:Ir(o,c),xm(e,r,o,c,n);case 7:return zt(e,r,r.pendingProps,n),r.child;case 8:return zt(e,r,r.pendingProps.children,n),r.child;case 12:return zt(e,r,r.pendingProps.children,n),r.child;case 10:e:{if(o=r.type._context,c=r.pendingProps,m=r.memoizedProps,y=c.value,Ze(Rl,o._currentValue),o._currentValue=y,m!==null)if(Pr(m.value,y)){if(m.children===c.children&&!qt.current){r=ms(e,r,n);break e}}else for(m=r.child,m!==null&&(m.return=r);m!==null;){var _=m.dependencies;if(_!==null){y=m.child;for(var P=_.firstContext;P!==null;){if(P.context===o){if(m.tag===1){P=us(-1,n&-n),P.tag=2;var Q=m.updateQueue;if(Q!==null){Q=Q.shared;var ne=Q.pending;ne===null?P.next=P:(P.next=ne.next,ne.next=P),Q.pending=P}}m.lanes|=n,P=m.alternate,P!==null&&(P.lanes|=n),Si(m.return,n,r),_.lanes|=n;break}P=P.next}}else if(m.tag===10)y=m.type===r.type?null:m.child;else if(m.tag===18){if(y=m.return,y===null)throw Error(l(341));y.lanes|=n,_=y.alternate,_!==null&&(_.lanes|=n),Si(y,n,r),y=m.sibling}else y=m.child;if(y!==null)y.return=m;else for(y=m;y!==null;){if(y===r){y=null;break}if(m=y.sibling,m!==null){m.return=y.return,y=m;break}y=y.return}m=y}zt(e,r,c.children,n),r=r.child}return r;case 9:return c=r.type,o=r.pendingProps.children,Fn(r,n),c=gr(c),o=o(c),r.flags|=1,zt(e,r,o,n),r.child;case 14:return o=r.type,c=Ir(o,r.pendingProps),c=Ir(o.type,c),gm(e,r,o,c,n);case 15:return ym(e,r,r.type,r.pendingProps,n);case 17:return o=r.type,c=r.pendingProps,c=r.elementType===o?c:Ir(o,c),Bl(e,r),r.tag=1,Jt(o)?(e=!0,Nl(r)):e=!1,Fn(r,n),cm(r,o,c),Bi(r,o,c,n),Wi(null,r,o,!0,e,n);case 19:return _m(e,r,n);case 22:return vm(e,r,n)}throw Error(l(156,r.tag))};function Xm(e,r){return js(e,r)}function sg(e,r,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(e,r,n,o){return new sg(e,r,n,o)}function uc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ng(e){if(typeof e=="function")return uc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Z)return 11;if(e===z)return 14}return 2}function Fs(e,r){var n=e.alternate;return n===null?(n=br(e.tag,r,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=r,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,r=e.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Gl(e,r,n,o,c,m){var y=2;if(o=e,typeof e=="function")uc(e)&&(y=1);else if(typeof e=="string")y=5;else e:switch(e){case I:return yn(n.children,c,m,r);case A:y=8,c|=8;break;case J:return e=br(12,n,r,c|2),e.elementType=J,e.lanes=m,e;case V:return e=br(13,n,r,c),e.elementType=V,e.lanes=m,e;case $:return e=br(19,n,r,c),e.elementType=$,e.lanes=m,e;case se:return Zl(n,c,m,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ae:y=10;break e;case Y:y=9;break e;case Z:y=11;break e;case z:y=14;break e;case q:y=16,o=null;break e}throw Error(l(130,e==null?e:typeof e,""))}return r=br(y,n,r,c),r.elementType=e,r.type=o,r.lanes=m,r}function yn(e,r,n,o){return e=br(7,e,o,r),e.lanes=n,e}function Zl(e,r,n,o){return e=br(22,e,o,r),e.elementType=se,e.lanes=n,e.stateNode={isHidden:!1},e}function mc(e,r,n){return e=br(6,e,null,r),e.lanes=n,e}function hc(e,r,n){return r=br(4,e.children!==null?e.children:[],e.key,r),r.lanes=n,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function ag(e,r,n,o,c){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fo(0),this.expirationTimes=Fo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fo(0),this.identifierPrefix=o,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function fc(e,r,n,o,c,m,y,_,P){return e=new ag(e,r,n,_,P),r===1?(r=1,m===!0&&(r|=8)):r=0,m=br(3,null,null,r),e.current=m,m.stateNode=e,m.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ei(m),e}function lg(e,r,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:w,key:o==null?null:""+o,children:e,containerInfo:r,implementation:n}}function Ym(e){if(!e)return Ts;e=e._reactInternals;e:{if(We(e)!==e||e.tag!==1)throw Error(l(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Jt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(l(171))}if(e.tag===1){var n=e.type;if(Jt(n))return Su(e,n,r)}return r}function Gm(e,r,n,o,c,m,y,_,P){return e=fc(n,o,!0,e,c,m,y,_,P),e.context=Ym(null),n=e.current,o=Ft(),c=As(n),m=us(o,c),m.callback=r??null,Is(n,m,c),e.current.lanes=c,aa(e,c,o),Xt(e,o),e}function eo(e,r,n,o){var c=r.current,m=Ft(),y=As(c);return n=Ym(n),r.context===null?r.context=n:r.pendingContext=n,r=us(m,y),r.payload={element:e},o=o===void 0?null:o,o!==null&&(r.callback=o),e=Is(c,r,y),e!==null&&(Or(e,c,y,m),Tl(e,c,y)),y}function to(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Zm(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<r?n:r}}function pc(e,r){Zm(e,r),(e=e.alternate)&&Zm(e,r)}function og(){return null}var eh=typeof reportError=="function"?reportError:function(e){console.error(e)};function xc(e){this._internalRoot=e}ro.prototype.render=xc.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(l(409));eo(e,r,null,null)},ro.prototype.unmount=xc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;pn(function(){eo(null,e,null,null)}),r[ls]=null}};function ro(e){this._internalRoot=e}ro.prototype.unstable_scheduleHydration=function(e){if(e){var r=Od();e={blockedOn:null,target:e,priority:r};for(var n=0;n<_s.length&&r!==0&&r<_s[n].priority;n++);_s.splice(n,0,e),n===0&&Fd(e)}};function gc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function so(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function th(){}function ig(e,r,n,o,c){if(c){if(typeof o=="function"){var m=o;o=function(){var Q=to(y);m.call(Q)}}var y=Gm(r,o,e,0,null,!1,!1,"",th);return e._reactRootContainer=y,e[ls]=y.current,va(e.nodeType===8?e.parentNode:e),pn(),y}for(;c=e.lastChild;)e.removeChild(c);if(typeof o=="function"){var _=o;o=function(){var Q=to(P);_.call(Q)}}var P=fc(e,0,!1,null,null,!1,!1,"",th);return e._reactRootContainer=P,e[ls]=P.current,va(e.nodeType===8?e.parentNode:e),pn(function(){eo(r,P,n,o)}),P}function no(e,r,n,o,c){var m=n._reactRootContainer;if(m){var y=m;if(typeof c=="function"){var _=c;c=function(){var P=to(y);_.call(P)}}eo(r,y,e,c)}else y=ig(n,r,e,c,o);return to(y)}$d=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var n=na(r.pendingLanes);n!==0&&(Bo(r,n|1),Xt(r,Ye()),(Ue&6)===0&&(Wn=Ye()+500,Ps()))}break;case 13:pn(function(){var o=ds(e,1);if(o!==null){var c=Ft();Or(o,e,1,c)}}),pc(e,1)}},Uo=function(e){if(e.tag===13){var r=ds(e,134217728);if(r!==null){var n=Ft();Or(r,e,134217728,n)}pc(e,134217728)}},Dd=function(e){if(e.tag===13){var r=As(e),n=ds(e,r);if(n!==null){var o=Ft();Or(n,e,r,o)}pc(e,r)}},Od=function(){return Je},Ad=function(e,r){var n=Je;try{return Je=e,r()}finally{Je=n}},sn=function(e,r,n){switch(r){case"input":if(sr(e,n),r=n.name,n.type==="radio"&&r!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<n.length;r++){var o=n[r];if(o!==e&&o.form===e.form){var c=jl(o);if(!c)throw Error(l(90));Ke(o),sr(o,c)}}}break;case"textarea":rn(e,n);break;case"select":r=n.value,r!=null&&Ht(e,!!n.multiple,r,!1)}},Mt=ic,Rt=pn;var cg={usingClientEntryPoint:!1,Events:[wa,Pn,jl,lr,bs,ic]},Da={findFiberByHostInstance:ln,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dg={bundleType:Da.bundleType,version:Da.version,rendererPackageName:Da.rendererPackageName,rendererConfig:Da.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Qe(e),e===null?null:e.stateNode},findFiberByHostInstance:Da.findFiberByHostInstance||og,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ao=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ao.isDisabled&&ao.supportsFiber)try{Vr=ao.inject(dg),qe=ao}catch{}}return Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cg,Yt.createPortal=function(e,r){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gc(r))throw Error(l(200));return lg(e,r,null,n)},Yt.createRoot=function(e,r){if(!gc(e))throw Error(l(299));var n=!1,o="",c=eh;return r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(c=r.onRecoverableError)),r=fc(e,1,!1,null,null,n,!1,o,c),e[ls]=r.current,va(e.nodeType===8?e.parentNode:e),new xc(r)},Yt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=Qe(r),e=e===null?null:e.stateNode,e},Yt.flushSync=function(e){return pn(e)},Yt.hydrate=function(e,r,n){if(!so(r))throw Error(l(200));return no(null,e,r,!0,n)},Yt.hydrateRoot=function(e,r,n){if(!gc(e))throw Error(l(405));var o=n!=null&&n.hydratedSources||null,c=!1,m="",y=eh;if(n!=null&&(n.unstable_strictMode===!0&&(c=!0),n.identifierPrefix!==void 0&&(m=n.identifierPrefix),n.onRecoverableError!==void 0&&(y=n.onRecoverableError)),r=Gm(r,null,e,1,n??null,c,!1,m,y),e[ls]=r.current,va(e),o)for(e=0;e<o.length;e++)n=o[e],c=n._getVersion,c=c(n._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[n,c]:r.mutableSourceEagerHydrationData.push(n,c);return new ro(r)},Yt.render=function(e,r,n){if(!so(r))throw Error(l(200));return no(null,e,r,!1,n)},Yt.unmountComponentAtNode=function(e){if(!so(e))throw Error(l(40));return e._reactRootContainer?(pn(function(){no(null,null,e,!1,function(){e._reactRootContainer=null,e[ls]=null})}),!0):!1},Yt.unstable_batchedUpdates=ic,Yt.unstable_renderSubtreeIntoContainer=function(e,r,n,o){if(!so(n))throw Error(l(200));if(e==null||e._reactInternals===void 0)throw Error(l(38));return no(e,r,n,!1,o)},Yt.version="18.3.1-next-f1338f8080-20240426",Yt}var ch;function df(){if(ch)return bc.exports;ch=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(a){console.error(a)}}return s(),bc.exports=yg(),bc.exports}var dh;function vg(){if(dh)return lo;dh=1;var s=df();return lo.createRoot=s.createRoot,lo.hydrateRoot=s.hydrateRoot,lo}var bg=vg();const jg=cf(bg);/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var uf=s=>{throw TypeError(s)},wg=(s,a,l)=>a.has(s)||uf("Cannot "+l),Nc=(s,a,l)=>(wg(s,a,"read from private field"),l?l.call(s):a.get(s)),Ng=(s,a,l)=>a.has(s)?uf("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(s):a.set(s,l),uh="popstate";function kg(s={}){function a(i,d){let{pathname:u,search:f,hash:p}=i.location;return Ja("",{pathname:u,search:f,hash:p},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function l(i,d){return typeof d=="string"?d:Gs(d)}return _g(a,l,null,s)}function Ae(s,a){if(s===!1||s===null||typeof s>"u")throw new Error(a)}function dt(s,a){if(!s){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function Sg(){return Math.random().toString(36).substring(2,10)}function mh(s,a){return{usr:s.state,key:s.key,idx:a}}function Ja(s,a,l=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof a=="string"?Zs(a):a,state:l,key:a&&a.key||i||Sg()}}function Gs({pathname:s="/",search:a="",hash:l=""}){return a&&a!=="?"&&(s+=a.charAt(0)==="?"?a:"?"+a),l&&l!=="#"&&(s+=l.charAt(0)==="#"?l:"#"+l),s}function Zs(s){let a={};if(s){let l=s.indexOf("#");l>=0&&(a.hash=s.substring(l),s=s.substring(0,l));let i=s.indexOf("?");i>=0&&(a.search=s.substring(i),s=s.substring(0,i)),s&&(a.pathname=s)}return a}function _g(s,a,l,i={}){let{window:d=document.defaultView,v5Compat:u=!1}=i,f=d.history,p="POP",x=null,g=v();g==null&&(g=0,f.replaceState({...f.state,idx:g},""));function v(){return(f.state||{idx:null}).idx}function b(){p="POP";let S=v(),k=S==null?null:S-g;g=S,x&&x({action:p,location:E.location,delta:k})}function j(S,k){p="PUSH";let C=Ja(E.location,S,k);g=v()+1;let N=mh(C,g),O=E.createHref(C);try{f.pushState(N,"",O)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;d.location.assign(O)}u&&x&&x({action:p,location:E.location,delta:1})}function R(S,k){p="REPLACE";let C=Ja(E.location,S,k);g=v();let N=mh(C,g),O=E.createHref(C);f.replaceState(N,"",O),u&&x&&x({action:p,location:E.location,delta:0})}function M(S){return mf(S)}let E={get action(){return p},get location(){return s(d,f)},listen(S){if(x)throw new Error("A history only accepts one active listener");return d.addEventListener(uh,b),x=S,()=>{d.removeEventListener(uh,b),x=null}},createHref(S){return a(d,S)},createURL:M,encodeLocation(S){let k=M(S);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:j,replace:R,go(S){return f.go(S)}};return E}function mf(s,a=!1){let l="http://localhost";typeof window<"u"&&(l=window.location.origin!=="null"?window.location.origin:window.location.href),Ae(l,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:Gs(s);return i=i.replace(/ $/,"%20"),!a&&i.startsWith("//")&&(i=l+i),new URL(i,l)}var Ha,hh=class{constructor(s){if(Ng(this,Ha,new Map),s)for(let[a,l]of s)this.set(a,l)}get(s){if(Nc(this,Ha).has(s))return Nc(this,Ha).get(s);if(s.defaultValue!==void 0)return s.defaultValue;throw new Error("No value found for context")}set(s,a){Nc(this,Ha).set(s,a)}};Ha=new WeakMap;var Eg=new Set(["lazy","caseSensitive","path","id","index","children"]);function Cg(s){return Eg.has(s)}var Rg=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function Lg(s){return Rg.has(s)}function Tg(s){return s.index===!0}function Ka(s,a,l=[],i={},d=!1){return s.map((u,f)=>{let p=[...l,String(f)],x=typeof u.id=="string"?u.id:p.join("-");if(Ae(u.index!==!0||!u.children,"Cannot specify children on an index route"),Ae(d||!i[x],`Found a route id collision on id "${x}".  Route id's must be globally unique within Data Router usages`),Tg(u)){let g={...u,...a(u),id:x};return i[x]=g,g}else{let g={...u,...a(u),id:x,children:void 0};return i[x]=g,u.children&&(g.children=Ka(u.children,a,p,i,d)),g}})}function Ws(s,a,l="/"){return fo(s,a,l,!1)}function fo(s,a,l,i){let d=typeof a=="string"?Zs(a):a,u=_r(d.pathname||"/",l);if(u==null)return null;let f=hf(s);Mg(f);let p=null;for(let x=0;p==null&&x<f.length;++x){let g=Vg(u);p=Ug(f[x],g,i)}return p}function Pg(s,a){let{route:l,pathname:i,params:d}=s;return{id:l.id,pathname:i,params:d,data:a[l.id],loaderData:a[l.id],handle:l.handle}}function hf(s,a=[],l=[],i="",d=!1){let u=(f,p,x=d,g)=>{let v={relativePath:g===void 0?f.path||"":g,caseSensitive:f.caseSensitive===!0,childrenIndex:p,route:f};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(i)&&x)return;Ae(v.relativePath.startsWith(i),`Absolute route path "${v.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(i.length)}let b=Xr([i,v.relativePath]),j=l.concat(v);f.children&&f.children.length>0&&(Ae(f.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),hf(f.children,a,j,b,x)),!(f.path==null&&!f.index)&&a.push({path:b,score:Fg(b,f.index),routesMeta:j})};return s.forEach((f,p)=>{if(f.path===""||!f.path?.includes("?"))u(f,p);else for(let x of ff(f.path))u(f,p,!0,x)}),a}function ff(s){let a=s.split("/");if(a.length===0)return[];let[l,...i]=a,d=l.endsWith("?"),u=l.replace(/\?$/,"");if(i.length===0)return d?[u,""]:[u];let f=ff(i.join("/")),p=[];return p.push(...f.map(x=>x===""?u:[u,x].join("/"))),d&&p.push(...f),p.map(x=>s.startsWith("/")&&x===""?"/":x)}function Mg(s){s.sort((a,l)=>a.score!==l.score?l.score-a.score:Bg(a.routesMeta.map(i=>i.childrenIndex),l.routesMeta.map(i=>i.childrenIndex)))}var Ig=/^:[\w-]+$/,$g=3,Dg=2,Og=1,Ag=10,zg=-2,fh=s=>s==="*";function Fg(s,a){let l=s.split("/"),i=l.length;return l.some(fh)&&(i+=zg),a&&(i+=Dg),l.filter(d=>!fh(d)).reduce((d,u)=>d+(Ig.test(u)?$g:u===""?Og:Ag),i)}function Bg(s,a){return s.length===a.length&&s.slice(0,-1).every((i,d)=>i===a[d])?s[s.length-1]-a[a.length-1]:0}function Ug(s,a,l=!1){let{routesMeta:i}=s,d={},u="/",f=[];for(let p=0;p<i.length;++p){let x=i[p],g=p===i.length-1,v=u==="/"?a:a.slice(u.length)||"/",b=No({path:x.relativePath,caseSensitive:x.caseSensitive,end:g},v),j=x.route;if(!b&&g&&l&&!i[i.length-1].route.index&&(b=No({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},v)),!b)return null;Object.assign(d,b.params),f.push({params:d,pathname:Xr([u,b.pathname]),pathnameBase:Kg(Xr([u,b.pathnameBase])),route:j}),b.pathnameBase!=="/"&&(u=Xr([u,b.pathnameBase]))}return f}function No(s,a){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[l,i]=Hg(s.path,s.caseSensitive,s.end),d=a.match(l);if(!d)return null;let u=d[0],f=u.replace(/(.)\/+$/,"$1"),p=d.slice(1);return{params:i.reduce((g,{paramName:v,isOptional:b},j)=>{if(v==="*"){let M=p[j]||"";f=u.slice(0,u.length-M.length).replace(/(.)\/+$/,"$1")}const R=p[j];return b&&!R?g[v]=void 0:g[v]=(R||"").replace(/%2F/g,"/"),g},{}),pathname:u,pathnameBase:f,pattern:s}}function Hg(s,a=!1,l=!0){dt(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],d="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,p,x)=>(i.push({paramName:p,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),d+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?d+="\\/*$":s!==""&&s!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,a?void 0:"i"),i]}function Vg(s){try{return s.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return dt(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),s}}function _r(s,a){if(a==="/")return s;if(!s.toLowerCase().startsWith(a.toLowerCase()))return null;let l=a.endsWith("/")?a.length-1:a.length,i=s.charAt(l);return i&&i!=="/"?null:s.slice(l)||"/"}function Wg({basename:s,pathname:a}){return a==="/"?s:Xr([s,a])}function qg(s,a="/"){let{pathname:l,search:i="",hash:d=""}=typeof s=="string"?Zs(s):s;return{pathname:l?l.startsWith("/")?l:Jg(l,a):a,search:Qg(i),hash:Xg(d)}}function Jg(s,a){let l=a.replace(/\/+$/,"").split("/");return s.split("/").forEach(d=>{d===".."?l.length>1&&l.pop():d!=="."&&l.push(d)}),l.length>1?l.join("/"):"/"}function kc(s,a,l,i){return`Cannot include a '${s}' character in a manually specified \`to.${a}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${l}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function pf(s){return s.filter((a,l)=>l===0||a.route.path&&a.route.path.length>0)}function Po(s){let a=pf(s);return a.map((l,i)=>i===a.length-1?l.pathname:l.pathnameBase)}function Mo(s,a,l,i=!1){let d;typeof s=="string"?d=Zs(s):(d={...s},Ae(!d.pathname||!d.pathname.includes("?"),kc("?","pathname","search",d)),Ae(!d.pathname||!d.pathname.includes("#"),kc("#","pathname","hash",d)),Ae(!d.search||!d.search.includes("#"),kc("#","search","hash",d)));let u=s===""||d.pathname==="",f=u?"/":d.pathname,p;if(f==null)p=l;else{let b=a.length-1;if(!i&&f.startsWith("..")){let j=f.split("/");for(;j[0]==="..";)j.shift(),b-=1;d.pathname=j.join("/")}p=b>=0?a[b]:"/"}let x=qg(d,p),g=f&&f!=="/"&&f.endsWith("/"),v=(u||f===".")&&l.endsWith("/");return!x.pathname.endsWith("/")&&(g||v)&&(x.pathname+="/"),x}var Xr=s=>s.join("/").replace(/\/\/+/g,"/"),Kg=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),Qg=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Xg=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,ko=class{constructor(s,a,l,i=!1){this.status=s,this.statusText=a||"",this.internal=i,l instanceof Error?(this.data=l.toString(),this.error=l):this.data=l}};function Yn(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var xf=["POST","PUT","PATCH","DELETE"],Yg=new Set(xf),Gg=["GET",...xf],Zg=new Set(Gg),ey=new Set([301,302,303,307,308]),ty=new Set([307,308]),Sc={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ry={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Aa={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},sy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nd=s=>sy.test(s),ny=s=>({hasErrorBoundary:!!s.hasErrorBoundary}),gf="remix-router-transitions",yf=Symbol("ResetLoaderData");function ay(s){const a=s.window?s.window:typeof window<"u"?window:void 0,l=typeof a<"u"&&typeof a.document<"u"&&typeof a.document.createElement<"u";Ae(s.routes.length>0,"You must provide a non-empty routes array to createRouter");let i=s.hydrationRouteProperties||[],d=s.mapRouteProperties||ny,u={},f=Ka(s.routes,d,void 0,u),p,x=s.basename||"/",g=s.dataStrategy||dy,v={unstable_middleware:!1,...s.future},b=null,j=new Set,R=null,M=null,E=null,S=s.hydrationData!=null,k=Ws(f,s.history.location,x),C=!1,N=null,O;if(k==null&&!s.patchRoutesOnNavigation){let L=wr(404,{pathname:s.history.location.pathname}),{matches:F,route:X}=_h(f);O=!0,k=F,N={[X.id]:L}}else if(k&&!s.hydrationData&&lr(k,f,s.history.location.pathname).active&&(k=null),k)if(k.some(L=>L.route.lazy))O=!1;else if(!k.some(L=>L.route.loader))O=!0;else{let L=s.hydrationData?s.hydrationData.loaderData:null,F=s.hydrationData?s.hydrationData.errors:null;if(F){let X=k.findIndex(oe=>F[oe.route.id]!==void 0);O=k.slice(0,X+1).every(oe=>!zc(oe.route,L,F))}else O=k.every(X=>!zc(X.route,L,F))}else{O=!1,k=[];let L=lr(null,f,s.history.location.pathname);L.active&&L.matches&&(C=!0,k=L.matches)}let B,w={historyAction:s.history.action,location:s.history.location,matches:k,initialized:O,navigation:Sc,restoreScrollPosition:s.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:s.hydrationData&&s.hydrationData.loaderData||{},actionData:s.hydrationData&&s.hydrationData.actionData||null,errors:s.hydrationData&&s.hydrationData.errors||N,fetchers:new Map,blockers:new Map},I="POP",A=!1,J,ae=!1,Y=new Map,Z=null,V=!1,$=!1,z=new Set,q=new Map,se=0,G=-1,re=new Map,ee=new Set,T=new Map,K=new Map,fe=new Set,ge=new Map,Re,Ee=null;function $e(){if(b=s.history.listen(({action:L,location:F,delta:X})=>{if(Re){Re(),Re=void 0;return}dt(ge.size===0||X!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let oe=rs({currentLocation:w.location,nextLocation:F,historyAction:L});if(oe&&X!=null){let he=new Promise(Se=>{Re=Se});s.history.go(X*-1),hr(oe,{state:"blocked",location:F,proceed(){hr(oe,{state:"proceeding",proceed:void 0,reset:void 0,location:F}),he.then(()=>s.history.go(X))},reset(){let Se=new Map(w.blockers);Se.set(oe,Aa),be({blockers:Se})}});return}return xt(L,F)}),l){wy(a,Y);let L=()=>Ny(a,Y);a.addEventListener("pagehide",L),Z=()=>a.removeEventListener("pagehide",L)}return w.initialized||xt("POP",w.location,{initialHydration:!0}),B}function Ie(){b&&b(),Z&&Z(),j.clear(),J&&J.abort(),w.fetchers.forEach((L,F)=>vs(F)),w.blockers.forEach((L,F)=>ts(F))}function de(L){return j.add(L),()=>j.delete(L)}function be(L,F={}){L.matches&&(L.matches=L.matches.map(he=>{let Se=u[he.route.id],we=he.route;return we.element!==Se.element||we.errorElement!==Se.errorElement||we.hydrateFallbackElement!==Se.hydrateFallbackElement?{...he,route:Se}:he})),w={...w,...L};let X=[],oe=[];w.fetchers.forEach((he,Se)=>{he.state==="idle"&&(fe.has(Se)?X.push(Se):oe.push(Se))}),fe.forEach(he=>{!w.fetchers.has(he)&&!q.has(he)&&X.push(he)}),[...j].forEach(he=>he(w,{deletedFetchers:X,viewTransitionOpts:F.viewTransitionOpts,flushSync:F.flushSync===!0})),X.forEach(he=>vs(he)),oe.forEach(he=>w.fetchers.delete(he))}function De(L,F,{flushSync:X}={}){let oe=w.actionData!=null&&w.navigation.formMethod!=null&&Gt(w.navigation.formMethod)&&w.navigation.state==="loading"&&L.state?._isRedirect!==!0,he;F.actionData?Object.keys(F.actionData).length>0?he=F.actionData:he=null:oe?he=w.actionData:he=null;let Se=F.loaderData?kh(w.loaderData,F.loaderData,F.matches||[],F.errors):w.loaderData,we=w.blockers;we.size>0&&(we=new Map(we),we.forEach((_e,Ce)=>we.set(Ce,Aa)));let ye=V?!1:ns(L,F.matches||w.matches),ke=A===!0||w.navigation.formMethod!=null&&Gt(w.navigation.formMethod)&&L.state?._isRedirect!==!0;p&&(f=p,p=void 0),V||I==="POP"||(I==="PUSH"?s.history.push(L,L.state):I==="REPLACE"&&s.history.replace(L,L.state));let Le;if(I==="POP"){let _e=Y.get(w.location.pathname);_e&&_e.has(L.pathname)?Le={currentLocation:w.location,nextLocation:L}:Y.has(L.pathname)&&(Le={currentLocation:L,nextLocation:w.location})}else if(ae){let _e=Y.get(w.location.pathname);_e?_e.add(L.pathname):(_e=new Set([L.pathname]),Y.set(w.location.pathname,_e)),Le={currentLocation:w.location,nextLocation:L}}be({...F,actionData:he,loaderData:Se,historyAction:I,location:L,initialized:!0,navigation:Sc,revalidation:"idle",restoreScrollPosition:ye,preventScrollReset:ke,blockers:we},{viewTransitionOpts:Le,flushSync:X===!0}),I="POP",A=!1,ae=!1,V=!1,$=!1,Ee?.resolve(),Ee=null}async function Ke(L,F){if(typeof L=="number"){s.history.go(L);return}let X=Ac(w.location,w.matches,x,L,F?.fromRouteId,F?.relative),{path:oe,submission:he,error:Se}=ph(!1,X,F),we=w.location,ye=Ja(w.location,oe,F&&F.state);ye={...ye,...s.history.encodeLocation(ye)};let ke=F&&F.replace!=null?F.replace:void 0,Le="PUSH";ke===!0?Le="REPLACE":ke===!1||he!=null&&Gt(he.formMethod)&&he.formAction===w.location.pathname+w.location.search&&(Le="REPLACE");let _e=F&&"preventScrollReset"in F?F.preventScrollReset===!0:void 0,Ce=(F&&F.flushSync)===!0,ze=rs({currentLocation:we,nextLocation:ye,historyAction:Le});if(ze){hr(ze,{state:"blocked",location:ye,proceed(){hr(ze,{state:"proceeding",proceed:void 0,reset:void 0,location:ye}),Ke(L,F)},reset(){let We=new Map(w.blockers);We.set(ze,Aa),be({blockers:We})}});return}await xt(Le,ye,{submission:he,pendingError:Se,preventScrollReset:_e,replace:F&&F.replace,enableViewTransition:F&&F.viewTransition,flushSync:Ce})}function mt(){Ee||(Ee=ky()),ys(),be({revalidation:"loading"});let L=Ee.promise;return w.navigation.state==="submitting"?L:w.navigation.state==="idle"?(xt(w.historyAction,w.location,{startUninterruptedRevalidation:!0}),L):(xt(I||w.historyAction,w.navigation.location,{overrideNavigation:w.navigation,enableViewTransition:ae===!0}),L)}async function xt(L,F,X){J&&J.abort(),J=null,I=L,V=(X&&X.startUninterruptedRevalidation)===!0,Lr(w.location,w.matches),A=(X&&X.preventScrollReset)===!0,ae=(X&&X.enableViewTransition)===!0;let oe=p||f,he=X&&X.overrideNavigation,Se=X?.initialHydration&&w.matches&&w.matches.length>0&&!C?w.matches:Ws(oe,F,x),we=(X&&X.flushSync)===!0;if(Se&&w.initialized&&!$&&gy(w.location,F)&&!(X&&X.submission&&Gt(X.submission.formMethod))){De(F,{matches:Se},{flushSync:we});return}let ye=lr(Se,oe,F.pathname);if(ye.active&&ye.matches&&(Se=ye.matches),!Se){let{error:jt,notFoundMatches:tt,route:Qe}=ss(F.pathname);De(F,{matches:tt,loaderData:{},errors:{[Qe.id]:jt}},{flushSync:we});return}J=new AbortController;let ke=Kn(s.history,F,J.signal,X&&X.submission),Le=s.unstable_getContext?await s.unstable_getContext():new hh,_e;if(X&&X.pendingError)_e=[qs(Se).route.id,{type:"error",error:X.pendingError}];else if(X&&X.submission&&Gt(X.submission.formMethod)){let jt=await ie(ke,F,X.submission,Se,Le,ye.active,X&&X.initialHydration===!0,{replace:X.replace,flushSync:we});if(jt.shortCircuited)return;if(jt.pendingActionResult){let[tt,Qe]=jt.pendingActionResult;if(ur(Qe)&&Yn(Qe.error)&&Qe.error.status===404){J=null,De(F,{matches:jt.matches,loaderData:{},errors:{[tt]:Qe.error}});return}}Se=jt.matches||Se,_e=jt.pendingActionResult,he=_c(F,X.submission),we=!1,ye.active=!1,ke=Kn(s.history,ke.url,ke.signal)}let{shortCircuited:Ce,matches:ze,loaderData:We,errors:yt}=await He(ke,F,Se,Le,ye.active,he,X&&X.submission,X&&X.fetcherSubmission,X&&X.replace,X&&X.initialHydration===!0,we,_e);Ce||(J=null,De(F,{matches:ze||Se,...Sh(_e),loaderData:We,errors:yt}))}async function ie(L,F,X,oe,he,Se,we,ye={}){ys();let ke=by(F,X);if(be({navigation:ke},{flushSync:ye.flushSync===!0}),Se){let Ce=await bs(oe,F.pathname,L.signal);if(Ce.type==="aborted")return{shortCircuited:!0};if(Ce.type==="error"){let ze=qs(Ce.partialMatches).route.id;return{matches:Ce.partialMatches,pendingActionResult:[ze,{type:"error",error:Ce.error}]}}else if(Ce.matches)oe=Ce.matches;else{let{notFoundMatches:ze,error:We,route:yt}=ss(F.pathname);return{matches:ze,pendingActionResult:[yt.id,{type:"error",error:We}]}}}let Le,_e=po(oe,F);if(!_e.route.action&&!_e.route.lazy)Le={type:"error",error:wr(405,{method:L.method,pathname:F.pathname,routeId:_e.route.id})};else{let Ce=Qn(d,u,L,oe,_e,we?[]:i,he),ze=await Vt(L,Ce,he,null);if(Le=ze[_e.route.id],!Le){for(let We of oe)if(ze[We.route.id]){Le=ze[We.route.id];break}}if(L.signal.aborted)return{shortCircuited:!0}}if(vn(Le)){let Ce;return ye&&ye.replace!=null?Ce=ye.replace:Ce=jh(Le.response.headers.get("Location"),new URL(L.url),x)===w.location.pathname+w.location.search,await Ct(L,Le,!0,{submission:X,replace:Ce}),{shortCircuited:!0}}if(ur(Le)){let Ce=qs(oe,_e.route.id);return(ye&&ye.replace)!==!0&&(I="PUSH"),{matches:oe,pendingActionResult:[Ce.route.id,Le,_e.route.id]}}return{matches:oe,pendingActionResult:[_e.route.id,Le]}}async function He(L,F,X,oe,he,Se,we,ye,ke,Le,_e,Ce){let ze=Se||_c(F,we),We=we||ye||Ch(ze),yt=!V&&!Le;if(he){if(yt){let wt=sr(Ce);be({navigation:ze,...wt!==void 0?{actionData:wt}:{}},{flushSync:_e})}let Fe=await bs(X,F.pathname,L.signal);if(Fe.type==="aborted")return{shortCircuited:!0};if(Fe.type==="error"){let wt=qs(Fe.partialMatches).route.id;return{matches:Fe.partialMatches,loaderData:{},errors:{[wt]:Fe.error}}}else if(Fe.matches)X=Fe.matches;else{let{error:wt,notFoundMatches:an,route:Vr}=ss(F.pathname);return{matches:an,loaderData:{},errors:{[Vr.id]:wt}}}}let jt=p||f,{dsMatches:tt,revalidatingFetchers:Qe}=xh(L,oe,d,u,s.history,w,X,We,F,Le?[]:i,Le===!0,$,z,fe,T,ee,jt,x,s.patchRoutesOnNavigation!=null,Ce);if(G=++se,!s.dataStrategy&&!tt.some(Fe=>Fe.shouldLoad)&&!tt.some(Fe=>Fe.route.unstable_middleware)&&Qe.length===0){let Fe=Pt();return De(F,{matches:X,loaderData:{},errors:Ce&&ur(Ce[1])?{[Ce[0]]:Ce[1].error}:null,...Sh(Ce),...Fe?{fetchers:new Map(w.fetchers)}:{}},{flushSync:_e}),{shortCircuited:!0}}if(yt){let Fe={};if(!he){Fe.navigation=ze;let wt=sr(Ce);wt!==void 0&&(Fe.actionData=wt)}Qe.length>0&&(Fe.fetchers=Zr(Qe)),be(Fe,{flushSync:_e})}Qe.forEach(Fe=>{me(Fe.key),Fe.controller&&q.set(Fe.key,Fe.controller)});let Hr=()=>Qe.forEach(Fe=>me(Fe.key));J&&J.signal.addEventListener("abort",Hr);let{loaderResults:js,fetcherResults:Tr}=await rn(tt,Qe,L,oe);if(L.signal.aborted)return{shortCircuited:!0};J&&J.signal.removeEventListener("abort",Hr),Qe.forEach(Fe=>q.delete(Fe.key));let fr=oo(js);if(fr)return await Ct(L,fr.result,!0,{replace:ke}),{shortCircuited:!0};if(fr=oo(Tr),fr)return ee.add(fr.key),await Ct(L,fr.result,!0,{replace:ke}),{shortCircuited:!0};let{loaderData:sa,errors:Ye}=Nh(w,X,js,Ce,Qe,Tr);Le&&w.errors&&(Ye={...w.errors,...Ye});let as=Pt(),ws=gt(G),nn=as||ws||Qe.length>0;return{matches:X,loaderData:sa,errors:Ye,...nn?{fetchers:new Map(w.fetchers)}:{}}}function sr(L){if(L&&!ur(L[1]))return{[L[0]]:L[1].data};if(w.actionData)return Object.keys(w.actionData).length===0?null:w.actionData}function Zr(L){return L.forEach(F=>{let X=w.fetchers.get(F.key),oe=za(void 0,X?X.data:void 0);w.fetchers.set(F.key,oe)}),new Map(w.fetchers)}async function nr(L,F,X,oe){me(L);let he=(oe&&oe.flushSync)===!0,Se=p||f,we=Ac(w.location,w.matches,x,X,F,oe?.relative),ye=Ws(Se,we,x),ke=lr(ye,Se,we);if(ke.active&&ke.matches&&(ye=ke.matches),!ye){At(L,F,wr(404,{pathname:we}),{flushSync:he});return}let{path:Le,submission:_e,error:Ce}=ph(!0,we,oe);if(Ce){At(L,F,Ce,{flushSync:he});return}let ze=s.unstable_getContext?await s.unstable_getContext():new hh,We=(oe&&oe.preventScrollReset)===!0;if(_e&&Gt(_e.formMethod)){await ht(L,F,Le,ye,ze,ke.active,he,We,_e);return}T.set(L,{routeId:F,path:Le}),await Ht(L,F,Le,ye,ze,ke.active,he,We,_e)}async function ht(L,F,X,oe,he,Se,we,ye,ke){ys(),T.delete(L);let Le=w.fetchers.get(L);ar(L,jy(ke,Le),{flushSync:we});let _e=new AbortController,Ce=Kn(s.history,X,_e.signal,ke);if(Se){let qe=await bs(oe,new URL(Ce.url).pathname,Ce.signal,L);if(qe.type==="aborted")return;if(qe.type==="error"){At(L,F,qe.error,{flushSync:we});return}else if(qe.matches)oe=qe.matches;else{At(L,F,wr(404,{pathname:X}),{flushSync:we});return}}let ze=po(oe,X);if(!ze.route.action&&!ze.route.lazy){let qe=wr(405,{method:ke.formMethod,pathname:X,routeId:F});At(L,F,qe,{flushSync:we});return}q.set(L,_e);let We=se,yt=Qn(d,u,Ce,oe,ze,i,he),tt=(await Vt(Ce,yt,he,L))[ze.route.id];if(Ce.signal.aborted){q.get(L)===_e&&q.delete(L);return}if(fe.has(L)){if(vn(tt)||ur(tt)){ar(L,Us(void 0));return}}else{if(vn(tt))if(q.delete(L),G>We){ar(L,Us(void 0));return}else return ee.add(L),ar(L,za(ke)),Ct(Ce,tt,!1,{fetcherSubmission:ke,preventScrollReset:ye});if(ur(tt)){At(L,F,tt.error);return}}let Qe=w.navigation.location||w.location,Hr=Kn(s.history,Qe,_e.signal),js=p||f,Tr=w.navigation.state!=="idle"?Ws(js,w.navigation.location,x):w.matches;Ae(Tr,"Didn't find any matches after fetcher action");let fr=++se;re.set(L,fr);let sa=za(ke,tt.data);w.fetchers.set(L,sa);let{dsMatches:Ye,revalidatingFetchers:as}=xh(Hr,he,d,u,s.history,w,Tr,ke,Qe,i,!1,$,z,fe,T,ee,js,x,s.patchRoutesOnNavigation!=null,[ze.route.id,tt]);as.filter(qe=>qe.key!==L).forEach(qe=>{let kn=qe.key,Wt=w.fetchers.get(kn),Ao=za(void 0,Wt?Wt.data:void 0);w.fetchers.set(kn,Ao),me(kn),qe.controller&&q.set(kn,qe.controller)}),be({fetchers:new Map(w.fetchers)});let ws=()=>as.forEach(qe=>me(qe.key));_e.signal.addEventListener("abort",ws);let{loaderResults:nn,fetcherResults:Fe}=await rn(Ye,as,Hr,he);if(_e.signal.aborted)return;if(_e.signal.removeEventListener("abort",ws),re.delete(L),q.delete(L),as.forEach(qe=>q.delete(qe.key)),w.fetchers.has(L)){let qe=Us(tt.data);w.fetchers.set(L,qe)}let wt=oo(nn);if(wt)return Ct(Hr,wt.result,!1,{preventScrollReset:ye});if(wt=oo(Fe),wt)return ee.add(wt.key),Ct(Hr,wt.result,!1,{preventScrollReset:ye});let{loaderData:an,errors:Vr}=Nh(w,Tr,nn,void 0,as,Fe);gt(fr),w.navigation.state==="loading"&&fr>G?(Ae(I,"Expected pending action"),J&&J.abort(),De(w.navigation.location,{matches:Tr,loaderData:an,errors:Vr,fetchers:new Map(w.fetchers)})):(be({errors:Vr,loaderData:kh(w.loaderData,an,Tr,Vr),fetchers:new Map(w.fetchers)}),$=!1)}async function Ht(L,F,X,oe,he,Se,we,ye,ke){let Le=w.fetchers.get(L);ar(L,za(ke,Le?Le.data:void 0),{flushSync:we});let _e=new AbortController,Ce=Kn(s.history,X,_e.signal);if(Se){let Qe=await bs(oe,new URL(Ce.url).pathname,Ce.signal,L);if(Qe.type==="aborted")return;if(Qe.type==="error"){At(L,F,Qe.error,{flushSync:we});return}else if(Qe.matches)oe=Qe.matches;else{At(L,F,wr(404,{pathname:X}),{flushSync:we});return}}let ze=po(oe,X);q.set(L,_e);let We=se,yt=Qn(d,u,Ce,oe,ze,i,he),tt=(await Vt(Ce,yt,he,L))[ze.route.id];if(q.get(L)===_e&&q.delete(L),!Ce.signal.aborted){if(fe.has(L)){ar(L,Us(void 0));return}if(vn(tt))if(G>We){ar(L,Us(void 0));return}else{ee.add(L),await Ct(Ce,tt,!1,{preventScrollReset:ye});return}if(ur(tt)){At(L,F,tt.error);return}ar(L,Us(tt.data))}}async function Ct(L,F,X,{submission:oe,fetcherSubmission:he,preventScrollReset:Se,replace:we}={}){F.response.headers.has("X-Remix-Revalidate")&&($=!0);let ye=F.response.headers.get("Location");Ae(ye,"Expected a Location header on the redirect Response"),ye=jh(ye,new URL(L.url),x);let ke=Ja(w.location,ye,{_isRedirect:!0});if(l){let yt=!1;if(F.response.headers.has("X-Remix-Reload-Document"))yt=!0;else if(nd(ye)){const jt=mf(ye,!0);yt=jt.origin!==a.location.origin||_r(jt.pathname,x)==null}if(yt){we?a.location.replace(ye):a.location.assign(ye);return}}J=null;let Le=we===!0||F.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:_e,formAction:Ce,formEncType:ze}=w.navigation;!oe&&!he&&_e&&Ce&&ze&&(oe=Ch(w.navigation));let We=oe||he;if(ty.has(F.response.status)&&We&&Gt(We.formMethod))await xt(Le,ke,{submission:{...We,formAction:ye},preventScrollReset:Se||A,enableViewTransition:X?ae:void 0});else{let yt=_c(ke,oe);await xt(Le,ke,{overrideNavigation:yt,fetcherSubmission:he,preventScrollReset:Se||A,enableViewTransition:X?ae:void 0})}}async function Vt(L,F,X,oe){let he,Se={};try{he=await uy(g,L,F,oe,X,!1)}catch(we){return F.filter(ye=>ye.shouldLoad).forEach(ye=>{Se[ye.route.id]={type:"error",error:we}}),Se}if(L.signal.aborted)return Se;for(let[we,ye]of Object.entries(he))if(yy(ye)){let ke=ye.result;Se[we]={type:"redirect",response:py(ke,L,we,F,x)}}else Se[we]=await fy(ye);return Se}async function rn(L,F,X,oe){let he=Vt(X,L,oe,null),Se=Promise.all(F.map(async ke=>{if(ke.matches&&ke.match&&ke.request&&ke.controller){let _e=(await Vt(ke.request,ke.matches,oe,ke.key))[ke.match.route.id];return{[ke.key]:_e}}else return Promise.resolve({[ke.key]:{type:"error",error:wr(404,{pathname:ke.path})}})})),we=await he,ye=(await Se).reduce((ke,Le)=>Object.assign(ke,Le),{});return{loaderResults:we,fetcherResults:ye}}function ys(){$=!0,T.forEach((L,F)=>{q.has(F)&&z.add(F),me(F)})}function ar(L,F,X={}){w.fetchers.set(L,F),be({fetchers:new Map(w.fetchers)},{flushSync:(X&&X.flushSync)===!0})}function At(L,F,X,oe={}){let he=qs(w.matches,F);vs(L),be({errors:{[he.route.id]:X},fetchers:new Map(w.fetchers)},{flushSync:(oe&&oe.flushSync)===!0})}function es(L){return K.set(L,(K.get(L)||0)+1),fe.has(L)&&fe.delete(L),w.fetchers.get(L)||ry}function vs(L){let F=w.fetchers.get(L);q.has(L)&&!(F&&F.state==="loading"&&re.has(L))&&me(L),T.delete(L),re.delete(L),ee.delete(L),fe.delete(L),z.delete(L),w.fetchers.delete(L)}function W(L){let F=(K.get(L)||0)-1;F<=0?(K.delete(L),fe.add(L)):K.set(L,F),be({fetchers:new Map(w.fetchers)})}function me(L){let F=q.get(L);F&&(F.abort(),q.delete(L))}function Xe(L){for(let F of L){let X=es(F),oe=Us(X.data);w.fetchers.set(F,oe)}}function Pt(){let L=[],F=!1;for(let X of ee){let oe=w.fetchers.get(X);Ae(oe,`Expected fetcher: ${X}`),oe.state==="loading"&&(ee.delete(X),L.push(X),F=!0)}return Xe(L),F}function gt(L){let F=[];for(let[X,oe]of re)if(oe<L){let he=w.fetchers.get(X);Ae(he,`Expected fetcher: ${X}`),he.state==="loading"&&(me(X),re.delete(X),F.push(X))}return Xe(F),F.length>0}function Ur(L,F){let X=w.blockers.get(L)||Aa;return ge.get(L)!==F&&ge.set(L,F),X}function ts(L){w.blockers.delete(L),ge.delete(L)}function hr(L,F){let X=w.blockers.get(L)||Aa;Ae(X.state==="unblocked"&&F.state==="blocked"||X.state==="blocked"&&F.state==="blocked"||X.state==="blocked"&&F.state==="proceeding"||X.state==="blocked"&&F.state==="unblocked"||X.state==="proceeding"&&F.state==="unblocked",`Invalid blocker state transition: ${X.state} -> ${F.state}`);let oe=new Map(w.blockers);oe.set(L,F),be({blockers:oe})}function rs({currentLocation:L,nextLocation:F,historyAction:X}){if(ge.size===0)return;ge.size>1&&dt(!1,"A router only supports one blocker at a time");let oe=Array.from(ge.entries()),[he,Se]=oe[oe.length-1],we=w.blockers.get(he);if(!(we&&we.state==="proceeding")&&Se({currentLocation:L,nextLocation:F,historyAction:X}))return he}function ss(L){let F=wr(404,{pathname:L}),X=p||f,{matches:oe,route:he}=_h(X);return{notFoundMatches:oe,route:he,error:F}}function sn(L,F,X){if(R=L,E=F,M=X||null,!S&&w.navigation===Sc){S=!0;let oe=ns(w.location,w.matches);oe!=null&&be({restoreScrollPosition:oe})}return()=>{R=null,E=null,M=null}}function Rr(L,F){return M&&M(L,F.map(oe=>Pg(oe,w.loaderData)))||L.key}function Lr(L,F){if(R&&E){let X=Rr(L,F);R[X]=E()}}function ns(L,F){if(R){let X=Rr(L,F),oe=R[X];if(typeof oe=="number")return oe}return null}function lr(L,F,X){if(s.patchRoutesOnNavigation)if(L){if(Object.keys(L[0].params).length>0)return{active:!0,matches:fo(F,X,x,!0)}}else return{active:!0,matches:fo(F,X,x,!0)||[]};return{active:!1,matches:null}}async function bs(L,F,X,oe){if(!s.patchRoutesOnNavigation)return{type:"success",matches:L};let he=L;for(;;){let Se=p==null,we=p||f,ye=u;try{await s.patchRoutesOnNavigation({signal:X,path:F,matches:he,fetcherKey:oe,patch:(_e,Ce)=>{X.aborted||gh(_e,Ce,we,ye,d,!1)}})}catch(_e){return{type:"error",error:_e,partialMatches:he}}finally{Se&&!X.aborted&&(f=[...f])}if(X.aborted)return{type:"aborted"};let ke=Ws(we,F,x);if(ke)return{type:"success",matches:ke};let Le=fo(we,F,x,!0);if(!Le||he.length===Le.length&&he.every((_e,Ce)=>_e.route.id===Le[Ce].route.id))return{type:"success",matches:null};he=Le}}function Mt(L){u={},p=Ka(L,d,void 0,u)}function Rt(L,F,X=!1){let oe=p==null;gh(L,F,p||f,u,d,X),oe&&(f=[...f],be({}))}return B={get basename(){return x},get future(){return v},get state(){return w},get routes(){return f},get window(){return a},initialize:$e,subscribe:de,enableScrollRestoration:sn,navigate:Ke,fetch:nr,revalidate:mt,createHref:L=>s.history.createHref(L),encodeLocation:L=>s.history.encodeLocation(L),getFetcher:es,deleteFetcher:W,dispose:Ie,getBlocker:Ur,deleteBlocker:ts,patchRoutes:Rt,_internalFetchControllers:q,_internalSetRoutes:Mt,_internalSetStateDoNotUseOrYouWillBreakYourApp(L){be(L)}},B}function ly(s){return s!=null&&("formData"in s&&s.formData!=null||"body"in s&&s.body!==void 0)}function Ac(s,a,l,i,d,u){let f,p;if(d){f=[];for(let g of a)if(f.push(g),g.route.id===d){p=g;break}}else f=a,p=a[a.length-1];let x=Mo(i||".",Po(f),_r(s.pathname,l)||s.pathname,u==="path");if(i==null&&(x.search=s.search,x.hash=s.hash),(i==null||i===""||i===".")&&p){let g=ad(x.search);if(p.route.index&&!g)x.search=x.search?x.search.replace(/^\?/,"?index&"):"?index";else if(!p.route.index&&g){let v=new URLSearchParams(x.search),b=v.getAll("index");v.delete("index"),b.filter(R=>R).forEach(R=>v.append("index",R));let j=v.toString();x.search=j?`?${j}`:""}}return l!=="/"&&(x.pathname=Wg({basename:l,pathname:x.pathname})),Gs(x)}function ph(s,a,l){if(!l||!ly(l))return{path:a};if(l.formMethod&&!vy(l.formMethod))return{path:a,error:wr(405,{method:l.formMethod})};let i=()=>({path:a,error:wr(400,{type:"invalid-body"})}),u=(l.formMethod||"get").toUpperCase(),f=Sf(a);if(l.body!==void 0){if(l.formEncType==="text/plain"){if(!Gt(u))return i();let b=typeof l.body=="string"?l.body:l.body instanceof FormData||l.body instanceof URLSearchParams?Array.from(l.body.entries()).reduce((j,[R,M])=>`${j}${R}=${M}
`,""):String(l.body);return{path:a,submission:{formMethod:u,formAction:f,formEncType:l.formEncType,formData:void 0,json:void 0,text:b}}}else if(l.formEncType==="application/json"){if(!Gt(u))return i();try{let b=typeof l.body=="string"?JSON.parse(l.body):l.body;return{path:a,submission:{formMethod:u,formAction:f,formEncType:l.formEncType,formData:void 0,json:b,text:void 0}}}catch{return i()}}}Ae(typeof FormData=="function","FormData is not available in this environment");let p,x;if(l.formData)p=Bc(l.formData),x=l.formData;else if(l.body instanceof FormData)p=Bc(l.body),x=l.body;else if(l.body instanceof URLSearchParams)p=l.body,x=wh(p);else if(l.body==null)p=new URLSearchParams,x=new FormData;else try{p=new URLSearchParams(l.body),x=wh(p)}catch{return i()}let g={formMethod:u,formAction:f,formEncType:l&&l.formEncType||"application/x-www-form-urlencoded",formData:x,json:void 0,text:void 0};if(Gt(g.formMethod))return{path:a,submission:g};let v=Zs(a);return s&&v.search&&ad(v.search)&&p.append("index",""),v.search=`?${p}`,{path:Gs(v),submission:g}}function xh(s,a,l,i,d,u,f,p,x,g,v,b,j,R,M,E,S,k,C,N){let O=N?ur(N[1])?N[1].error:N[1].data:void 0,B=d.createURL(u.location),w=d.createURL(x),I;if(v&&u.errors){let V=Object.keys(u.errors)[0];I=f.findIndex($=>$.route.id===V)}else if(N&&ur(N[1])){let V=N[0];I=f.findIndex($=>$.route.id===V)-1}let A=N?N[1].statusCode:void 0,J=A&&A>=400,ae={currentUrl:B,currentParams:u.matches[0]?.params||{},nextUrl:w,nextParams:f[0].params,...p,actionResult:O,actionStatus:A},Y=f.map((V,$)=>{let{route:z}=V,q=null;if(I!=null&&$>I?q=!1:z.lazy?q=!0:z.loader==null?q=!1:v?q=zc(z,u.loaderData,u.errors):oy(u.loaderData,u.matches[$],V)&&(q=!0),q!==null)return Fc(l,i,s,V,g,a,q);let se=J?!1:b||B.pathname+B.search===w.pathname+w.search||B.search!==w.search||iy(u.matches[$],V),G={...ae,defaultShouldRevalidate:se},re=So(V,G);return Fc(l,i,s,V,g,a,re,G)}),Z=[];return M.forEach((V,$)=>{if(v||!f.some(K=>K.route.id===V.routeId)||R.has($))return;let z=u.fetchers.get($),q=z&&z.state!=="idle"&&z.data===void 0,se=Ws(S,V.path,k);if(!se){if(C&&q)return;Z.push({key:$,routeId:V.routeId,path:V.path,matches:null,match:null,request:null,controller:null});return}if(E.has($))return;let G=po(se,V.path),re=new AbortController,ee=Kn(d,V.path,re.signal),T=null;if(j.has($))j.delete($),T=Qn(l,i,ee,se,G,g,a);else if(q)b&&(T=Qn(l,i,ee,se,G,g,a));else{let K={...ae,defaultShouldRevalidate:J?!1:b};So(G,K)&&(T=Qn(l,i,ee,se,G,g,a,K))}T&&Z.push({key:$,routeId:V.routeId,path:V.path,matches:T,match:G,request:ee,controller:re})}),{dsMatches:Y,revalidatingFetchers:Z}}function zc(s,a,l){if(s.lazy)return!0;if(!s.loader)return!1;let i=a!=null&&s.id in a,d=l!=null&&l[s.id]!==void 0;return!i&&d?!1:typeof s.loader=="function"&&s.loader.hydrate===!0?!0:!i&&!d}function oy(s,a,l){let i=!a||l.route.id!==a.route.id,d=!s.hasOwnProperty(l.route.id);return i||d}function iy(s,a){let l=s.route.path;return s.pathname!==a.pathname||l!=null&&l.endsWith("*")&&s.params["*"]!==a.params["*"]}function So(s,a){if(s.route.shouldRevalidate){let l=s.route.shouldRevalidate(a);if(typeof l=="boolean")return l}return a.defaultShouldRevalidate}function gh(s,a,l,i,d,u){let f;if(s){let g=i[s];Ae(g,`No route found to patch children into: routeId = ${s}`),g.children||(g.children=[]),f=g.children}else f=l;let p=[],x=[];if(a.forEach(g=>{let v=f.find(b=>vf(g,b));v?x.push({existingRoute:v,newRoute:g}):p.push(g)}),p.length>0){let g=Ka(p,d,[s||"_","patch",String(f?.length||"0")],i);f.push(...g)}if(u&&x.length>0)for(let g=0;g<x.length;g++){let{existingRoute:v,newRoute:b}=x[g],j=v,[R]=Ka([b],d,[],{},!0);Object.assign(j,{element:R.element?R.element:j.element,errorElement:R.errorElement?R.errorElement:j.errorElement,hydrateFallbackElement:R.hydrateFallbackElement?R.hydrateFallbackElement:j.hydrateFallbackElement})}}function vf(s,a){return"id"in s&&"id"in a&&s.id===a.id?!0:s.index===a.index&&s.path===a.path&&s.caseSensitive===a.caseSensitive?(!s.children||s.children.length===0)&&(!a.children||a.children.length===0)?!0:s.children.every((l,i)=>a.children?.some(d=>vf(l,d))):!1}var yh=new WeakMap,bf=({key:s,route:a,manifest:l,mapRouteProperties:i})=>{let d=l[a.id];if(Ae(d,"No route found in manifest"),!d.lazy||typeof d.lazy!="object")return;let u=d.lazy[s];if(!u)return;let f=yh.get(d);f||(f={},yh.set(d,f));let p=f[s];if(p)return p;let x=(async()=>{let g=Cg(s),b=d[s]!==void 0&&s!=="hasErrorBoundary";if(g)dt(!g,"Route property "+s+" is not a supported lazy route property. This property will be ignored."),f[s]=Promise.resolve();else if(b)dt(!1,`Route "${d.id}" has a static property "${s}" defined. The lazy property will be ignored.`);else{let j=await u();j!=null&&(Object.assign(d,{[s]:j}),Object.assign(d,i(d)))}typeof d.lazy=="object"&&(d.lazy[s]=void 0,Object.values(d.lazy).every(j=>j===void 0)&&(d.lazy=void 0))})();return f[s]=x,x},vh=new WeakMap;function cy(s,a,l,i,d){let u=l[s.id];if(Ae(u,"No route found in manifest"),!s.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof s.lazy=="function"){let v=vh.get(u);if(v)return{lazyRoutePromise:v,lazyHandlerPromise:v};let b=(async()=>{Ae(typeof s.lazy=="function","No lazy route function found");let j=await s.lazy(),R={};for(let M in j){let E=j[M];if(E===void 0)continue;let S=Lg(M),C=u[M]!==void 0&&M!=="hasErrorBoundary";S?dt(!S,"Route property "+M+" is not a supported property to be returned from a lazy route function. This property will be ignored."):C?dt(!C,`Route "${u.id}" has a static property "${M}" defined but its lazy function is also returning a value for this property. The lazy route property "${M}" will be ignored.`):R[M]=E}Object.assign(u,R),Object.assign(u,{...i(u),lazy:void 0})})();return vh.set(u,b),b.catch(()=>{}),{lazyRoutePromise:b,lazyHandlerPromise:b}}let f=Object.keys(s.lazy),p=[],x;for(let v of f){if(d&&d.includes(v))continue;let b=bf({key:v,route:s,manifest:l,mapRouteProperties:i});b&&(p.push(b),v===a&&(x=b))}let g=p.length>0?Promise.all(p).then(()=>{}):void 0;return g?.catch(()=>{}),x?.catch(()=>{}),{lazyRoutePromise:g,lazyHandlerPromise:x}}async function bh(s){let a=s.matches.filter(d=>d.shouldLoad),l={};return(await Promise.all(a.map(d=>d.resolve()))).forEach((d,u)=>{l[a[u].route.id]=d}),l}async function dy(s){if(!s.matches.some(l=>l.route.unstable_middleware))return bh(s);let a=!1;return wf(s,()=>(a=!0,bh(s)),(l,i)=>jf(l,i,s.matches,a))}function jf(s,a,l,i){if(i)return{[a]:{type:"error",result:s}};{let d=Math.min(l.findIndex(f=>f.route.id===a)||0,l.findIndex(f=>f.unstable_shouldCallHandler())||0);return{[qs(l,l[d].route.id).route.id]:{type:"error",result:s}}}}async function wf(s,a,l){let{matches:i,request:d,params:u,context:f}=s,p=i.flatMap(g=>g.route.unstable_middleware?g.route.unstable_middleware.map(v=>[g.route.id,v]):[]),x={};return await Nf({request:d,params:u,context:f},p,a,l,x),x}async function Nf(s,a,l,i,d={},u=0){let{request:f}=s;if(f.signal.aborted)throw f.signal.reason?f.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${f.method} ${f.url}`);let p=a[u];if(!p){let j=await l();Object.assign(d,j);return}let[x,g]=p,v=!1,b=async()=>{if(v)throw new Error("You may only call `next()` once per middleware");v=!0;try{let j=await Nf(s,a,l,i,d,u+1);Object.assign(d,j)}catch(j){let R=await i(j,x);Object.assign(d,R)}};try{let j=await g({request:s.request,params:s.params,context:s.context},b);typeof j<"u"&&console.warn("client middlewares are not intended to return values, the value will be ignored",j),v||await b()}catch(j){let R=await i(j,x);Object.assign(d,R)}}function kf(s,a,l,i,d){let u=bf({key:"unstable_middleware",route:i.route,manifest:a,mapRouteProperties:s}),f=cy(i.route,Gt(l.method)?"action":"loader",a,s,d);return{middleware:u,route:f.lazyRoutePromise,handler:f.lazyHandlerPromise}}function Fc(s,a,l,i,d,u,f,p=null){let x=!1,g=kf(s,a,l,i,d);return{...i,_lazyPromises:g,shouldLoad:f,unstable_shouldRevalidateArgs:p,unstable_shouldCallHandler(v){return x=!0,p?typeof v=="boolean"?So(i,{...p,defaultShouldRevalidate:v}):So(i,p):f},resolve(v){return x||f||v&&!Gt(l.method)&&(i.route.lazy||i.route.loader)?my({request:l,match:i,lazyHandlerPromise:g?.handler,lazyRoutePromise:g?.route,handlerOverride:v,scopedContext:u}):Promise.resolve({type:"data",result:void 0})}}}function Qn(s,a,l,i,d,u,f,p=null){return i.map(x=>x.route.id!==d.route.id?{...x,shouldLoad:!1,unstable_shouldRevalidateArgs:p,unstable_shouldCallHandler:()=>!1,_lazyPromises:kf(s,a,l,x,u),resolve:()=>Promise.resolve({type:"data",result:void 0})}:Fc(s,a,l,x,u,f,!0,p))}async function uy(s,a,l,i,d,u){l.some(g=>g._lazyPromises?.middleware)&&await Promise.all(l.map(g=>g._lazyPromises?.middleware));let f={request:a,params:l[0].params,context:d,matches:l},x=await s({...f,fetcherKey:i,unstable_runClientMiddleware:g=>{let v=f,b=!1;return wf(v,()=>(b=!0,g({...v,fetcherKey:i,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}})),(j,R)=>jf(j,R,l,b))}});try{await Promise.all(l.flatMap(g=>[g._lazyPromises?.handler,g._lazyPromises?.route]))}catch{}return x}async function my({request:s,match:a,lazyHandlerPromise:l,lazyRoutePromise:i,handlerOverride:d,scopedContext:u}){let f,p,x=Gt(s.method),g=x?"action":"loader",v=b=>{let j,R=new Promise((S,k)=>j=k);p=()=>j(),s.signal.addEventListener("abort",p);let M=S=>typeof b!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${g}" [routeId: ${a.route.id}]`)):b({request:s,params:a.params,context:u},...S!==void 0?[S]:[]),E=(async()=>{try{return{type:"data",result:await(d?d(k=>M(k)):M())}}catch(S){return{type:"error",result:S}}})();return Promise.race([E,R])};try{let b=x?a.route.action:a.route.loader;if(l||i)if(b){let j,[R]=await Promise.all([v(b).catch(M=>{j=M}),l,i]);if(j!==void 0)throw j;f=R}else{await l;let j=x?a.route.action:a.route.loader;if(j)[f]=await Promise.all([v(j),i]);else if(g==="action"){let R=new URL(s.url),M=R.pathname+R.search;throw wr(405,{method:s.method,pathname:M,routeId:a.route.id})}else return{type:"data",result:void 0}}else if(b)f=await v(b);else{let j=new URL(s.url),R=j.pathname+j.search;throw wr(404,{pathname:R})}}catch(b){return{type:"error",result:b}}finally{p&&s.signal.removeEventListener("abort",p)}return f}async function hy(s){let a=s.headers.get("Content-Type");return a&&/\bapplication\/json\b/.test(a)?s.body==null?null:s.json():s.text()}async function fy(s){let{result:a,type:l}=s;if(_f(a)){let i;try{i=await hy(a)}catch(d){return{type:"error",error:d}}return l==="error"?{type:"error",error:new ko(a.status,a.statusText,i),statusCode:a.status,headers:a.headers}:{type:"data",data:i,statusCode:a.status,headers:a.headers}}return l==="error"?Eh(a)?a.data instanceof Error?{type:"error",error:a.data,statusCode:a.init?.status,headers:a.init?.headers?new Headers(a.init.headers):void 0}:{type:"error",error:new ko(a.init?.status||500,void 0,a.data),statusCode:Yn(a)?a.status:void 0,headers:a.init?.headers?new Headers(a.init.headers):void 0}:{type:"error",error:a,statusCode:Yn(a)?a.status:void 0}:Eh(a)?{type:"data",data:a.data,statusCode:a.init?.status,headers:a.init?.headers?new Headers(a.init.headers):void 0}:{type:"data",data:a}}function py(s,a,l,i,d){let u=s.headers.get("Location");if(Ae(u,"Redirects returned/thrown from loaders/actions must have a Location header"),!nd(u)){let f=i.slice(0,i.findIndex(p=>p.route.id===l)+1);u=Ac(new URL(a.url),f,d,u),s.headers.set("Location",u)}return s}function jh(s,a,l){if(nd(s)){let i=s,d=i.startsWith("//")?new URL(a.protocol+i):new URL(i),u=_r(d.pathname,l)!=null;if(d.origin===a.origin&&u)return d.pathname+d.search+d.hash}return s}function Kn(s,a,l,i){let d=s.createURL(Sf(a)).toString(),u={signal:l};if(i&&Gt(i.formMethod)){let{formMethod:f,formEncType:p}=i;u.method=f.toUpperCase(),p==="application/json"?(u.headers=new Headers({"Content-Type":p}),u.body=JSON.stringify(i.json)):p==="text/plain"?u.body=i.text:p==="application/x-www-form-urlencoded"&&i.formData?u.body=Bc(i.formData):u.body=i.formData}return new Request(d,u)}function Bc(s){let a=new URLSearchParams;for(let[l,i]of s.entries())a.append(l,typeof i=="string"?i:i.name);return a}function wh(s){let a=new FormData;for(let[l,i]of s.entries())a.append(l,i);return a}function xy(s,a,l,i=!1,d=!1){let u={},f=null,p,x=!1,g={},v=l&&ur(l[1])?l[1].error:void 0;return s.forEach(b=>{if(!(b.route.id in a))return;let j=b.route.id,R=a[j];if(Ae(!vn(R),"Cannot handle redirect results in processLoaderData"),ur(R)){let M=R.error;if(v!==void 0&&(M=v,v=void 0),f=f||{},d)f[j]=M;else{let E=qs(s,j);f[E.route.id]==null&&(f[E.route.id]=M)}i||(u[j]=yf),x||(x=!0,p=Yn(R.error)?R.error.status:500),R.headers&&(g[j]=R.headers)}else u[j]=R.data,R.statusCode&&R.statusCode!==200&&!x&&(p=R.statusCode),R.headers&&(g[j]=R.headers)}),v!==void 0&&l&&(f={[l[0]]:v},l[2]&&(u[l[2]]=void 0)),{loaderData:u,errors:f,statusCode:p||200,loaderHeaders:g}}function Nh(s,a,l,i,d,u){let{loaderData:f,errors:p}=xy(a,l,i);return d.filter(x=>!x.matches||x.matches.some(g=>g.shouldLoad)).forEach(x=>{let{key:g,match:v,controller:b}=x;if(b&&b.signal.aborted)return;let j=u[g];if(Ae(j,"Did not find corresponding fetcher result"),ur(j)){let R=qs(s.matches,v?.route.id);p&&p[R.route.id]||(p={...p,[R.route.id]:j.error}),s.fetchers.delete(g)}else if(vn(j))Ae(!1,"Unhandled fetcher revalidation redirect");else{let R=Us(j.data);s.fetchers.set(g,R)}}),{loaderData:f,errors:p}}function kh(s,a,l,i){let d=Object.entries(a).filter(([,u])=>u!==yf).reduce((u,[f,p])=>(u[f]=p,u),{});for(let u of l){let f=u.route.id;if(!a.hasOwnProperty(f)&&s.hasOwnProperty(f)&&u.route.loader&&(d[f]=s[f]),i&&i.hasOwnProperty(f))break}return d}function Sh(s){return s?ur(s[1])?{actionData:{}}:{actionData:{[s[0]]:s[1].data}}:{}}function qs(s,a){return(a?s.slice(0,s.findIndex(i=>i.route.id===a)+1):[...s]).reverse().find(i=>i.route.hasErrorBoundary===!0)||s[0]}function _h(s){let a=s.length===1?s[0]:s.find(l=>l.index||!l.path||l.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:a}],route:a}}function wr(s,{pathname:a,routeId:l,method:i,type:d,message:u}={}){let f="Unknown Server Error",p="Unknown @remix-run/router error";return s===400?(f="Bad Request",i&&a&&l?p=`You made a ${i} request to "${a}" but did not provide a \`loader\` for route "${l}", so there is no way to handle the request.`:d==="invalid-body"&&(p="Unable to encode submission body")):s===403?(f="Forbidden",p=`Route "${l}" does not match URL "${a}"`):s===404?(f="Not Found",p=`No route matches URL "${a}"`):s===405&&(f="Method Not Allowed",i&&a&&l?p=`You made a ${i.toUpperCase()} request to "${a}" but did not provide an \`action\` for route "${l}", so there is no way to handle the request.`:i&&(p=`Invalid request method "${i.toUpperCase()}"`)),new ko(s||500,f,new Error(p),!0)}function oo(s){let a=Object.entries(s);for(let l=a.length-1;l>=0;l--){let[i,d]=a[l];if(vn(d))return{key:i,result:d}}}function Sf(s){let a=typeof s=="string"?Zs(s):s;return Gs({...a,hash:""})}function gy(s,a){return s.pathname!==a.pathname||s.search!==a.search?!1:s.hash===""?a.hash!=="":s.hash===a.hash?!0:a.hash!==""}function yy(s){return _f(s.result)&&ey.has(s.result.status)}function ur(s){return s.type==="error"}function vn(s){return(s&&s.type)==="redirect"}function Eh(s){return typeof s=="object"&&s!=null&&"type"in s&&"data"in s&&"init"in s&&s.type==="DataWithResponseInit"}function _f(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.headers=="object"&&typeof s.body<"u"}function vy(s){return Zg.has(s.toUpperCase())}function Gt(s){return Yg.has(s.toUpperCase())}function ad(s){return new URLSearchParams(s).getAll("index").some(a=>a==="")}function po(s,a){let l=typeof a=="string"?Zs(a).search:a.search;if(s[s.length-1].route.index&&ad(l||""))return s[s.length-1];let i=pf(s);return i[i.length-1]}function Ch(s){let{formMethod:a,formAction:l,formEncType:i,text:d,formData:u,json:f}=s;if(!(!a||!l||!i)){if(d!=null)return{formMethod:a,formAction:l,formEncType:i,formData:void 0,json:void 0,text:d};if(u!=null)return{formMethod:a,formAction:l,formEncType:i,formData:u,json:void 0,text:void 0};if(f!==void 0)return{formMethod:a,formAction:l,formEncType:i,formData:void 0,json:f,text:void 0}}}function _c(s,a){return a?{state:"loading",location:s,formMethod:a.formMethod,formAction:a.formAction,formEncType:a.formEncType,formData:a.formData,json:a.json,text:a.text}:{state:"loading",location:s,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function by(s,a){return{state:"submitting",location:s,formMethod:a.formMethod,formAction:a.formAction,formEncType:a.formEncType,formData:a.formData,json:a.json,text:a.text}}function za(s,a){return s?{state:"loading",formMethod:s.formMethod,formAction:s.formAction,formEncType:s.formEncType,formData:s.formData,json:s.json,text:s.text,data:a}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:a}}function jy(s,a){return{state:"submitting",formMethod:s.formMethod,formAction:s.formAction,formEncType:s.formEncType,formData:s.formData,json:s.json,text:s.text,data:a?a.data:void 0}}function Us(s){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:s}}function wy(s,a){try{let l=s.sessionStorage.getItem(gf);if(l){let i=JSON.parse(l);for(let[d,u]of Object.entries(i||{}))u&&Array.isArray(u)&&a.set(d,new Set(u||[]))}}catch{}}function Ny(s,a){if(a.size>0){let l={};for(let[i,d]of a)l[i]=[...d];try{s.sessionStorage.setItem(gf,JSON.stringify(l))}catch(i){dt(!1,`Failed to save applied view transitions in sessionStorage (${i}).`)}}}function ky(){let s,a,l=new Promise((i,d)=>{s=async u=>{i(u);try{await l}catch{}},a=async u=>{d(u);try{await l}catch{}}});return{promise:l,resolve:s,reject:a}}var Nn=h.createContext(null);Nn.displayName="DataRouter";var Za=h.createContext(null);Za.displayName="DataRouterState";h.createContext(!1);var ld=h.createContext({isTransitioning:!1});ld.displayName="ViewTransition";var Ef=h.createContext(new Map);Ef.displayName="Fetchers";var Sy=h.createContext(null);Sy.displayName="Await";var Fr=h.createContext(null);Fr.displayName="Navigation";var Io=h.createContext(null);Io.displayName="Location";var Br=h.createContext({outlet:null,matches:[],isDataRoute:!1});Br.displayName="Route";var od=h.createContext(null);od.displayName="RouteError";function _y(s,{relative:a}={}){Ae(ea(),"useHref() may be used only in the context of a <Router> component.");let{basename:l,navigator:i}=h.useContext(Fr),{hash:d,pathname:u,search:f}=el(s,{relative:a}),p=u;return l!=="/"&&(p=u==="/"?l:Xr([l,u])),i.createHref({pathname:p,search:f,hash:d})}function ea(){return h.useContext(Io)!=null}function Ut(){return Ae(ea(),"useLocation() may be used only in the context of a <Router> component."),h.useContext(Io).location}var Cf="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Rf(s){h.useContext(Fr).static||h.useLayoutEffect(s)}function en(){let{isDataRoute:s}=h.useContext(Br);return s?zy():Ey()}function Ey(){Ae(ea(),"useNavigate() may be used only in the context of a <Router> component.");let s=h.useContext(Nn),{basename:a,navigator:l}=h.useContext(Fr),{matches:i}=h.useContext(Br),{pathname:d}=Ut(),u=JSON.stringify(Po(i)),f=h.useRef(!1);return Rf(()=>{f.current=!0}),h.useCallback((x,g={})=>{if(dt(f.current,Cf),!f.current)return;if(typeof x=="number"){l.go(x);return}let v=Mo(x,JSON.parse(u),d,g.relative==="path");s==null&&a!=="/"&&(v.pathname=v.pathname==="/"?a:Xr([a,v.pathname])),(g.replace?l.replace:l.push)(v,g.state,g)},[a,l,u,d,s])}h.createContext(null);function Cy(){let{matches:s}=h.useContext(Br),a=s[s.length-1];return a?a.params:{}}function el(s,{relative:a}={}){let{matches:l}=h.useContext(Br),{pathname:i}=Ut(),d=JSON.stringify(Po(l));return h.useMemo(()=>Mo(s,JSON.parse(d),i,a==="path"),[s,d,i,a])}function Ry(s,a,l,i){Ae(ea(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:d}=h.useContext(Fr),{matches:u}=h.useContext(Br),f=u[u.length-1],p=f?f.params:{},x=f?f.pathname:"/",g=f?f.pathnameBase:"/",v=f&&f.route;{let k=v&&v.path||"";Tf(x,!v||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let b=Ut(),j;j=b;let R=j.pathname||"/",M=R;if(g!=="/"){let k=g.replace(/^\//,"").split("/");M="/"+R.replace(/^\//,"").split("/").slice(k.length).join("/")}let E=Ws(s,{pathname:M});return dt(v||E!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),dt(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),Iy(E&&E.map(k=>Object.assign({},k,{params:Object.assign({},p,k.params),pathname:Xr([g,d.encodeLocation?d.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?g:Xr([g,d.encodeLocation?d.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),u,l,i)}function Ly(){let s=Lf(),a=Yn(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),l=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",d={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},f=null;return console.error("Error handled by React Router default ErrorBoundary:",s),f=h.createElement(h.Fragment,null,h.createElement("p",null,"💿 Hey developer 👋"),h.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",h.createElement("code",{style:u},"ErrorBoundary")," or"," ",h.createElement("code",{style:u},"errorElement")," prop on your route.")),h.createElement(h.Fragment,null,h.createElement("h2",null,"Unexpected Application Error!"),h.createElement("h3",{style:{fontStyle:"italic"}},a),l?h.createElement("pre",{style:d},l):null,f)}var Ty=h.createElement(Ly,null),Py=class extends h.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,a){return a.location!==s.location||a.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:a.error,location:a.location,revalidation:s.revalidation||a.revalidation}}componentDidCatch(s,a){console.error("React Router caught the following error during render",s,a)}render(){return this.state.error!==void 0?h.createElement(Br.Provider,{value:this.props.routeContext},h.createElement(od.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function My({routeContext:s,match:a,children:l}){let i=h.useContext(Nn);return i&&i.static&&i.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=a.route.id),h.createElement(Br.Provider,{value:s},l)}function Iy(s,a=[],l=null,i=null){if(s==null){if(!l)return null;if(l.errors)s=l.matches;else if(a.length===0&&!l.initialized&&l.matches.length>0)s=l.matches;else return null}let d=s,u=l?.errors;if(u!=null){let x=d.findIndex(g=>g.route.id&&u?.[g.route.id]!==void 0);Ae(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),d=d.slice(0,Math.min(d.length,x+1))}let f=!1,p=-1;if(l)for(let x=0;x<d.length;x++){let g=d[x];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(p=x),g.route.id){let{loaderData:v,errors:b}=l,j=g.route.loader&&!v.hasOwnProperty(g.route.id)&&(!b||b[g.route.id]===void 0);if(g.route.lazy||j){f=!0,p>=0?d=d.slice(0,p+1):d=[d[0]];break}}}return d.reduceRight((x,g,v)=>{let b,j=!1,R=null,M=null;l&&(b=u&&g.route.id?u[g.route.id]:void 0,R=g.route.errorElement||Ty,f&&(p<0&&v===0?(Tf("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),j=!0,M=null):p===v&&(j=!0,M=g.route.hydrateFallbackElement||null)));let E=a.concat(d.slice(0,v+1)),S=()=>{let k;return b?k=R:j?k=M:g.route.Component?k=h.createElement(g.route.Component,null):g.route.element?k=g.route.element:k=x,h.createElement(My,{match:g,routeContext:{outlet:x,matches:E,isDataRoute:l!=null},children:k})};return l&&(g.route.ErrorBoundary||g.route.errorElement||v===0)?h.createElement(Py,{location:l.location,revalidation:l.revalidation,component:R,error:b,children:S(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):S()},null)}function id(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $y(s){let a=h.useContext(Nn);return Ae(a,id(s)),a}function Dy(s){let a=h.useContext(Za);return Ae(a,id(s)),a}function Oy(s){let a=h.useContext(Br);return Ae(a,id(s)),a}function cd(s){let a=Oy(s),l=a.matches[a.matches.length-1];return Ae(l.route.id,`${s} can only be used on routes that contain a unique "id"`),l.route.id}function Ay(){return cd("useRouteId")}function Lf(){let s=h.useContext(od),a=Dy("useRouteError"),l=cd("useRouteError");return s!==void 0?s:a.errors?.[l]}function zy(){let{router:s}=$y("useNavigate"),a=cd("useNavigate"),l=h.useRef(!1);return Rf(()=>{l.current=!0}),h.useCallback(async(d,u={})=>{dt(l.current,Cf),l.current&&(typeof d=="number"?s.navigate(d):await s.navigate(d,{fromRouteId:a,...u}))},[s,a])}var Rh={};function Tf(s,a,l){!a&&!Rh[s]&&(Rh[s]=!0,dt(!1,l))}var Lh={};function Th(s,a){!s&&!Lh[a]&&(Lh[a]=!0,console.warn(a))}function Fy(s){let a={hasErrorBoundary:s.hasErrorBoundary||s.ErrorBoundary!=null||s.errorElement!=null};return s.Component&&(s.element&&dt(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(a,{element:h.createElement(s.Component),Component:void 0})),s.HydrateFallback&&(s.hydrateFallbackElement&&dt(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(a,{hydrateFallbackElement:h.createElement(s.HydrateFallback),HydrateFallback:void 0})),s.ErrorBoundary&&(s.errorElement&&dt(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(a,{errorElement:h.createElement(s.ErrorBoundary),ErrorBoundary:void 0})),a}var By=["HydrateFallback","hydrateFallbackElement"],Uy=class{constructor(){this.status="pending",this.promise=new Promise((s,a)=>{this.resolve=l=>{this.status==="pending"&&(this.status="resolved",s(l))},this.reject=l=>{this.status==="pending"&&(this.status="rejected",a(l))}})}};function Hy({router:s,flushSync:a}){let[l,i]=h.useState(s.state),[d,u]=h.useState(),[f,p]=h.useState({isTransitioning:!1}),[x,g]=h.useState(),[v,b]=h.useState(),[j,R]=h.useState(),M=h.useRef(new Map),E=h.useCallback((N,{deletedFetchers:O,flushSync:B,viewTransitionOpts:w})=>{N.fetchers.forEach((A,J)=>{A.data!==void 0&&M.current.set(J,A.data)}),O.forEach(A=>M.current.delete(A)),Th(B===!1||a!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let I=s.window!=null&&s.window.document!=null&&typeof s.window.document.startViewTransition=="function";if(Th(w==null||I,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!w||!I){a&&B?a(()=>i(N)):h.startTransition(()=>i(N));return}if(a&&B){a(()=>{v&&(x&&x.resolve(),v.skipTransition()),p({isTransitioning:!0,flushSync:!0,currentLocation:w.currentLocation,nextLocation:w.nextLocation})});let A=s.window.document.startViewTransition(()=>{a(()=>i(N))});A.finished.finally(()=>{a(()=>{g(void 0),b(void 0),u(void 0),p({isTransitioning:!1})})}),a(()=>b(A));return}v?(x&&x.resolve(),v.skipTransition(),R({state:N,currentLocation:w.currentLocation,nextLocation:w.nextLocation})):(u(N),p({isTransitioning:!0,flushSync:!1,currentLocation:w.currentLocation,nextLocation:w.nextLocation}))},[s.window,a,v,x]);h.useLayoutEffect(()=>s.subscribe(E),[s,E]),h.useEffect(()=>{f.isTransitioning&&!f.flushSync&&g(new Uy)},[f]),h.useEffect(()=>{if(x&&d&&s.window){let N=d,O=x.promise,B=s.window.document.startViewTransition(async()=>{h.startTransition(()=>i(N)),await O});B.finished.finally(()=>{g(void 0),b(void 0),u(void 0),p({isTransitioning:!1})}),b(B)}},[d,x,s.window]),h.useEffect(()=>{x&&d&&l.location.key===d.location.key&&x.resolve()},[x,v,l.location,d]),h.useEffect(()=>{!f.isTransitioning&&j&&(u(j.state),p({isTransitioning:!0,flushSync:!1,currentLocation:j.currentLocation,nextLocation:j.nextLocation}),R(void 0))},[f.isTransitioning,j]);let S=h.useMemo(()=>({createHref:s.createHref,encodeLocation:s.encodeLocation,go:N=>s.navigate(N),push:(N,O,B)=>s.navigate(N,{state:O,preventScrollReset:B?.preventScrollReset}),replace:(N,O,B)=>s.navigate(N,{replace:!0,state:O,preventScrollReset:B?.preventScrollReset})}),[s]),k=s.basename||"/",C=h.useMemo(()=>({router:s,navigator:S,static:!1,basename:k}),[s,S,k]);return h.createElement(h.Fragment,null,h.createElement(Nn.Provider,{value:C},h.createElement(Za.Provider,{value:l},h.createElement(Ef.Provider,{value:M.current},h.createElement(ld.Provider,{value:f},h.createElement(qy,{basename:k,location:l.location,navigationType:l.historyAction,navigator:S},h.createElement(Vy,{routes:s.routes,future:s.future,state:l})))))),null)}var Vy=h.memo(Wy);function Wy({routes:s,future:a,state:l}){return Ry(s,void 0,l,a)}function Uc({to:s,replace:a,state:l,relative:i}){Ae(ea(),"<Navigate> may be used only in the context of a <Router> component.");let{static:d}=h.useContext(Fr);dt(!d,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=h.useContext(Br),{pathname:f}=Ut(),p=en(),x=Mo(s,Po(u),f,i==="path"),g=JSON.stringify(x);return h.useEffect(()=>{p(JSON.parse(g),{replace:a,state:l,relative:i})},[p,g,i,a,l]),null}function qy({basename:s="/",children:a=null,location:l,navigationType:i="POP",navigator:d,static:u=!1}){Ae(!ea(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=s.replace(/^\/*/,"/"),p=h.useMemo(()=>({basename:f,navigator:d,static:u,future:{}}),[f,d,u]);typeof l=="string"&&(l=Zs(l));let{pathname:x="/",search:g="",hash:v="",state:b=null,key:j="default"}=l,R=h.useMemo(()=>{let M=_r(x,f);return M==null?null:{location:{pathname:M,search:g,hash:v,state:b,key:j},navigationType:i}},[f,x,g,v,b,j,i]);return dt(R!=null,`<Router basename="${f}"> is not able to match the URL "${x}${g}${v}" because it does not start with the basename, so the <Router> won't render anything.`),R==null?null:h.createElement(Fr.Provider,{value:p},h.createElement(Io.Provider,{children:a,value:R}))}var xo="get",go="application/x-www-form-urlencoded";function $o(s){return s!=null&&typeof s.tagName=="string"}function Jy(s){return $o(s)&&s.tagName.toLowerCase()==="button"}function Ky(s){return $o(s)&&s.tagName.toLowerCase()==="form"}function Qy(s){return $o(s)&&s.tagName.toLowerCase()==="input"}function Xy(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function Yy(s,a){return s.button===0&&(!a||a==="_self")&&!Xy(s)}function Hc(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((a,l)=>{let i=s[l];return a.concat(Array.isArray(i)?i.map(d=>[l,d]):[[l,i]])},[]))}function Gy(s,a){let l=Hc(s);return a&&a.forEach((i,d)=>{l.has(d)||a.getAll(d).forEach(u=>{l.append(d,u)})}),l}var io=null;function Zy(){if(io===null)try{new FormData(document.createElement("form"),0),io=!1}catch{io=!0}return io}var ev=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ec(s){return s!=null&&!ev.has(s)?(dt(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${go}"`),null):s}function tv(s,a){let l,i,d,u,f;if(Ky(s)){let p=s.getAttribute("action");i=p?_r(p,a):null,l=s.getAttribute("method")||xo,d=Ec(s.getAttribute("enctype"))||go,u=new FormData(s)}else if(Jy(s)||Qy(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=s.getAttribute("formaction")||p.getAttribute("action");if(i=x?_r(x,a):null,l=s.getAttribute("formmethod")||p.getAttribute("method")||xo,d=Ec(s.getAttribute("formenctype"))||Ec(p.getAttribute("enctype"))||go,u=new FormData(p,s),!Zy()){let{name:g,type:v,value:b}=s;if(v==="image"){let j=g?`${g}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else g&&u.append(g,b)}}else{if($o(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');l=xo,i=null,d=go,f=s}return u&&d==="text/plain"&&(f=u,u=void 0),{action:i,method:l.toLowerCase(),encType:d,formData:u,body:f}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function dd(s,a){if(s===!1||s===null||typeof s>"u")throw new Error(a)}function rv(s,a,l){let i=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return i.pathname==="/"?i.pathname=`_root.${l}`:a&&_r(i.pathname,a)==="/"?i.pathname=`${a.replace(/\/$/,"")}/_root.${l}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${l}`,i}async function sv(s,a){if(s.id in a)return a[s.id];try{let l=await import(s.module);return a[s.id]=l,l}catch(l){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(l),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function nv(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function av(s,a,l){let i=await Promise.all(s.map(async d=>{let u=a.routes[d.route.id];if(u){let f=await sv(u,l);return f.links?f.links():[]}return[]}));return cv(i.flat(1).filter(nv).filter(d=>d.rel==="stylesheet"||d.rel==="preload").map(d=>d.rel==="stylesheet"?{...d,rel:"prefetch",as:"style"}:{...d,rel:"prefetch"}))}function Ph(s,a,l,i,d,u){let f=(x,g)=>l[g]?x.route.id!==l[g].route.id:!0,p=(x,g)=>l[g].pathname!==x.pathname||l[g].route.path?.endsWith("*")&&l[g].params["*"]!==x.params["*"];return u==="assets"?a.filter((x,g)=>f(x,g)||p(x,g)):u==="data"?a.filter((x,g)=>{let v=i.routes[x.route.id];if(!v||!v.hasLoader)return!1;if(f(x,g)||p(x,g))return!0;if(x.route.shouldRevalidate){let b=x.route.shouldRevalidate({currentUrl:new URL(d.pathname+d.search+d.hash,window.origin),currentParams:l[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function lv(s,a,{includeHydrateFallback:l}={}){return ov(s.map(i=>{let d=a.routes[i.route.id];if(!d)return[];let u=[d.module];return d.clientActionModule&&(u=u.concat(d.clientActionModule)),d.clientLoaderModule&&(u=u.concat(d.clientLoaderModule)),l&&d.hydrateFallbackModule&&(u=u.concat(d.hydrateFallbackModule)),d.imports&&(u=u.concat(d.imports)),u}).flat(1))}function ov(s){return[...new Set(s)]}function iv(s){let a={},l=Object.keys(s).sort();for(let i of l)a[i]=s[i];return a}function cv(s,a){let l=new Set;return new Set(a),s.reduce((i,d)=>{let u=JSON.stringify(iv(d));return l.has(u)||(l.add(u),i.push({key:u,link:d})),i},[])}function Pf(){let s=h.useContext(Nn);return dd(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function dv(){let s=h.useContext(Za);return dd(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var ud=h.createContext(void 0);ud.displayName="FrameworkContext";function Mf(){let s=h.useContext(ud);return dd(s,"You must render this element inside a <HydratedRouter> element"),s}function uv(s,a){let l=h.useContext(ud),[i,d]=h.useState(!1),[u,f]=h.useState(!1),{onFocus:p,onBlur:x,onMouseEnter:g,onMouseLeave:v,onTouchStart:b}=a,j=h.useRef(null);h.useEffect(()=>{if(s==="render"&&f(!0),s==="viewport"){let E=k=>{k.forEach(C=>{f(C.isIntersecting)})},S=new IntersectionObserver(E,{threshold:.5});return j.current&&S.observe(j.current),()=>{S.disconnect()}}},[s]),h.useEffect(()=>{if(i){let E=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(E)}}},[i]);let R=()=>{d(!0)},M=()=>{d(!1),f(!1)};return l?s!=="intent"?[u,j,{}]:[u,j,{onFocus:Fa(p,R),onBlur:Fa(x,M),onMouseEnter:Fa(g,R),onMouseLeave:Fa(v,M),onTouchStart:Fa(b,R)}]:[!1,j,{}]}function Fa(s,a){return l=>{s&&s(l),l.defaultPrevented||a(l)}}function mv({page:s,...a}){let{router:l}=Pf(),i=h.useMemo(()=>Ws(l.routes,s,l.basename),[l.routes,s,l.basename]);return i?h.createElement(fv,{page:s,matches:i,...a}):null}function hv(s){let{manifest:a,routeModules:l}=Mf(),[i,d]=h.useState([]);return h.useEffect(()=>{let u=!1;return av(s,a,l).then(f=>{u||d(f)}),()=>{u=!0}},[s,a,l]),i}function fv({page:s,matches:a,...l}){let i=Ut(),{manifest:d,routeModules:u}=Mf(),{basename:f}=Pf(),{loaderData:p,matches:x}=dv(),g=h.useMemo(()=>Ph(s,a,x,d,i,"data"),[s,a,x,d,i]),v=h.useMemo(()=>Ph(s,a,x,d,i,"assets"),[s,a,x,d,i]),b=h.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let M=new Set,E=!1;if(a.forEach(k=>{let C=d.routes[k.route.id];!C||!C.hasLoader||(!g.some(N=>N.route.id===k.route.id)&&k.route.id in p&&u[k.route.id]?.shouldRevalidate||C.hasClientLoader?E=!0:M.add(k.route.id))}),M.size===0)return[];let S=rv(s,f,"data");return E&&M.size>0&&S.searchParams.set("_routes",a.filter(k=>M.has(k.route.id)).map(k=>k.route.id).join(",")),[S.pathname+S.search]},[f,p,i,d,g,a,s,u]),j=h.useMemo(()=>lv(v,d),[v,d]),R=hv(v);return h.createElement(h.Fragment,null,b.map(M=>h.createElement("link",{key:M,rel:"prefetch",as:"fetch",href:M,...l})),j.map(M=>h.createElement("link",{key:M,rel:"modulepreload",href:M,...l})),R.map(({key:M,link:E})=>h.createElement("link",{key:M,nonce:l.nonce,...E})))}function pv(...s){return a=>{s.forEach(l=>{typeof l=="function"?l(a):l!=null&&(l.current=a)})}}var If=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{If&&(window.__reactRouterVersion="7.8.1")}catch{}function xv(s,a){return ay({basename:a?.basename,unstable_getContext:a?.unstable_getContext,future:a?.future,history:kg({window:a?.window}),hydrationData:gv(),routes:s,mapRouteProperties:Fy,hydrationRouteProperties:By,dataStrategy:a?.dataStrategy,patchRoutesOnNavigation:a?.patchRoutesOnNavigation,window:a?.window}).initialize()}function gv(){let s=window?.__staticRouterHydrationData;return s&&s.errors&&(s={...s,errors:yv(s.errors)}),s}function yv(s){if(!s)return null;let a=Object.entries(s),l={};for(let[i,d]of a)if(d&&d.__type==="RouteErrorResponse")l[i]=new ko(d.status,d.statusText,d.data,d.internal===!0);else if(d&&d.__type==="Error"){if(d.__subType){let u=window[d.__subType];if(typeof u=="function")try{let f=new u(d.message);f.stack="",l[i]=f}catch{}}if(l[i]==null){let u=new Error(d.message);u.stack="",l[i]=u}}else l[i]=d;return l}var $f=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Er=h.forwardRef(function({onClick:a,discover:l="render",prefetch:i="none",relative:d,reloadDocument:u,replace:f,state:p,target:x,to:g,preventScrollReset:v,viewTransition:b,...j},R){let{basename:M}=h.useContext(Fr),E=typeof g=="string"&&$f.test(g),S,k=!1;if(typeof g=="string"&&E&&(S=g,If))try{let J=new URL(window.location.href),ae=g.startsWith("//")?new URL(J.protocol+g):new URL(g),Y=_r(ae.pathname,M);ae.origin===J.origin&&Y!=null?g=Y+ae.search+ae.hash:k=!0}catch{dt(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=_y(g,{relative:d}),[N,O,B]=uv(i,j),w=wv(g,{replace:f,state:p,target:x,preventScrollReset:v,relative:d,viewTransition:b});function I(J){a&&a(J),J.defaultPrevented||w(J)}let A=h.createElement("a",{...j,...B,href:S||C,onClick:k||u?a:I,ref:pv(R,O),target:x,"data-discover":!E&&l==="render"?"true":void 0});return N&&!E?h.createElement(h.Fragment,null,A,h.createElement(mv,{page:C})):A});Er.displayName="Link";var vv=h.forwardRef(function({"aria-current":a="page",caseSensitive:l=!1,className:i="",end:d=!1,style:u,to:f,viewTransition:p,children:x,...g},v){let b=el(f,{relative:g.relative}),j=Ut(),R=h.useContext(Za),{navigator:M,basename:E}=h.useContext(Fr),S=R!=null&&Cv(b)&&p===!0,k=M.encodeLocation?M.encodeLocation(b).pathname:b.pathname,C=j.pathname,N=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;l||(C=C.toLowerCase(),N=N?N.toLowerCase():null,k=k.toLowerCase()),N&&E&&(N=_r(N,E)||N);const O=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let B=C===k||!d&&C.startsWith(k)&&C.charAt(O)==="/",w=N!=null&&(N===k||!d&&N.startsWith(k)&&N.charAt(k.length)==="/"),I={isActive:B,isPending:w,isTransitioning:S},A=B?a:void 0,J;typeof i=="function"?J=i(I):J=[i,B?"active":null,w?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let ae=typeof u=="function"?u(I):u;return h.createElement(Er,{...g,"aria-current":A,className:J,ref:v,style:ae,to:f,viewTransition:p},typeof x=="function"?x(I):x)});vv.displayName="NavLink";var bv=h.forwardRef(({discover:s="render",fetcherKey:a,navigate:l,reloadDocument:i,replace:d,state:u,method:f=xo,action:p,onSubmit:x,relative:g,preventScrollReset:v,viewTransition:b,...j},R)=>{let M=_v(),E=Ev(p,{relative:g}),S=f.toLowerCase()==="get"?"get":"post",k=typeof p=="string"&&$f.test(p),C=N=>{if(x&&x(N),N.defaultPrevented)return;N.preventDefault();let O=N.nativeEvent.submitter,B=O?.getAttribute("formmethod")||f;M(O||N.currentTarget,{fetcherKey:a,method:B,navigate:l,replace:d,state:u,relative:g,preventScrollReset:v,viewTransition:b})};return h.createElement("form",{ref:R,method:S,action:E,onSubmit:i?x:C,...j,"data-discover":!k&&s==="render"?"true":void 0})});bv.displayName="Form";function jv(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Df(s){let a=h.useContext(Nn);return Ae(a,jv(s)),a}function wv(s,{target:a,replace:l,state:i,preventScrollReset:d,relative:u,viewTransition:f}={}){let p=en(),x=Ut(),g=el(s,{relative:u});return h.useCallback(v=>{if(Yy(v,a)){v.preventDefault();let b=l!==void 0?l:Gs(x)===Gs(g);p(s,{replace:b,state:i,preventScrollReset:d,relative:u,viewTransition:f})}},[x,p,g,l,i,a,s,d,u,f])}function Nv(s){dt(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let a=h.useRef(Hc(s)),l=h.useRef(!1),i=Ut(),d=h.useMemo(()=>Gy(i.search,l.current?null:a.current),[i.search]),u=en(),f=h.useCallback((p,x)=>{const g=Hc(typeof p=="function"?p(new URLSearchParams(d)):p);l.current=!0,u("?"+g,x)},[u,d]);return[d,f]}var kv=0,Sv=()=>`__${String(++kv)}__`;function _v(){let{router:s}=Df("useSubmit"),{basename:a}=h.useContext(Fr),l=Ay();return h.useCallback(async(i,d={})=>{let{action:u,method:f,encType:p,formData:x,body:g}=tv(i,a);if(d.navigate===!1){let v=d.fetcherKey||Sv();await s.fetch(v,l,d.action||u,{preventScrollReset:d.preventScrollReset,formData:x,body:g,formMethod:d.method||f,formEncType:d.encType||p,flushSync:d.flushSync})}else await s.navigate(d.action||u,{preventScrollReset:d.preventScrollReset,formData:x,body:g,formMethod:d.method||f,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:l,flushSync:d.flushSync,viewTransition:d.viewTransition})},[s,a,l])}function Ev(s,{relative:a}={}){let{basename:l}=h.useContext(Fr),i=h.useContext(Br);Ae(i,"useFormAction must be used inside a RouteContext");let[d]=i.matches.slice(-1),u={...el(s||".",{relative:a})},f=Ut();if(s==null){u.search=f.search;let p=new URLSearchParams(u.search),x=p.getAll("index");if(x.some(v=>v==="")){p.delete("index"),x.filter(b=>b).forEach(b=>p.append("index",b));let v=p.toString();u.search=v?`?${v}`:""}}return(!s||s===".")&&d.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),l!=="/"&&(u.pathname=u.pathname==="/"?l:Xr([l,u.pathname])),Gs(u)}function Cv(s,{relative:a}={}){let l=h.useContext(ld);Ae(l!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Df("useViewTransitionState"),d=el(s,{relative:a});if(!l.isTransitioning)return!1;let u=_r(l.currentLocation.pathname,i)||l.currentLocation.pathname,f=_r(l.nextLocation.pathname,i)||l.nextLocation.pathname;return No(d.pathname,f)!=null||No(d.pathname,u)!=null}var Rv=df();function Lv(s){return h.createElement(Hy,{flushSync:Rv.flushSync,...s})}/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tv=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Of=(...s)=>s.filter((a,l,i)=>!!a&&a.trim()!==""&&i.indexOf(a)===l).join(" ").trim();/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Pv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=h.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:d="",children:u,iconNode:f,...p},x)=>h.createElement("svg",{ref:x,...Pv,width:a,height:a,stroke:s,strokeWidth:i?Number(l)*24/Number(a):l,className:Of("lucide",d),...p},[...f.map(([g,v])=>h.createElement(g,v)),...Array.isArray(u)?u:[u]]));/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=(s,a)=>{const l=h.forwardRef(({className:i,...d},u)=>h.createElement(Mv,{ref:u,iconNode:a,className:Of(`lucide-${Tv(s)}`,i),...d}));return l.displayName=`${s}`,l};/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=ce("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=ce("Angry",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["path",{d:"M7.5 8 10 9",key:"olxxln"}],["path",{d:"m14 9 2.5-1",key:"1j6cij"}],["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=ce("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=ce("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=ce("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=ce("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=ce("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=ce("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=ce("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=ce("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=ce("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zf=ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=ce("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=ce("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=ce("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=ce("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=ce("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=ce("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hv=ce("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=ce("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=ce("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=ce("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=ce("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=ce("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=ce("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=ce("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=ce("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=ce("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=ce("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hf=ce("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=ce("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=ce("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=ce("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kv=ce("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=ce("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=ce("Laugh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M18 13a6 6 0 0 1-6 5 6 6 0 0 1-6-5h12Z",key:"b2q4dd"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=ce("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=ce("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vf=ce("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=ce("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=ce("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=ce("LockKeyhole",[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wf=ce("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=ce("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=ce("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=ce("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=ce("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=ce("MessageSquareDot",[["path",{d:"M11.7 3H5a2 2 0 0 0-2 2v16l4-4h12a2 2 0 0 0 2-2v-2.7",key:"uodpkb"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=ce("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=ce("MessagesSquare",[["path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z",key:"p1xzt8"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1",key:"1cx29u"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zv=ce("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=ce("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=ce("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=ce("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=ce("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=ce("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=ce("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qf=ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=ce("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=ce("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=ce("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=ce("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=ce("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=ce("SearchX",[["path",{d:"m13.5 8.5-5 5",key:"1cs55j"}],["path",{d:"m8.5 8.5 5 5",key:"a8mexj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=ce("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=ce("ServerCrash",[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=ce("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=ce("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=ce("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=ce("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=ce("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=ce("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=ce("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=ce("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=ce("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oh=ce("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=ce("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=ce("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=ce("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=ce("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0=ce("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=ce("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=ce("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=ce("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function v0(){const s=()=>{try{localStorage.setItem("fk_mobile_ok","1")}catch{}try{location.reload()}catch{}};return t.jsx("div",{className:"min-h-screen min-h-dvh grid place-items-center px-4 py-10",children:t.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-border bg-surface/80 backdrop-blur p-6 shadow-soft text-center",children:[t.jsx("div",{className:"mx-auto mb-3 w-12 h-12 rounded-xl bg-primary-100/70 dark:bg-primary-600/20 grid place-items-center",children:t.jsx(h0,{className:"w-6 h-6 text-primary"})}),t.jsx("h1",{className:"text-xl font-bold dual-text mb-2",children:"手機版開發中"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"目前行動端介面仍在施工中，建議使用桌面版瀏覽器獲得完整體驗。"}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("button",{onClick:s,className:"inline-flex items-center justify-center gap-2 px-4 py-2 rounded-xl bg-primary text-white hover:opacity-90",children:t.jsx("span",{children:"我知道了，仍要繼續"})}),t.jsxs("a",{href:"https://www.whatismybrowser.com/detect/what-is-my-user-agent/",target:"_blank",rel:"noreferrer",className:"inline-flex items-center justify-center gap-2 px-4 py-2 rounded-xl border border-border hover:bg-surface/70",children:[t.jsx(Vv,{className:"w-4 h-4"}),t.jsx("span",{children:"桌面版說明 / 檢查瀏覽器"})]})]}),t.jsx("p",{className:"text-xs text-muted mt-4",children:"提示只會顯示一次，可在設定清除網站資料以重置。"})]})})}const Yr=Object.create(null);Yr.open="0";Yr.close="1";Yr.ping="2";Yr.pong="3";Yr.message="4";Yr.upgrade="5";Yr.noop="6";const yo=Object.create(null);Object.keys(Yr).forEach(s=>{yo[Yr[s]]=s});const Kc={type:"error",data:"parser error"},Zf=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",ep=typeof ArrayBuffer=="function",tp=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,vd=({type:s,data:a},l,i)=>Zf&&a instanceof Blob?l?i(a):Ah(a,i):ep&&(a instanceof ArrayBuffer||tp(a))?l?i(a):Ah(new Blob([a]),i):i(Yr[s]+(a||"")),Ah=(s,a)=>{const l=new FileReader;return l.onload=function(){const i=l.result.split(",")[1];a("b"+(i||""))},l.readAsDataURL(s)};function zh(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Cc;function b0(s,a){if(Zf&&s.data instanceof Blob)return s.data.arrayBuffer().then(zh).then(a);if(ep&&(s.data instanceof ArrayBuffer||tp(s.data)))return a(zh(s.data));vd(s,!1,l=>{Cc||(Cc=new TextEncoder),a(Cc.encode(l))})}const Fh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wa=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Fh.length;s++)Wa[Fh.charCodeAt(s)]=s;const j0=s=>{let a=s.length*.75,l=s.length,i,d=0,u,f,p,x;s[s.length-1]==="="&&(a--,s[s.length-2]==="="&&a--);const g=new ArrayBuffer(a),v=new Uint8Array(g);for(i=0;i<l;i+=4)u=Wa[s.charCodeAt(i)],f=Wa[s.charCodeAt(i+1)],p=Wa[s.charCodeAt(i+2)],x=Wa[s.charCodeAt(i+3)],v[d++]=u<<2|f>>4,v[d++]=(f&15)<<4|p>>2,v[d++]=(p&3)<<6|x&63;return g},w0=typeof ArrayBuffer=="function",bd=(s,a)=>{if(typeof s!="string")return{type:"message",data:rp(s,a)};const l=s.charAt(0);return l==="b"?{type:"message",data:N0(s.substring(1),a)}:yo[l]?s.length>1?{type:yo[l],data:s.substring(1)}:{type:yo[l]}:Kc},N0=(s,a)=>{if(w0){const l=j0(s);return rp(l,a)}else return{base64:!0,data:s}},rp=(s,a)=>{switch(a){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},sp="",k0=(s,a)=>{const l=s.length,i=new Array(l);let d=0;s.forEach((u,f)=>{vd(u,!1,p=>{i[f]=p,++d===l&&a(i.join(sp))})})},S0=(s,a)=>{const l=s.split(sp),i=[];for(let d=0;d<l.length;d++){const u=bd(l[d],a);if(i.push(u),u.type==="error")break}return i};function _0(){return new TransformStream({transform(s,a){b0(s,l=>{const i=l.length;let d;if(i<126)d=new Uint8Array(1),new DataView(d.buffer).setUint8(0,i);else if(i<65536){d=new Uint8Array(3);const u=new DataView(d.buffer);u.setUint8(0,126),u.setUint16(1,i)}else{d=new Uint8Array(9);const u=new DataView(d.buffer);u.setUint8(0,127),u.setBigUint64(1,BigInt(i))}s.data&&typeof s.data!="string"&&(d[0]|=128),a.enqueue(d),a.enqueue(l)})}})}let Rc;function co(s){return s.reduce((a,l)=>a+l.length,0)}function uo(s,a){if(s[0].length===a)return s.shift();const l=new Uint8Array(a);let i=0;for(let d=0;d<a;d++)l[d]=s[0][i++],i===s[0].length&&(s.shift(),i=0);return s.length&&i<s[0].length&&(s[0]=s[0].slice(i)),l}function E0(s,a){Rc||(Rc=new TextDecoder);const l=[];let i=0,d=-1,u=!1;return new TransformStream({transform(f,p){for(l.push(f);;){if(i===0){if(co(l)<1)break;const x=uo(l,1);u=(x[0]&128)===128,d=x[0]&127,d<126?i=3:d===126?i=1:i=2}else if(i===1){if(co(l)<2)break;const x=uo(l,2);d=new DataView(x.buffer,x.byteOffset,x.length).getUint16(0),i=3}else if(i===2){if(co(l)<8)break;const x=uo(l,8),g=new DataView(x.buffer,x.byteOffset,x.length),v=g.getUint32(0);if(v>Math.pow(2,21)-1){p.enqueue(Kc);break}d=v*Math.pow(2,32)+g.getUint32(4),i=3}else{if(co(l)<d)break;const x=uo(l,d);p.enqueue(bd(u?x:Rc.decode(x),a)),i=0}if(d===0||d>s){p.enqueue(Kc);break}}}})}const np=4;function pt(s){if(s)return C0(s)}function C0(s){for(var a in pt.prototype)s[a]=pt.prototype[a];return s}pt.prototype.on=pt.prototype.addEventListener=function(s,a){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(a),this};pt.prototype.once=function(s,a){function l(){this.off(s,l),a.apply(this,arguments)}return l.fn=a,this.on(s,l),this};pt.prototype.off=pt.prototype.removeListener=pt.prototype.removeAllListeners=pt.prototype.removeEventListener=function(s,a){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var l=this._callbacks["$"+s];if(!l)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var i,d=0;d<l.length;d++)if(i=l[d],i===a||i.fn===a){l.splice(d,1);break}return l.length===0&&delete this._callbacks["$"+s],this};pt.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var a=new Array(arguments.length-1),l=this._callbacks["$"+s],i=1;i<arguments.length;i++)a[i-1]=arguments[i];if(l){l=l.slice(0);for(var i=0,d=l.length;i<d;++i)l[i].apply(this,a)}return this};pt.prototype.emitReserved=pt.prototype.emit;pt.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};pt.prototype.hasListeners=function(s){return!!this.listeners(s).length};const Do=typeof Promise=="function"&&typeof Promise.resolve=="function"?a=>Promise.resolve().then(a):(a,l)=>l(a,0),Nr=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),R0="arraybuffer";function ap(s,...a){return a.reduce((l,i)=>(s.hasOwnProperty(i)&&(l[i]=s[i]),l),{})}const L0=Nr.setTimeout,T0=Nr.clearTimeout;function Oo(s,a){a.useNativeTimers?(s.setTimeoutFn=L0.bind(Nr),s.clearTimeoutFn=T0.bind(Nr)):(s.setTimeoutFn=Nr.setTimeout.bind(Nr),s.clearTimeoutFn=Nr.clearTimeout.bind(Nr))}const P0=1.33;function M0(s){return typeof s=="string"?I0(s):Math.ceil((s.byteLength||s.size)*P0)}function I0(s){let a=0,l=0;for(let i=0,d=s.length;i<d;i++)a=s.charCodeAt(i),a<128?l+=1:a<2048?l+=2:a<55296||a>=57344?l+=3:(i++,l+=4);return l}function lp(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function $0(s){let a="";for(let l in s)s.hasOwnProperty(l)&&(a.length&&(a+="&"),a+=encodeURIComponent(l)+"="+encodeURIComponent(s[l]));return a}function D0(s){let a={},l=s.split("&");for(let i=0,d=l.length;i<d;i++){let u=l[i].split("=");a[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}return a}class O0 extends Error{constructor(a,l,i){super(a),this.description=l,this.context=i,this.type="TransportError"}}class jd extends pt{constructor(a){super(),this.writable=!1,Oo(this,a),this.opts=a,this.query=a.query,this.socket=a.socket,this.supportsBinary=!a.forceBase64}onError(a,l,i){return super.emitReserved("error",new O0(a,l,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(a){this.readyState==="open"&&this.write(a)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){const l=bd(a,this.socket.binaryType);this.onPacket(l)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}pause(a){}createUri(a,l={}){return a+"://"+this._hostname()+this._port()+this.opts.path+this._query(l)}_hostname(){const a=this.opts.hostname;return a.indexOf(":")===-1?a:"["+a+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(a){const l=$0(a);return l.length?"?"+l:""}}class A0 extends jd{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(a){this.readyState="pausing";const l=()=>{this.readyState="paused",a()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||l()})),this.writable||(i++,this.once("drain",function(){--i||l()}))}else l()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(a){const l=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};S0(a,this.socket.binaryType).forEach(l),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const a=()=>{this.write([{type:"close"}])};this.readyState==="open"?a():this.once("open",a)}write(a){this.writable=!1,k0(a,l=>{this.doWrite(l,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const a=this.opts.secure?"https":"http",l=this.query||{};return this.opts.timestampRequests!==!1&&(l[this.opts.timestampParam]=lp()),!this.supportsBinary&&!l.sid&&(l.b64=1),this.createUri(a,l)}}let op=!1;try{op=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const z0=op;function F0(){}class B0 extends A0{constructor(a){if(super(a),typeof location<"u"){const l=location.protocol==="https:";let i=location.port;i||(i=l?"443":"80"),this.xd=typeof location<"u"&&a.hostname!==location.hostname||i!==a.port}}doWrite(a,l){const i=this.request({method:"POST",data:a});i.on("success",l),i.on("error",(d,u)=>{this.onError("xhr post error",d,u)})}doPoll(){const a=this.request();a.on("data",this.onData.bind(this)),a.on("error",(l,i)=>{this.onError("xhr poll error",l,i)}),this.pollXhr=a}}let Xn=class vo extends pt{constructor(a,l,i){super(),this.createRequest=a,Oo(this,i),this._opts=i,this._method=i.method||"GET",this._uri=l,this._data=i.data!==void 0?i.data:null,this._create()}_create(){var a;const l=ap(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");l.xdomain=!!this._opts.xd;const i=this._xhr=this.createRequest(l);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let d in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(d)&&i.setRequestHeader(d,this._opts.extraHeaders[d])}}catch{}if(this._method==="POST")try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{i.setRequestHeader("Accept","*/*")}catch{}(a=this._opts.cookieJar)===null||a===void 0||a.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var d;i.readyState===3&&((d=this._opts.cookieJar)===null||d===void 0||d.parseCookies(i.getResponseHeader("set-cookie"))),i.readyState===4&&(i.status===200||i.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof i.status=="number"?i.status:0)},0))},i.send(this._data)}catch(d){this.setTimeoutFn(()=>{this._onError(d)},0);return}typeof document<"u"&&(this._index=vo.requestsCount++,vo.requests[this._index]=this)}_onError(a){this.emitReserved("error",a,this._xhr),this._cleanup(!0)}_cleanup(a){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=F0,a)try{this._xhr.abort()}catch{}typeof document<"u"&&delete vo.requests[this._index],this._xhr=null}}_onLoad(){const a=this._xhr.responseText;a!==null&&(this.emitReserved("data",a),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Xn.requestsCount=0;Xn.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Bh);else if(typeof addEventListener=="function"){const s="onpagehide"in Nr?"pagehide":"unload";addEventListener(s,Bh,!1)}}function Bh(){for(let s in Xn.requests)Xn.requests.hasOwnProperty(s)&&Xn.requests[s].abort()}const U0=(function(){const s=ip({xdomain:!1});return s&&s.responseType!==null})();class H0 extends B0{constructor(a){super(a);const l=a&&a.forceBase64;this.supportsBinary=U0&&!l}request(a={}){return Object.assign(a,{xd:this.xd},this.opts),new Xn(ip,this.uri(),a)}}function ip(s){const a=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!a||z0))return new XMLHttpRequest}catch{}if(!a)try{return new Nr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const cp=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class V0 extends jd{get name(){return"websocket"}doOpen(){const a=this.uri(),l=this.opts.protocols,i=cp?{}:ap(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(a,l,i)}catch(d){return this.emitReserved("error",d)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=a=>this.onClose({description:"websocket connection closed",context:a}),this.ws.onmessage=a=>this.onData(a.data),this.ws.onerror=a=>this.onError("websocket error",a)}write(a){this.writable=!1;for(let l=0;l<a.length;l++){const i=a[l],d=l===a.length-1;vd(i,this.supportsBinary,u=>{try{this.doWrite(i,u)}catch{}d&&Do(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const a=this.opts.secure?"wss":"ws",l=this.query||{};return this.opts.timestampRequests&&(l[this.opts.timestampParam]=lp()),this.supportsBinary||(l.b64=1),this.createUri(a,l)}}const Lc=Nr.WebSocket||Nr.MozWebSocket;class W0 extends V0{createSocket(a,l,i){return cp?new Lc(a,l,i):l?new Lc(a,l):new Lc(a)}doWrite(a,l){this.ws.send(l)}}class q0 extends jd{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(a){return this.emitReserved("error",a)}this._transport.closed.then(()=>{this.onClose()}).catch(a=>{this.onError("webtransport error",a)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(a=>{const l=E0(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=a.readable.pipeThrough(l).getReader(),d=_0();d.readable.pipeTo(a.writable),this._writer=d.writable.getWriter();const u=()=>{i.read().then(({done:p,value:x})=>{p||(this.onPacket(x),u())}).catch(p=>{})};u();const f={type:"open"};this.query.sid&&(f.data=`{"sid":"${this.query.sid}"}`),this._writer.write(f).then(()=>this.onOpen())})})}write(a){this.writable=!1;for(let l=0;l<a.length;l++){const i=a[l],d=l===a.length-1;this._writer.write(i).then(()=>{d&&Do(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var a;(a=this._transport)===null||a===void 0||a.close()}}const J0={websocket:W0,webtransport:q0,polling:H0},K0=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Q0=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Qc(s){if(s.length>8e3)throw"URI too long";const a=s,l=s.indexOf("["),i=s.indexOf("]");l!=-1&&i!=-1&&(s=s.substring(0,l)+s.substring(l,i).replace(/:/g,";")+s.substring(i,s.length));let d=K0.exec(s||""),u={},f=14;for(;f--;)u[Q0[f]]=d[f]||"";return l!=-1&&i!=-1&&(u.source=a,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=X0(u,u.path),u.queryKey=Y0(u,u.query),u}function X0(s,a){const l=/\/{2,9}/g,i=a.replace(l,"/").split("/");return(a.slice(0,1)=="/"||a.length===0)&&i.splice(0,1),a.slice(-1)=="/"&&i.splice(i.length-1,1),i}function Y0(s,a){const l={};return a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,d,u){d&&(l[d]=u)}),l}const Xc=typeof addEventListener=="function"&&typeof removeEventListener=="function",bo=[];Xc&&addEventListener("offline",()=>{bo.forEach(s=>s())},!1);class Xs extends pt{constructor(a,l){if(super(),this.binaryType=R0,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,a&&typeof a=="object"&&(l=a,a=null),a){const i=Qc(a);l.hostname=i.host,l.secure=i.protocol==="https"||i.protocol==="wss",l.port=i.port,i.query&&(l.query=i.query)}else l.host&&(l.hostname=Qc(l.host).host);Oo(this,l),this.secure=l.secure!=null?l.secure:typeof location<"u"&&location.protocol==="https:",l.hostname&&!l.port&&(l.port=this.secure?"443":"80"),this.hostname=l.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=l.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},l.transports.forEach(i=>{const d=i.prototype.name;this.transports.push(d),this._transportsByName[d]=i}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},l),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=D0(this.opts.query)),Xc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},bo.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(a){const l=Object.assign({},this.opts.query);l.EIO=np,l.transport=a,this.id&&(l.sid=this.id);const i=Object.assign({},this.opts,{query:l,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[a]);return new this._transportsByName[a](i)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const a=this.opts.rememberUpgrade&&Xs.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const l=this.createTransport(a);l.open(),this.setTransport(l)}setTransport(a){this.transport&&this.transport.removeAllListeners(),this.transport=a,a.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",l=>this._onClose("transport close",l))}onOpen(){this.readyState="open",Xs.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(a){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",a),this.emitReserved("heartbeat"),a.type){case"open":this.onHandshake(JSON.parse(a.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const l=new Error("server error");l.code=a.data,this._onError(l);break;case"message":this.emitReserved("data",a.data),this.emitReserved("message",a.data);break}}onHandshake(a){this.emitReserved("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this._pingInterval=a.pingInterval,this._pingTimeout=a.pingTimeout,this._maxPayload=a.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const a=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+a,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},a),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const a=this._getWritablePackets();this.transport.send(a),this._prevBufferLen=a.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let l=1;for(let i=0;i<this.writeBuffer.length;i++){const d=this.writeBuffer[i].data;if(d&&(l+=M0(d)),i>0&&l>this._maxPayload)return this.writeBuffer.slice(0,i);l+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const a=Date.now()>this._pingTimeoutTime;return a&&(this._pingTimeoutTime=0,Do(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),a}write(a,l,i){return this._sendPacket("message",a,l,i),this}send(a,l,i){return this._sendPacket("message",a,l,i),this}_sendPacket(a,l,i,d){if(typeof l=="function"&&(d=l,l=void 0),typeof i=="function"&&(d=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const u={type:a,data:l,options:i};this.emitReserved("packetCreate",u),this.writeBuffer.push(u),d&&this.once("flush",d),this.flush()}close(){const a=()=>{this._onClose("forced close"),this.transport.close()},l=()=>{this.off("upgrade",l),this.off("upgradeError",l),a()},i=()=>{this.once("upgrade",l),this.once("upgradeError",l)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():a()}):this.upgrading?i():a()),this}_onError(a){if(Xs.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",a),this._onClose("transport error",a)}_onClose(a,l){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Xc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const i=bo.indexOf(this._offlineEventListener);i!==-1&&bo.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",a,l),this.writeBuffer=[],this._prevBufferLen=0}}}Xs.protocol=np;class G0 extends Xs{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let a=0;a<this._upgrades.length;a++)this._probe(this._upgrades[a])}_probe(a){let l=this.createTransport(a),i=!1;Xs.priorWebsocketSuccess=!1;const d=()=>{i||(l.send([{type:"ping",data:"probe"}]),l.once("packet",b=>{if(!i)if(b.type==="pong"&&b.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",l),!l)return;Xs.priorWebsocketSuccess=l.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(v(),this.setTransport(l),l.send([{type:"upgrade"}]),this.emitReserved("upgrade",l),l=null,this.upgrading=!1,this.flush())})}else{const j=new Error("probe error");j.transport=l.name,this.emitReserved("upgradeError",j)}}))};function u(){i||(i=!0,v(),l.close(),l=null)}const f=b=>{const j=new Error("probe error: "+b);j.transport=l.name,u(),this.emitReserved("upgradeError",j)};function p(){f("transport closed")}function x(){f("socket closed")}function g(b){l&&b.name!==l.name&&u()}const v=()=>{l.removeListener("open",d),l.removeListener("error",f),l.removeListener("close",p),this.off("close",x),this.off("upgrading",g)};l.once("open",d),l.once("error",f),l.once("close",p),this.once("close",x),this.once("upgrading",g),this._upgrades.indexOf("webtransport")!==-1&&a!=="webtransport"?this.setTimeoutFn(()=>{i||l.open()},200):l.open()}onHandshake(a){this._upgrades=this._filterUpgrades(a.upgrades),super.onHandshake(a)}_filterUpgrades(a){const l=[];for(let i=0;i<a.length;i++)~this.transports.indexOf(a[i])&&l.push(a[i]);return l}}let Z0=class extends G0{constructor(a,l={}){const i=typeof a=="object"?a:l;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(d=>J0[d]).filter(d=>!!d)),super(a,i)}};function eb(s,a="",l){let i=s;l=l||typeof location<"u"&&location,s==null&&(s=l.protocol+"//"+l.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=l.protocol+s:s=l.host+s),/^(https?|wss?):\/\//.test(s)||(typeof l<"u"?s=l.protocol+"//"+s:s="https://"+s),i=Qc(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const u=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+u+":"+i.port+a,i.href=i.protocol+"://"+u+(l&&l.port===i.port?"":":"+i.port),i}const tb=typeof ArrayBuffer=="function",rb=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,dp=Object.prototype.toString,sb=typeof Blob=="function"||typeof Blob<"u"&&dp.call(Blob)==="[object BlobConstructor]",nb=typeof File=="function"||typeof File<"u"&&dp.call(File)==="[object FileConstructor]";function wd(s){return tb&&(s instanceof ArrayBuffer||rb(s))||sb&&s instanceof Blob||nb&&s instanceof File}function jo(s,a){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let l=0,i=s.length;l<i;l++)if(jo(s[l]))return!0;return!1}if(wd(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return jo(s.toJSON(),!0);for(const l in s)if(Object.prototype.hasOwnProperty.call(s,l)&&jo(s[l]))return!0;return!1}function ab(s){const a=[],l=s.data,i=s;return i.data=Yc(l,a),i.attachments=a.length,{packet:i,buffers:a}}function Yc(s,a){if(!s)return s;if(wd(s)){const l={_placeholder:!0,num:a.length};return a.push(s),l}else if(Array.isArray(s)){const l=new Array(s.length);for(let i=0;i<s.length;i++)l[i]=Yc(s[i],a);return l}else if(typeof s=="object"&&!(s instanceof Date)){const l={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(l[i]=Yc(s[i],a));return l}return s}function lb(s,a){return s.data=Gc(s.data,a),delete s.attachments,s}function Gc(s,a){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<a.length)return a[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let l=0;l<s.length;l++)s[l]=Gc(s[l],a);else if(typeof s=="object")for(const l in s)Object.prototype.hasOwnProperty.call(s,l)&&(s[l]=Gc(s[l],a));return s}const ob=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],ib=5;var Be;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(Be||(Be={}));class cb{constructor(a){this.replacer=a}encode(a){return(a.type===Be.EVENT||a.type===Be.ACK)&&jo(a)?this.encodeAsBinary({type:a.type===Be.EVENT?Be.BINARY_EVENT:Be.BINARY_ACK,nsp:a.nsp,data:a.data,id:a.id}):[this.encodeAsString(a)]}encodeAsString(a){let l=""+a.type;return(a.type===Be.BINARY_EVENT||a.type===Be.BINARY_ACK)&&(l+=a.attachments+"-"),a.nsp&&a.nsp!=="/"&&(l+=a.nsp+","),a.id!=null&&(l+=a.id),a.data!=null&&(l+=JSON.stringify(a.data,this.replacer)),l}encodeAsBinary(a){const l=ab(a),i=this.encodeAsString(l.packet),d=l.buffers;return d.unshift(i),d}}function Uh(s){return Object.prototype.toString.call(s)==="[object Object]"}class Nd extends pt{constructor(a){super(),this.reviver=a}add(a){let l;if(typeof a=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");l=this.decodeString(a);const i=l.type===Be.BINARY_EVENT;i||l.type===Be.BINARY_ACK?(l.type=i?Be.EVENT:Be.ACK,this.reconstructor=new db(l),l.attachments===0&&super.emitReserved("decoded",l)):super.emitReserved("decoded",l)}else if(wd(a)||a.base64)if(this.reconstructor)l=this.reconstructor.takeBinaryData(a),l&&(this.reconstructor=null,super.emitReserved("decoded",l));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+a)}decodeString(a){let l=0;const i={type:Number(a.charAt(0))};if(Be[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===Be.BINARY_EVENT||i.type===Be.BINARY_ACK){const u=l+1;for(;a.charAt(++l)!=="-"&&l!=a.length;);const f=a.substring(u,l);if(f!=Number(f)||a.charAt(l)!=="-")throw new Error("Illegal attachments");i.attachments=Number(f)}if(a.charAt(l+1)==="/"){const u=l+1;for(;++l&&!(a.charAt(l)===","||l===a.length););i.nsp=a.substring(u,l)}else i.nsp="/";const d=a.charAt(l+1);if(d!==""&&Number(d)==d){const u=l+1;for(;++l;){const f=a.charAt(l);if(f==null||Number(f)!=f){--l;break}if(l===a.length)break}i.id=Number(a.substring(u,l+1))}if(a.charAt(++l)){const u=this.tryParse(a.substr(l));if(Nd.isPayloadValid(i.type,u))i.data=u;else throw new Error("invalid payload")}return i}tryParse(a){try{return JSON.parse(a,this.reviver)}catch{return!1}}static isPayloadValid(a,l){switch(a){case Be.CONNECT:return Uh(l);case Be.DISCONNECT:return l===void 0;case Be.CONNECT_ERROR:return typeof l=="string"||Uh(l);case Be.EVENT:case Be.BINARY_EVENT:return Array.isArray(l)&&(typeof l[0]=="number"||typeof l[0]=="string"&&ob.indexOf(l[0])===-1);case Be.ACK:case Be.BINARY_ACK:return Array.isArray(l)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class db{constructor(a){this.packet=a,this.buffers=[],this.reconPack=a}takeBinaryData(a){if(this.buffers.push(a),this.buffers.length===this.reconPack.attachments){const l=lb(this.reconPack,this.buffers);return this.finishedReconstruction(),l}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const ub=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Nd,Encoder:cb,get PacketType(){return Be},protocol:ib},Symbol.toStringTag,{value:"Module"}));function Ar(s,a,l){return s.on(a,l),function(){s.off(a,l)}}const mb=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class up extends pt{constructor(a,l,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=a,this.nsp=l,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const a=this.io;this.subs=[Ar(a,"open",this.onopen.bind(this)),Ar(a,"packet",this.onpacket.bind(this)),Ar(a,"error",this.onerror.bind(this)),Ar(a,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...a){return a.unshift("message"),this.emit.apply(this,a),this}emit(a,...l){var i,d,u;if(mb.hasOwnProperty(a))throw new Error('"'+a.toString()+'" is a reserved event name');if(l.unshift(a),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(l),this;const f={type:Be.EVENT,data:l};if(f.options={},f.options.compress=this.flags.compress!==!1,typeof l[l.length-1]=="function"){const v=this.ids++,b=l.pop();this._registerAckCallback(v,b),f.id=v}const p=(d=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||d===void 0?void 0:d.writable,x=this.connected&&!(!((u=this.io.engine)===null||u===void 0)&&u._hasPingExpired());return this.flags.volatile&&!p||(x?(this.notifyOutgoingListeners(f),this.packet(f)):this.sendBuffer.push(f)),this.flags={},this}_registerAckCallback(a,l){var i;const d=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(d===void 0){this.acks[a]=l;return}const u=this.io.setTimeoutFn(()=>{delete this.acks[a];for(let p=0;p<this.sendBuffer.length;p++)this.sendBuffer[p].id===a&&this.sendBuffer.splice(p,1);l.call(this,new Error("operation has timed out"))},d),f=(...p)=>{this.io.clearTimeoutFn(u),l.apply(this,p)};f.withError=!0,this.acks[a]=f}emitWithAck(a,...l){return new Promise((i,d)=>{const u=(f,p)=>f?d(f):i(p);u.withError=!0,l.push(u),this.emit(a,...l)})}_addToQueue(a){let l;typeof a[a.length-1]=="function"&&(l=a.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:a,flags:Object.assign({fromQueue:!0},this.flags)};a.push((d,...u)=>i!==this._queue[0]?void 0:(d!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),l&&l(d)):(this._queue.shift(),l&&l(null,...u)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(a=!1){if(!this.connected||this._queue.length===0)return;const l=this._queue[0];l.pending&&!a||(l.pending=!0,l.tryCount++,this.flags=l.flags,this.emit.apply(this,l.args))}packet(a){a.nsp=this.nsp,this.io._packet(a)}onopen(){typeof this.auth=="function"?this.auth(a=>{this._sendConnectPacket(a)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(a){this.packet({type:Be.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},a):a})}onerror(a){this.connected||this.emitReserved("connect_error",a)}onclose(a,l){this.connected=!1,delete this.id,this.emitReserved("disconnect",a,l),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(a=>{if(!this.sendBuffer.some(i=>String(i.id)===a)){const i=this.acks[a];delete this.acks[a],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(a){if(a.nsp===this.nsp)switch(a.type){case Be.CONNECT:a.data&&a.data.sid?this.onconnect(a.data.sid,a.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Be.EVENT:case Be.BINARY_EVENT:this.onevent(a);break;case Be.ACK:case Be.BINARY_ACK:this.onack(a);break;case Be.DISCONNECT:this.ondisconnect();break;case Be.CONNECT_ERROR:this.destroy();const i=new Error(a.data.message);i.data=a.data.data,this.emitReserved("connect_error",i);break}}onevent(a){const l=a.data||[];a.id!=null&&l.push(this.ack(a.id)),this.connected?this.emitEvent(l):this.receiveBuffer.push(Object.freeze(l))}emitEvent(a){if(this._anyListeners&&this._anyListeners.length){const l=this._anyListeners.slice();for(const i of l)i.apply(this,a)}super.emit.apply(this,a),this._pid&&a.length&&typeof a[a.length-1]=="string"&&(this._lastOffset=a[a.length-1])}ack(a){const l=this;let i=!1;return function(...d){i||(i=!0,l.packet({type:Be.ACK,id:a,data:d}))}}onack(a){const l=this.acks[a.id];typeof l=="function"&&(delete this.acks[a.id],l.withError&&a.data.unshift(null),l.apply(this,a.data))}onconnect(a,l){this.id=a,this.recovered=l&&this._pid===l,this._pid=l,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(a=>this.emitEvent(a)),this.receiveBuffer=[],this.sendBuffer.forEach(a=>{this.notifyOutgoingListeners(a),this.packet(a)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(a=>a()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Be.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(a){return this.flags.compress=a,this}get volatile(){return this.flags.volatile=!0,this}timeout(a){return this.flags.timeout=a,this}onAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(a),this}prependAny(a){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(a),this}offAny(a){if(!this._anyListeners)return this;if(a){const l=this._anyListeners;for(let i=0;i<l.length;i++)if(a===l[i])return l.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(a),this}prependAnyOutgoing(a){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(a),this}offAnyOutgoing(a){if(!this._anyOutgoingListeners)return this;if(a){const l=this._anyOutgoingListeners;for(let i=0;i<l.length;i++)if(a===l[i])return l.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(a){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const l=this._anyOutgoingListeners.slice();for(const i of l)i.apply(this,a.data)}}}function ra(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}ra.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var a=Math.random(),l=Math.floor(a*this.jitter*s);s=(Math.floor(a*10)&1)==0?s-l:s+l}return Math.min(s,this.max)|0};ra.prototype.reset=function(){this.attempts=0};ra.prototype.setMin=function(s){this.ms=s};ra.prototype.setMax=function(s){this.max=s};ra.prototype.setJitter=function(s){this.jitter=s};class Zc extends pt{constructor(a,l){var i;super(),this.nsps={},this.subs=[],a&&typeof a=="object"&&(l=a,a=void 0),l=l||{},l.path=l.path||"/socket.io",this.opts=l,Oo(this,l),this.reconnection(l.reconnection!==!1),this.reconnectionAttempts(l.reconnectionAttempts||1/0),this.reconnectionDelay(l.reconnectionDelay||1e3),this.reconnectionDelayMax(l.reconnectionDelayMax||5e3),this.randomizationFactor((i=l.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new ra({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(l.timeout==null?2e4:l.timeout),this._readyState="closed",this.uri=a;const d=l.parser||ub;this.encoder=new d.Encoder,this.decoder=new d.Decoder,this._autoConnect=l.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(a){return arguments.length?(this._reconnection=!!a,a||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(a){return a===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=a,this)}reconnectionDelay(a){var l;return a===void 0?this._reconnectionDelay:(this._reconnectionDelay=a,(l=this.backoff)===null||l===void 0||l.setMin(a),this)}randomizationFactor(a){var l;return a===void 0?this._randomizationFactor:(this._randomizationFactor=a,(l=this.backoff)===null||l===void 0||l.setJitter(a),this)}reconnectionDelayMax(a){var l;return a===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=a,(l=this.backoff)===null||l===void 0||l.setMax(a),this)}timeout(a){return arguments.length?(this._timeout=a,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(a){if(~this._readyState.indexOf("open"))return this;this.engine=new Z0(this.uri,this.opts);const l=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const d=Ar(l,"open",function(){i.onopen(),a&&a()}),u=p=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",p),a?a(p):this.maybeReconnectOnOpen()},f=Ar(l,"error",u);if(this._timeout!==!1){const p=this._timeout,x=this.setTimeoutFn(()=>{d(),u(new Error("timeout")),l.close()},p);this.opts.autoUnref&&x.unref(),this.subs.push(()=>{this.clearTimeoutFn(x)})}return this.subs.push(d),this.subs.push(f),this}connect(a){return this.open(a)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const a=this.engine;this.subs.push(Ar(a,"ping",this.onping.bind(this)),Ar(a,"data",this.ondata.bind(this)),Ar(a,"error",this.onerror.bind(this)),Ar(a,"close",this.onclose.bind(this)),Ar(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(a){try{this.decoder.add(a)}catch(l){this.onclose("parse error",l)}}ondecoded(a){Do(()=>{this.emitReserved("packet",a)},this.setTimeoutFn)}onerror(a){this.emitReserved("error",a)}socket(a,l){let i=this.nsps[a];return i?this._autoConnect&&!i.active&&i.connect():(i=new up(this,a,l),this.nsps[a]=i),i}_destroy(a){const l=Object.keys(this.nsps);for(const i of l)if(this.nsps[i].active)return;this._close()}_packet(a){const l=this.encoder.encode(a);for(let i=0;i<l.length;i++)this.engine.write(l[i],a.options)}cleanup(){this.subs.forEach(a=>a()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(a,l){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",a,l),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const a=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const l=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{a.skipReconnect||(this.emitReserved("reconnect_attempt",a.backoff.attempts),!a.skipReconnect&&a.open(d=>{d?(a._reconnecting=!1,a.reconnect(),this.emitReserved("reconnect_error",d)):a.onreconnect()}))},l);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){const a=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",a)}}const Ua={};function wo(s,a){typeof s=="object"&&(a=s,s=void 0),a=a||{};const l=eb(s,a.path||"/socket.io"),i=l.source,d=l.id,u=l.path,f=Ua[d]&&u in Ua[d].nsps,p=a.forceNew||a["force new connection"]||a.multiplex===!1||f;let x;return p?x=new Zc(i,a):(Ua[d]||(Ua[d]=new Zc(i,a)),x=Ua[d]),l.query&&!a.query&&(a.query=l.queryKey),x.socket(l.path,a)}Object.assign(wo,{Manager:Zc,Socket:up,io:wo,connect:wo});let fs=null;function tn(){if(fs)return fs;fs=wo("/",{path:"/socket.io",transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:800,reconnectionDelayMax:5e3,timeout:2e4}),window.__SOCKET_NEW_COUNT=(window.__SOCKET_NEW_COUNT??0)+1;const s=new Date().toISOString();return console.info(`[socket] created instance #${window.__SOCKET_NEW_COUNT} at ${s}`),console.info("[socket] stack trace:",new Error().stack),fs.on("connect",()=>console.log("[WS] connected",fs?.id)),fs.on("disconnect",a=>console.log("[WS] disconnect",a)),fs.on("connect_error",a=>console.warn("[WS] connect_error",a)),fs.on("reconnect_attempt",a=>console.log("[WS] reconnect_attempt",a)),fs}let Hh=!1,Vh=!1,Wh=0,Tc=null;const Jn=new Set,qh=2e3;function hb(s){const a=s?.post||s;return s.event_id||`${a?.id??"temp"}:${s?.client_tx_id??a?.client_tx_id??""}`}function fb(s){const a=hb(s);if(Jn.has(a))return console.debug(`[realtime] duplicate event ignored: ${a}`),!1;if(Jn.add(a),Jn.size>qh){const l=Array.from(Jn).slice(-Math.floor(qh/2));Jn.clear(),l.forEach(i=>Jn.add(i)),console.info(`[realtime] cleaned seen events cache, kept ${l.length} items`)}return!0}function pb(s){const a=tn(),l=new Date().toISOString();console.info("[realtime] cleaning existing post_created listeners..."),a.off("post_created"),Hh&&console.warn("[realtime] post listener was already installed, re-registering"),Hh=!0,Tc=s;const i=d=>{Wh++;const u=d?.post?.id||d?.id||"unknown",f=d?.origin||"unknown",p=d?.client_tx_id||"none";console.info(`[realtime] received post_created #${Wh}: post_id=${u} origin=${f} tx_id=${p}`),console.debug("[realtime] full payload:",d),fb(d)&&Tc&&Tc(d)};console.info(`[realtime] installing new post_created listener at ${l}`),a.on("post_created",i),console.info("[realtime] post_created listener installed successfully"),console.info("[realtime] current post_created listeners count:",a.listeners("post_created")?.length||0)}function xb(s){pb(s)}function gb(s){const a=tn(),l=i=>{console.debug("[realtime] received comment_created:",i),s(i)};a.off("comment.created"),a.on("comment.created",l)}function yb(s){const a=tn(),l=i=>{console.debug("[realtime] received announce:",i),s(i)};a.off("announce"),a.on("announce",l)}function vb(s,a){if(Vh)return;const l=tn();l.off("post.approved"),l.off("post.rejected"),l.on("post.approved",s),l.on("post.rejected",a),Vh=!0}function tl(){const s="forumkit_client_id";try{const a=window.sessionStorage;let l=a.getItem(s);return l||(l=crypto.randomUUID(),a.setItem(s,l)),l}catch{let a=localStorage.getItem(s);return a||(a=crypto.randomUUID(),localStorage.setItem(s,a)),a}}function mp(){return crypto.randomUUID()}function bb(){const a=tl().replace(/-/g,"").substring(0,6),l="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let i="";for(let d=0;d<6;d++){const f=(a.charCodeAt(d)||0)%l.length;i+=l[f]}return i}function Pc(){return localStorage.getItem("forumkit_demo_mode")==="true"}const jb=s=>{let a=0;for(let l=0;l<s.length;l++)a=a*31+s.charCodeAt(l)|0;return String(a>>>0)};function Co(s){const a=new Set,l=[];for(const i of s){const d=i.id??i.tempKey??(i.client_tx_id?`tx:${i.client_tx_id}`:`h:${jb(i.content||"")}`);a.has(d)||(a.add(d),l.push(i))}return l}function hp(s,a){if(!a)return console.warn("[upsert] incoming item is null/undefined"),s;const l=a.id,i=a.client_tx_id||a.tempKey;let d=!1,u="";const p=Co(s).map(g=>{if(l!=null&&g.id===l)return d=!0,u=`replaced by id: ${l}`,console.info(`[upsert] ${u}`),{...g,...a};const v=g.client_tx_id||g.tempKey;return i&&v&&i===v?(d=!0,u=`replaced by signature: ${i}`,console.info(`[upsert] ${u}`),{...g,...a}):g});d||(u=`prepended new item: id=${l||"none"} sig=${i||"none"}`,console.info(`[upsert] ${u}`),p.unshift(a));const x=Co(p);return console.debug(`[upsert] result: ${s.length} -> ${x.length} items (${u})`),x}function wb(s,a){if(!a)return s;const l=a.post||a;if(!l)return console.warn("[upsert] payload has no post data"),s;const i={...l,client_tx_id:a.client_tx_id||l.client_tx_id,origin:a.origin,event_id:a.event_id};return hp(s,i)}const kd="fk.theme",fp="fk.dark";function pp(){try{return window.matchMedia?.("(prefers-color-scheme: dark)").matches??!1}catch{return!1}}function Sd(s,a){const l=document.documentElement;if(s==="auto"){const d=pp();l.setAttribute("data-theme",d?"dark":"beige"),l.classList.toggle("dark",d);return}l.setAttribute("data-theme",s);const i=!!a||s==="dark";l.classList.toggle("dark",i)}function Nb(s,a){try{localStorage.setItem(kd,s),localStorage.setItem(fp,a?"1":"0")}catch{}}function xp(){let s="beige";try{const l=localStorage.getItem(kd);l&&(s=l)}catch{}let a;try{if(s==="auto")a=pp();else if(s==="dark"){const l=localStorage.getItem(fp);a=l?l==="1":!0}else a=!1}catch{a=!1}return{theme:s,isDark:a}}const Mc=["auto","beige","ocean","forest","mist","dark"];function kb(){try{const s=window.matchMedia?.("(prefers-color-scheme: dark)");if(!s)return;const a=()=>{try{(localStorage.getItem(kd)??"beige")==="auto"&&Sd("auto")}catch{}};s.addEventListener?.("change",a),s.addListener?.(a)}catch{}}try{const{theme:s,isDark:a}=xp();Sd(s,s==="dark"&&a),kb()}catch{}const Ic={auto:"跟隨系統",beige:"米白",ocean:"霧藍",forest:"霧綠",mist:"灰白",dark:"灰黑"};function Ro({className:s=""}){const a=xp().theme,[l,i]=h.useState(a);h.useEffect(()=>{Sd(l,l==="dark")},[l]);const d=()=>{const p=Mc.indexOf(l),x=Mc[(p+1)%Mc.length];i(x),Nb(x,x==="dark");try{"vibrate"in navigator&&navigator.vibrate(10)}catch{}},u="w-4 h-4",f=()=>{switch(l){case"auto":return t.jsx(e0,{className:u});case"beige":return t.jsx(Oh,{className:u});case"ocean":return t.jsx(Vc,{className:u});case"forest":return t.jsx(Xv,{className:u});case"mist":return t.jsx(gs,{className:u});case"dark":return t.jsx(t0,{className:u});default:return t.jsx(Oh,{className:u})}};return h.useEffect(()=>{requestAnimationFrame(()=>{document.documentElement.classList.add("theme-ready"),document.documentElement.classList.add("theme-transition"),setTimeout(()=>{document.documentElement.classList.remove("theme-transition")},300)})},[l]),t.jsx("button",{onClick:d,className:"flex items-center justify-center w-8 h-8 sm:w-7 sm:h-7 rounded-full bg-surface/70 hover:bg-surface border border-border transition text-fg touch-target mobile-btn-sm","aria-label":`切換主題，目前：${Ic[l]}`,title:`切換主題，目前：${Ic[l]}`,"data-tip":`目前：${Ic[l]} (點擊切換)`,children:f()})}function $c(){try{return localStorage.getItem("school_slug")}catch{return null}}function Dc(s){try{s?(localStorage.setItem("school_slug",s),localStorage.setItem("current_school_slug",s),localStorage.setItem("selected_school_slug",s)):(localStorage.removeItem("school_slug"),localStorage.removeItem("current_school_slug"),localStorage.removeItem("selected_school_slug")),window.dispatchEvent(new CustomEvent("fk_school_changed",{detail:{slug:s}}))}catch{}}function Sb({compact:s=!1}){const[a,l]=h.useState([]),[i,d]=h.useState($c()),[u,f]=h.useState(!1),[p,x]=h.useState(null),[g,v]=h.useState(null);h.useEffect(()=>{(async()=>{try{const j=await fetch("/api/auth/profile",{cache:"no-store",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});let R=null,M=null;if(j.ok){const k=await j.json();R=k.school_id||null,M=k.role||null,x(R)}const E=await fetch("/api/schools",{cache:"no-store"});if(!E.ok)throw new Error(`HTTP ${E.status}`);const S=await E.json();if(Array.isArray(S?.items)){const k=S.items.filter(C=>M==="dev_admin"?!0:C.id===R);if(l(k),!$c()&&R&&k.length>0){const C=k[0];d(C.slug),Dc(C.slug)}}}catch{l([])}})()},[]),h.useEffect(()=>{const j=R=>{d(R?.detail?.slug??$c())};return window.addEventListener("fk_school_changed",j),()=>window.removeEventListener("fk_school_changed",j)},[]);const b=a.find(j=>j.slug===i)||null;return t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>f(j=>!j),className:"inline-flex items-center justify-center px-3 py-1.5 rounded-xl border border-border bg-surface/70 hover:bg-surface whitespace-nowrap text-sm text-center w-20 flex-shrink-0 font-medium h-7",title:"切換學校",children:b?(()=>{const j=b.name||b.slug;return j.length>4?j.slice(0,4)+"…":j})():"跨校"}),u&&t.jsxs("div",{className:"absolute z-50 mt-1 left-1/2 -translate-x-1/2 w-56 rounded-xl border border-border bg-surface shadow-soft p-1",children:[t.jsx("button",{className:`w-full text-left px-3 py-2 rounded-lg text-sm ${i?"hover:bg-surface/70":"bg-primary-100/60 dark:bg-primary-600/20"}`,onClick:()=>{d(null),Dc(null),f(!1),v("已切換至：跨校（全部）"),setTimeout(()=>v(null),1800)},children:"跨校（全部）"}),t.jsxs("div",{className:"max-h-64 overflow-auto",children:[a.map(j=>t.jsx("button",{className:`w-full text-left px-3 py-2 rounded-lg text-sm ${i===j.slug?"bg-primary-100/60 dark:bg-primary-600/20":"hover:bg-surface/70"}`,onClick:()=>{d(j.slug),Dc(j.slug),f(!1),v(`已切換至：${j.name||j.slug}`),setTimeout(()=>v(null),1800)},children:j.name},j.id)),a.length===0&&t.jsx("div",{className:"px-3 py-2 text-sm text-muted",children:"尚無學校，待首次註冊自動新增"})]})]}),g&&t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-2 z-30","aria-live":"polite",role:"status",children:t.jsx("div",{className:"w-[92vw] max-w-[420px] rounded-2xl border border-border bg-surface shadow-xl p-3",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(mr,{className:"w-5 h-5 mt-0.5 text-success"}),t.jsx("div",{className:"flex-1 text-sm font-medium text-fg",children:g}),t.jsx("button",{className:"px-2 py-1 text-xs rounded-lg border hover:bg-surface/70",onClick:()=>v(null),"aria-label":"關閉通知",children:"知道了"})]})})})]})}const _d="fk_restart_timestamp",Ya="fk_restart_id";function _b(s,a,l,i){localStorage.setItem("token",s),localStorage.setItem("role",a),localStorage.setItem("school_id",l!==null?String(l):""),i&&localStorage.setItem("refresh_token",i),localStorage.setItem(_d,Date.now().toString())}function Ga(){localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("school_id"),localStorage.removeItem("refresh_token"),localStorage.removeItem(_d),localStorage.removeItem(Ya)}function Et(){return localStorage.getItem("role")||"guest"}function ed(){const s=localStorage.getItem("school_id");return s?parseInt(s):null}function jn(){return!!localStorage.getItem("token")}async function gp(){try{const s=localStorage.getItem(_d);if(!s)return!1;const a=parseInt(s,10);if(Date.now()-a>120*1e3){const d=await fetch("/api/healthz");if(d.ok){const f=(await d.json()).restart_id,p=localStorage.getItem(Ya);if(p&&p!==f)return console.log("[Auth] 檢測到服務重啟，重啟ID變更:",p,"->",f),Ga(),!0;localStorage.setItem(Ya,f)}}return!1}catch(s){return console.warn("[Auth] 重啟檢測失敗:",s),!1}}async function Eb(){try{const s=await fetch("/api/healthz");if(s.ok){const l=(await s.json()).restart_id,i=localStorage.getItem(Ya);if(i&&i!==l){console.log("[Auth] 頁面載入時檢測到服務重啟，重啟ID變更:",i,"->",l),Ga();const d=window.location?.pathname;d&&!d.startsWith("/auth")&&(window.location.href="/auth");return}localStorage.setItem(Ya,l)}if(await gp()){console.log("[Auth] 時間間隔檢測到服務重啟，已清除用戶會話");const a=window.location?.pathname;a&&!a.startsWith("/auth")&&(window.location.href="/auth")}}catch(s){console.warn("[Auth] 初始化重啟檢測失敗:",s)}}function Cb(){const s=setInterval(async()=>{try{if(await gp()){console.log("[Auth] 定期檢查檢測到服務重啟，已清除用戶會話");const a=window.location?.pathname;a&&!a.startsWith("/auth")&&(window.location.href="/auth")}}catch(a){console.warn("[Auth] 定期重啟檢查失敗:",a)}},3e5);return()=>clearInterval(s)}function Ks(){return Et()==="dev_admin"}function Rb(){try{const s=localStorage.getItem("token")||"";if(!s||s.split(".").length<2)return null;const l=JSON.parse(atob(s.split(".")[1]))?.sub;return typeof l=="string"||typeof l=="number"?String(l):null}catch{return null}}function rl(s){return{guest:"訪客",user:"一般用戶",campus_moderator:"校內審核",cross_moderator:"跨校審核",campus_admin:"校內板主",cross_admin:"跨校板主",dev_admin:"開發人員"}[s]||s}const yp=h.createContext(void 0);function Lb({children:s}){const[a,l]=h.useState({isLoggedIn:jn(),role:Et(),schoolId:ed(),username:localStorage.getItem("username")}),i=(u,f,p,x,g)=>{_b(u,f,p,x),g&&localStorage.setItem("username",g),l({isLoggedIn:!0,role:f,schoolId:p,username:g||null})},d=()=>{Ga(),localStorage.removeItem("username"),l({isLoggedIn:!1,role:"guest",schoolId:null,username:null})};return h.useEffect(()=>{const u=f=>{(f.key==="token"||f.key==="role"||f.key==="school_id"||f.key==="username")&&l({isLoggedIn:jn(),role:Et(),schoolId:ed(),username:localStorage.getItem("username")})};return window.addEventListener("storage",u),()=>window.removeEventListener("storage",u)},[]),t.jsx(yp.Provider,{value:{isLoggedIn:a.isLoggedIn,role:a.role,schoolId:a.schoolId,username:a.username,login:i,logout:d},children:s})}function rr(){const s=h.useContext(yp);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const Jh={guest:[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/about",label:"關於我們",icon:_o},{to:"/rules",label:"版規",icon:qc},{to:"/auth",label:"登入",icon:qf,iconOnly:!0}],user:[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/about",label:"關於我們",icon:_o},{to:"/rules",label:"版規",icon:qc},{to:"/my-violations",label:"我的違規",icon:ct},{to:"/settings/profile",label:"設定",icon:Vs}],dev_admin:[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/admin",label:"後台",icon:Js},{to:"/admin/chat",label:"聊天",icon:Ba},{to:"/admin/events",label:"事件",icon:er},{to:"/settings/admin",label:"設定",icon:Vs}],campus_admin:[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/admin",label:"後台",icon:Js},{to:"/admin/chat",label:"聊天",icon:Ba},{to:"/admin/events",label:"事件",icon:er},{to:"/settings/admin",label:"設定",icon:Vs}],cross_admin:[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/admin",label:"後台",icon:Js},{to:"/admin/chat",label:"聊天",icon:Ba},{to:"/admin/events",label:"事件",icon:er},{to:"/settings/admin",label:"設定",icon:Vs}],campus_moderator:[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/admin",label:"後台",icon:Js},{to:"/admin/chat",label:"聊天",icon:Ba},{to:"/admin/events",label:"事件",icon:er},{to:"/settings/admin",label:"設定",icon:Vs}],cross_moderator:[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/admin",label:"後台",icon:Js},{to:"/admin/chat",label:"聊天",icon:Ba},{to:"/admin/events",label:"事件",icon:er},{to:"/settings/admin",label:"設定",icon:Vs}]};function Ge({pathname:s}){const{isLoggedIn:a,role:l,logout:i}=rr(),u=Jh[a?l:"guest"]||Jh.guest,f=p=>s===p||p!=="/"&&s&&s.startsWith(p);return t.jsx("nav",{className:"fixed top-4 left-0 right-0 z-50 hidden md:block",children:t.jsx("div",{className:"mx-auto max-w-5xl",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsxs("ul",{className:"flex items-center gap-6 px-6 py-3 rounded-2xl bg-surface/70 backdrop-blur-md border border-border shadow-sm h-12 tablet-nav",children:[u.map(({to:p,label:x,icon:g,iconOnly:v})=>t.jsx("li",{children:t.jsxs(Er,{to:p,className:["relative flex items-center gap-2 px-4 py-2 rounded-xl transition whitespace-nowrap touch-target",f(p)?"font-semibold ring-1 ring-primary-100 dark:ring-primary-600/40 bg-primary-100/60 dark:bg-primary-600/20 text-fg":"text-muted hover:text-fg hover:bg-surface/70"].join(" "),"aria-label":v?x:void 0,title:v?x:void 0,children:[t.jsx(g,{className:"h-5 w-5","aria-hidden":"true"}),!v&&t.jsx("span",{className:"text-sm",children:x}),f(p)&&t.jsx("span",{className:"pointer-events-none absolute left-2 right-2 -bottom-1 h-0.5 rounded bg-fg/80 dark:bg-fg/90"})]})},p)),t.jsxs("li",{className:"pl-4 ml-4 border-l border-border flex items-center gap-3",children:[t.jsx(Sb,{}),t.jsx("div",{className:"w-px h-6 bg-border"}),t.jsx(Ro,{}),a&&t.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 rounded-xl text-muted hover:text-fg hover:bg-surface/70 transition",title:"登出",children:[t.jsx(Jf,{className:"h-5 w-5"}),t.jsx("span",{className:"text-sm",children:"登出"})]})]})]})})})})}function Ys({status:s,title:a,message:l,hint:i,actionHref:d="/",actionText:u="回到首頁"}){const f=Tb(s),p=f.icon;return t.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:t.jsxs("div",{className:"max-w-lg w-full rounded-2xl border border-border bg-surface p-6 shadow-soft text-center",children:[t.jsx("div",{className:`mx-auto w-14 h-14 rounded-2xl ${f.badgeBg} flex items-center justify-center mb-3`,children:t.jsx(p,{className:`w-7 h-7 ${f.badgeFg}`})}),t.jsx("div",{className:"text-sm text-muted mb-1",children:s?`錯誤代碼 ${s}`:"錯誤"}),t.jsx("h1",{className:"text-2xl font-bold dual-text mb-1",children:a||f.title}),l&&t.jsx("p",{className:"text-sm text-muted mb-2 whitespace-pre-wrap break-words",children:l}),i&&t.jsx("p",{className:"text-xs text-muted mb-4 whitespace-pre-wrap break-words",children:i}),t.jsxs("a",{href:d,className:"inline-flex items-center gap-2 px-3 py-2 rounded-xl border hover:bg-surface/80 text-sm",children:[t.jsx(Zt,{className:"w-4 h-4"})," ",u]})]})})}function Tb(s){return s?s===400?Qr("請求有誤",ct):s===401?Qr("需要登入",Gv):s===403?Qr("沒有權限",Xf):s===404?Qr("找不到頁面",o0):s===408?Qr("請求逾時",p0):s===429?Qr("請求過於頻繁",$v):s===500?Qr("伺服器錯誤",i0):s===502||s===503||s===504?Qr("服務暫時不可用",g0):Qr("發生錯誤",ct):Qr("發生錯誤",ct)}function Qr(s,a){return{title:s,icon:a,badgeBg:"bg-amber-100 dark:bg-amber-900/30",badgeFg:"text-amber-700 dark:text-amber-300"}}function Ed(){const{isLoggedIn:s}=rr(),a=Ut(),l=s?Et():"guest",[i,d]=h.useState(!1),u=(v=10)=>{try{"vibrate"in navigator&&navigator.vibrate(v)}catch{}},f=v=>a.pathname===v,p=[{path:"/",icon:Zt,label:"首頁",show:!0},{path:"/boards",icon:tr,label:"討論",show:!0},{path:"/create",icon:Uv,label:"發文",show:s},{path:s?"/settings/profile":"/auth",icon:zr,label:s?"我的":"登入",show:!0}],x={path:"/admin",icon:Gn,label:"管理",show:["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"].includes(l)},g=p.filter(v=>v.show);return x.show&&g.push(x),t.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 md:hidden",children:t.jsx("div",{className:"bg-nav-bg/95 backdrop-blur-md border-t border-nav-border",children:t.jsx("div",{className:"flex items-center justify-around px-2 py-1 pb-[env(safe-area-inset-bottom)]",children:g.map((v,b)=>{const j=v.icon,R=f(v.path);return t.jsxs(Er,{to:v.path,onClick:()=>u(8),className:`
                  flex flex-col items-center gap-1 px-3 py-2 rounded-lg
                  min-w-0 flex-1 transition-all duration-200
                  ${R?"text-primary bg-primary/10 scale-105":"text-muted hover:text-fg hover:bg-surface/50"}
                `,children:[t.jsx(j,{className:`w-5 h-5 ${R?"stroke-2":"stroke-[1.5]"}`}),t.jsx("span",{className:`text-xs font-medium truncate ${R?"font-semibold":""}`,children:v.label})]},v.path)})})})})}function Pb(s){try{return JSON.parse(`"${s.replace(/"/g,'\\"')}"`)}catch{return s}}function Lo(s,a,l){let i=a?.msg||a?.error?.message||a?.error||l||"";typeof i!="string"&&(i=String(i||""));const d=a?.error?.code||a?.code||"",u={JWT_EXPIRED:"登入逾時，請重新登入",JWT_INVALID:"登入憑證無效，請重新登入",JWT_MISSING:"請先登入再繼續"};if(u[d])return u[d];const f=i.toLowerCase();if(f.includes("permission denied")||f.includes("forbidden"))return"權限不足，請聯絡管理員";if(/\\u[0-9a-fA-F]{4}/.test(i))return Pb(i);if(s===401)return i||"尚未登入或登入逾時";if(s===403)return i||"權限不足";if(s===404)return i||"找不到資源";if(s&&s>=500){const p=a?.error?.hint||a?.hint,x=i||"伺服器忙碌，請稍後再試";return p?`${x}（${String(p)}）`:x}return i||"發生未知錯誤"}const Mb={},Kh=Mb?.VITE_API_BASE_URL||"";function wn(s){return Kh?Kh.replace(/\/?$/,"")+(s.startsWith("/")?s:`/${s}`):s}class Cr extends Error{status;body;constructor(a,l){const i=Lo(a,l,`HTTP ${a}`);super(i),this.status=a,this.body=l,this.name="HttpError"}}async function Cd(){const s=localStorage.getItem("refresh_token");if(!s)return null;try{const a=await fetch(wn("/api/auth/refresh"),{method:"POST",headers:{Authorization:`Bearer ${s}`}});if(!a.ok)return null;const i=(await a.json().catch(()=>null))?.access_token;return i?(localStorage.setItem("token",i),i):null}catch{return null}}async function Rd(s){const a=await s.text();try{return a?JSON.parse(a):null}catch{return a}}function Zn(){let s=localStorage.getItem("client_id");if(!s){s="c_"+Math.random().toString(16).slice(2)+Date.now().toString(16);try{localStorage.setItem("client_id",s)}catch{}}return s}function kr(){try{const s=localStorage.getItem("selected_school_slug");return s&&s.trim()?s.trim():null}catch{return null}}async function Bt(s,a){let l=Td(),i=await fetch(wn(s),{...a,headers:{"Content-Type":"application/json","X-Client-Id":Zn(),...kr()?{"X-School-Slug":kr()}:{},...l?{Authorization:`Bearer ${l}`}:{}}});if(i.status===401){const u=await Cd();u&&(l=u,i=await fetch(wn(s),{...a,headers:{"Content-Type":"application/json","X-Client-Id":Zn(),...kr()?{"X-School-Slug":kr()}:{},Authorization:`Bearer ${l}`}}))}const d=await Rd(i);if(!i.ok||d?.ok===!1)throw new Cr(i.status,d);return d&&typeof d=="object"&&Object.prototype.hasOwnProperty.call(d,"data")?d.data:d}async function vp(s,a,l){let i=Td(),d=await fetch(wn(s),{method:"POST",...l,headers:{"Content-Type":"application/json",...l?.headers||{},"X-Client-Id":Zn(),...kr()?{"X-School-Slug":kr()}:{},...i?{Authorization:`Bearer ${i}`}:{}},body:JSON.stringify(a)});if(d.status===401){const f=await Cd();f&&(i=f,d=await fetch(wn(s),{method:"POST",...l,headers:{"Content-Type":"application/json",...l?.headers||{},"X-Client-Id":Zn(),...kr()?{"X-School-Slug":kr()}:{},Authorization:`Bearer ${i}`},body:JSON.stringify(a)}))}const u=await Rd(d);if(!d.ok||u?.ok===!1)throw new Cr(d.status,u);return u&&typeof u=="object"&&Object.prototype.hasOwnProperty.call(u,"data")?u.data:u}async function Ld(s,a,l){let i=Td(),d=await fetch(wn(s),{method:"POST",...l,headers:{...l?.headers||{},"X-Client-Id":Zn(),...kr()?{"X-School-Slug":kr()}:{},...i?{Authorization:`Bearer ${i}`}:{}},body:a});if(d.status===401){const f=await Cd();f&&(i=f,d=await fetch(wn(s),{method:"POST",...l,headers:{...l?.headers||{},"X-Client-Id":Zn(),...kr()?{"X-School-Slug":kr()}:{},Authorization:`Bearer ${i}`},body:a}))}const u=await Rd(d);if(!d.ok||u?.ok===!1)throw new Cr(d.status,u);return u&&typeof u=="object"&&Object.prototype.hasOwnProperty.call(u,"data")?u.data:u}function Td(){let s=localStorage.getItem("token");if(!s){const a=localStorage.getItem("jwt");a&&(localStorage.setItem("token",a),localStorage.removeItem("jwt"),s=a)}return s}function Pd(s){if(typeof s!="object"||s===null)throw new Error("Post must be an object");if(typeof s.id!="number")throw new Error("Post.id must be a number");if(typeof s.content!="string")throw new Error("Post.content must be a string");return{id:s.id,content:s.content,author_hash:typeof s.author_hash=="string"?s.author_hash:void 0,created_at:typeof s.created_at=="string"?s.created_at:void 0,media_count:typeof s.media_count=="number"?s.media_count:void 0,cover_path:typeof s.cover_path=="string"?s.cover_path:s.cover_path===null?null:void 0,client_tx_id:typeof s.client_tx_id=="string"?s.client_tx_id:void 0}}function td(s){if(typeof s!="object"||s===null)throw new Error("PostList must be an object");if(!Array.isArray(s.items))throw new Error("PostList.items must be an array");if(typeof s.page!="number")throw new Error("PostList.page must be a number");if(typeof s.per_page!="number")throw new Error("PostList.per_page must be a number");if(typeof s.total!="number")throw new Error("PostList.total must be a number");return{items:s.items.map((l,i)=>{try{return Pd(l)}catch(d){throw new Error(`PostList.items[${i}]: ${d instanceof Error?d.message:String(d)}`)}}),page:s.page,per_page:s.per_page,total:s.total}}function bp({className:s="",showIcon:a=!1}){const{isLoggedIn:l,username:i}=rr(),d=()=>Pc()?"系統展示":l&&i?i:bb(),u=()=>Pc()||l?"text-fg":"text-muted";return t.jsxs("span",{className:`text-sm font-medium ${u()} ${s}`,children:[a&&t.jsx("span",{className:"mr-1",children:Pc()?"🔧":l?"👤":"🕵️"}),d()]})}function Qh({post:s,onReaction:a,onShare:l}){const[i,d]=h.useState(!1),[u,f]=h.useState(!1),[p,x]=h.useState(null),g=h.useRef(null),v=(E=10)=>{try{"vibrate"in navigator&&navigator.vibrate(E)}catch{}},b=E=>{const S=new Date(E),C=new Date().getTime()-S.getTime(),N=Math.floor(C/6e4);if(N<60)return`${N}分鐘前`;const O=Math.floor(N/60);if(O<24)return`${O}小時前`;const B=Math.floor(O/24);return B<7?`${B}天前`:S.toLocaleDateString("zh-TW",{month:"short",day:"numeric"})},j=async()=>{v(12);try{const E=`${window.location.origin}/post/${s.id}`;await navigator.clipboard.writeText(E),f(!0),setTimeout(()=>f(!1),2e3)}catch(E){console.warn("複製失敗:",E)}},R=()=>{const E=setTimeout(()=>{v(15),d(!0)},600);x(E)},M=()=>{p&&(clearTimeout(p),x(null))};return t.jsxs(t.Fragment,{children:[t.jsxs("article",{ref:g,onTouchStart:R,onTouchEnd:M,onTouchCancel:M,className:`bg-surface border border-border rounded-xl p-4 mb-3 \r
                   active:scale-[0.98] transition-transform duration-100\r
                   shadow-soft hover:shadow-medium`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx(bp,{hash:s.author_hash,className:"font-medium text-fg"}),s.pending_private&&t.jsx("span",{className:"text-xs bg-warning/20 text-warning-text px-2 py-0.5 rounded-full",children:"審核中"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-muted text-sm",children:[t.jsx(ta,{className:"w-3 h-3"}),t.jsx("time",{children:b(s.created_at)})]})]}),t.jsx(Er,{to:`/post/${s.id}`,className:"block group",children:t.jsx("div",{className:`prose prose-sm max-w-none text-fg\r
                         group-active:text-fg/80 transition-colors`,children:t.jsx("p",{className:"line-clamp-4 leading-relaxed whitespace-pre-wrap",children:s.content})})}),s.media_files&&s.media_files.length>0&&t.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2",children:s.media_files.slice(0,4).map((E,S)=>t.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden",children:[t.jsx("img",{src:E.url,alt:`媒體 ${S+1}`,className:"w-full h-full object-cover",loading:"lazy"}),s.media_files.length>4&&S===3&&t.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:t.jsxs("span",{className:"text-white font-medium",children:["+",s.media_files.length-3]})})]},E.id))}),t.jsxs("div",{className:"flex items-center justify-between mt-4 pt-3 border-t border-border/50",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("button",{onClick:()=>a?.(s.id,"like"),className:`flex items-center gap-1 text-muted hover:text-danger transition-colors\r
                         p-2 -m-2 rounded-full hover:bg-danger/10 active:scale-95`,children:[t.jsx(Hf,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm font-medium",children:s.reaction_counts?.like||0})]}),t.jsxs(Er,{to:`/post/${s.id}#comments`,className:`flex items-center gap-1 text-muted hover:text-primary transition-colors\r
                         p-2 -m-2 rounded-full hover:bg-primary/10 active:scale-95`,children:[t.jsx(tr,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm font-medium",children:s.comment_count||0})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:j,className:`text-muted hover:text-fg transition-colors\r
                         p-2 -m-2 rounded-full hover:bg-surface-hover active:scale-95`,children:u?t.jsx(zf,{className:"w-4 h-4 text-success"}):t.jsx(Ih,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>d(!0),className:`text-muted hover:text-fg transition-colors\r
                         p-2 -m-2 rounded-full hover:bg-surface-hover active:scale-95`,children:t.jsx(Uf,{className:"w-4 h-4"})})]})]})]}),i&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-end justify-center p-4",onClick:()=>d(!1),children:t.jsxs("div",{className:`bg-surface rounded-2xl border border-border shadow-2xl \r
                       w-full max-w-sm overflow-hidden`,onClick:E=>E.stopPropagation(),children:[t.jsx("div",{className:"p-4 border-b border-border",children:t.jsx("h3",{className:"font-medium text-fg",children:"貼文操作"})}),t.jsxs("div",{className:"p-2",children:[t.jsxs("button",{onClick:()=>{l?.(s.id),d(!1)},className:`w-full flex items-center gap-3 p-3 rounded-lg\r
                           text-fg hover:bg-surface-hover transition-colors`,children:[t.jsx(u0,{className:"w-5 h-5"}),t.jsx("span",{children:"分享貼文"})]}),t.jsxs("button",{onClick:()=>{j(),d(!1)},className:`w-full flex items-center gap-3 p-3 rounded-lg\r
                           text-fg hover:bg-surface-hover transition-colors`,children:[t.jsx(Ih,{className:"w-5 h-5"}),t.jsx("span",{children:"複製連結"})]})]})]})})]})}function Ib({onPostCreated:s}){const{isLoggedIn:a}=rr(),[l,i]=h.useState(!1),[d,u]=h.useState(""),[f,p]=h.useState([]),[x,g]=h.useState(!1),[v,b]=h.useState(null),j=(S=10)=>{try{"vibrate"in navigator&&navigator.vibrate(S)}catch{}};if(!a)return null;const R=async()=>{if(!d.trim())return;j(12),g(!0),b(null);const S=tl(),k=mp(),C=new Date().toISOString(),N={tempKey:`tmp_${k}`,client_tx_id:k,content:d.trim(),author_hash:"您",created_at:C,pending_private:!0};try{let O;if(f.length>0){const B=new FormData;B.set("content",d.trim()),B.set("client_tx_id",k),f.forEach(I=>B.append("files",I)),O=await Ld("/api/posts/with-media",B,{headers:{"X-Client-Id":S,"X-Tx-Id":k}})}else O=await vp("/api/posts/create",{content:d.trim(),client_tx_id:k},{headers:{"X-Client-Id":S,"X-Tx-Id":k}});s?.(N),u(""),p([]),i(!1)}catch(O){O instanceof Cr?b(O.message):b("發文失敗，請稍後再試")}finally{g(!1)}},M=S=>{const k=Array.from(S.target.files||[]);p(C=>[...C,...k].slice(0,4))},E=S=>{p(k=>k.filter((C,N)=>N!==S))};return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{j(8),i(!0)},className:`fixed right-4 bottom-20 z-40 w-14 h-14 bg-primary hover:bg-primary-hover\r
                   rounded-full shadow-xl border border-primary/20\r
                   flex items-center justify-center transition-all duration-200\r
                   active:scale-95 md:hidden`,"aria-label":"快速發文",children:t.jsx(n0,{className:"w-6 h-6 text-white"})}),l&&t.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-end",children:t.jsxs("div",{className:`w-full bg-surface rounded-t-2xl border-t border-border shadow-2xl\r
                          max-h-[80vh] flex flex-col`,children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[t.jsx("h2",{className:"font-semibold text-fg",children:"快速發文"}),t.jsx("button",{onClick:()=>i(!1),className:`w-8 h-8 rounded-full hover:bg-surface-hover \r
                           flex items-center justify-center transition-colors`,children:t.jsx(Eo,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex-1 p-4 space-y-4",children:[t.jsx("textarea",{value:d,onChange:S=>u(S.target.value),placeholder:"匿名分享你的想法...",className:`w-full h-32 p-3 bg-bg border border-border rounded-lg\r
                           text-fg placeholder-muted resize-none\r
                           focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary`,autoFocus:!0}),f.length>0&&t.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.map((S,k)=>t.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-surface-hover",children:[S.type.startsWith("image/")?t.jsx("img",{src:URL.createObjectURL(S),alt:`預覽 ${k+1}`,className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("span",{className:"text-sm text-muted truncate px-2",children:S.name})}),t.jsx("button",{onClick:()=>E(k),className:`absolute top-1 right-1 w-6 h-6 bg-black/60 rounded-full\r
                                   flex items-center justify-center`,children:t.jsx(Eo,{className:"w-3 h-3 text-white"})})]},k))}),v&&t.jsx("div",{className:"p-3 bg-danger/10 border border-danger/20 rounded-lg",children:t.jsx("p",{className:"text-sm text-danger",children:v})})]}),t.jsxs("div",{className:"p-4 border-t border-border flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("label",{className:`w-10 h-10 rounded-full bg-surface-hover hover:bg-surface-active\r
                                  flex items-center justify-center cursor-pointer transition-colors`,children:[t.jsx(Jv,{className:"w-5 h-5"}),t.jsx("input",{type:"file",accept:"image/*,video/*",multiple:!0,onChange:M,className:"hidden"})]}),t.jsx("button",{className:`w-10 h-10 rounded-full bg-surface-hover hover:bg-surface-active\r
                             flex items-center justify-center transition-colors`,title:"語音輸入（即將推出）",disabled:!0,children:t.jsx(Zv,{className:"w-5 h-5 text-muted"})})]}),t.jsxs("button",{onClick:R,disabled:!d.trim()||x,className:`px-6 py-2 bg-primary hover:bg-primary-hover disabled:opacity-50\r
                           text-white rounded-full font-medium\r
                           flex items-center gap-2 transition-all duration-200\r
                           active:scale-95 disabled:active:scale-100`,children:[t.jsx(pd,{className:"w-4 h-4"}),x?"發文中...":"發文"]})]})]})})]})}function jp({injectedItems:s=[]}){const[a,l]=h.useState(null),[i,d]=h.useState(1),[u,f]=h.useState(!0),[p,x]=h.useState(!1),[g,v]=h.useState(!1),[b,j]=h.useState(null),[R,M]=h.useState(!1),E=h.useRef(null),S=15,k=(A=10)=>{try{"vibrate"in navigator&&navigator.vibrate(A)}catch{}},C=async(A=1,J=!1)=>{if(!(p&&!J||A>1&&!u)){x(!0),J&&v(!0),j(null);try{const ae=localStorage.getItem("school_slug")||"";let Y="",Z=!1;try{const q=await fetch("/api/auth/profile",{cache:"no-store"});q.ok&&(Z=(await q.json()).role==="dev_admin")}catch{}ae?Y=`&school=${encodeURIComponent(ae)}`:Z&&(Y="&all_schools=true");const V=`/api/posts/list?limit=${S}&page=${A}${Y}`,$=await Bt(V),z=td($);l(J||A===1?z:q=>({...z,posts:[...q?.posts||[],...z.posts]})),f(z.posts.length===S),d(J?2:A+1)}catch(ae){const Y=ae instanceof Cr?ae.message:"載入失敗";j(Y)}finally{x(!1),v(!1)}}};h.useEffect(()=>{C(1,!0)},[]),h.useEffect(()=>{const A=E.current;if(!A)return;const J=()=>{const{scrollTop:ae,scrollHeight:Y,clientHeight:Z}=A;M(ae>500),Y-ae-Z<300&&u&&!p&&C(i)};return A.addEventListener("scroll",J,{passive:!0}),()=>A.removeEventListener("scroll",J)},[i,u,p]);const N=()=>{k(12),C(1,!0)},O=()=>{k(8),E.current?.scrollTo({top:0,behavior:"smooth"})},B=async(A,J)=>{k(8);try{await fetch(`/api/posts/${A}/react`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reaction:J})}),C(1,!0)}catch(ae){console.warn("反應失敗:",ae)}},w=async A=>{k(12);try{const J=`${window.location.origin}/post/${A}`;navigator.share?await navigator.share({title:"校園匿名討論",url:J}):await navigator.clipboard.writeText(J)}catch(J){console.warn("分享失敗:",J)}},I=A=>{l(J=>J?{...J,posts:[A,...J.posts]}:null)};return b&&!a?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[t.jsx(Fv,{className:"w-12 h-12 text-muted mb-4"}),t.jsx("p",{className:"text-center text-muted mb-4",children:b}),t.jsx("button",{onClick:()=>C(1,!0),className:"px-4 py-2 bg-primary text-white rounded-lg font-medium",children:"重新載入"})]}):t.jsxs("div",{ref:E,className:"h-full overflow-y-auto",children:[t.jsx("div",{className:"sticky top-0 z-10 bg-bg/80 backdrop-blur-sm border-b border-border/50",children:t.jsx("div",{className:"flex items-center justify-center py-3",children:g?t.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[t.jsx(_t,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{children:"更新中..."})]}):t.jsx("button",{onClick:N,className:"text-sm text-primary hover:text-primary-600 font-medium",children:"下拉刷新"})})}),t.jsxs("div",{className:"p-4 pb-24",children:[s.map((A,J)=>t.jsx(Qh,{post:A,onReaction:B,onShare:w},A.tempKey||`injected-${J}`)),a?.posts.map(A=>t.jsx(Qh,{post:A,onReaction:B,onShare:w},A.id)),p&&i>1&&t.jsx("div",{className:"flex justify-center py-6",children:t.jsx(_t,{className:"w-6 h-6 animate-spin text-muted"})}),!u&&a?.posts.length&&a.posts.length>5&&t.jsx("div",{className:"text-center py-6 text-muted text-sm",children:"沒有更多貼文了"}),a?.posts.length===0&&s.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-muted mb-4",children:"還沒有任何貼文"}),t.jsx("p",{className:"text-sm text-muted",children:"成為第一個發文的人吧！"})]})]}),R&&t.jsx("button",{onClick:O,className:`fixed right-4 bottom-32 z-30 w-10 h-10 bg-surface/90 backdrop-blur\r
                     border border-border rounded-full shadow-lg\r
                     flex items-center justify-center transition-all duration-200\r
                     hover:bg-surface active:scale-95`,children:t.jsx(zv,{className:"w-5 h-5"})}),t.jsx(Ib,{onPostCreated:I})]})}function Xh({message:s,title:a="發生錯誤",className:l=""}){const i=typeof s=="string"?s:s&&typeof s=="object"&&"message"in s?String(s.message):String(s);return t.jsxs("div",{role:"alert",className:`border border-red-400 bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-100 p-3 rounded-xl ${l}`,children:[t.jsx("h4",{className:"font-semibold text-sm mb-1",children:a}),t.jsx("p",{className:"text-sm whitespace-pre-wrap",children:i})]})}const $b={like:Gf,dislike:Yf,love:Hf,laugh:Qv,angry:Iv},Db={like:"讚",dislike:"踩",love:"愛心",laugh:"哈哈",angry:"怒"};function wp({postId:s,initialReactionStats:a={},userPostReaction:l=null}){const[i,d]=h.useState([]),[u,f]=h.useState(""),[p,x]=h.useState(!0),[g,v]=h.useState(!1),[b,j]=h.useState(!1),[R,M]=h.useState(1),[E,S]=h.useState(!1),[k,C]=h.useState(0),[N,O]=h.useState(null),[B,w]=h.useState(!1),[I,A]=h.useState(!1),[J,ae]=h.useState(""),[Y,Z]=h.useState(a),[V,$]=h.useState(l?[l]:[]),[z,q]=h.useState(null),se=h.useRef(null),G=Et(),re=!!localStorage.getItem("token")&&G!=="guest",ee=G==="dev_admin"||G==="campus_admin"||G==="cross_admin",T=async(de=1,be=!1)=>{try{x(!0),O(null);const De=await fetch(`/api/posts/${s}/comments?page=${de}&limit=20`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(!De.ok)throw new Error("載入留言失敗");const Ke=await De.json();d(be?mt=>[...mt,...Ke.comments]:Ke.comments),C(Ke.pagination.total),S(Ke.pagination.has_next),M(de)}catch(De){console.error("載入留言失敗:",De),O("載入留言失敗，請稍後再試")}finally{x(!1)}},K=async()=>{try{const de=await fetch(`/api/posts/${s}/reactions`);if(!de.ok)throw new Error("載入反應失敗");const be=await de.json();Z(be.stats),$(be.user_reactions||[])}catch(de){console.error("載入反應失敗:",de)}},fe=async()=>{if(!(!u.trim()||!re))try{v(!0),O(null);const de=await fetch(`/api/posts/${s}/comments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({content:u.trim()})});if(!de.ok){const De=await de.json().catch(()=>({}));throw new Error(De.error||"發布失敗")}const be=await de.json();d(De=>[be,...De]),f(""),C(De=>De+1),se.current&&(se.current.style.height="auto")}catch(de){console.error("發布留言失敗:",de),O(de.message||"發布留言失敗，請稍後再試")}finally{v(!1)}},ge=async de=>{if(!re){O("請先登入");return}try{q(de),O(null);const be=await fetch(`/api/posts/${s}/reactions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({reaction_type:de})});if(!be.ok){const Ke=await be.json().catch(()=>({}));if(Ke.error?.code==="JWT_EXPIRED"){O("登入已過期，請重新登入"),localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("school_id");return}throw new Error(Ke.error?.message||"操作失敗")}const De=await be.json();$(De.user_reactions||[]),Z(De.stats)}catch(be){console.error("反應操作失敗:",be),O("操作失敗，請稍後再試")}finally{q(null)}},Re=async(de,be)=>{if(!re){O("請先登入");return}try{O(null);const De=await fetch(`/api/comments/${de}/reactions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({reaction_type:be})});if(!De.ok){const mt=await De.json().catch(()=>({}));if(mt.error?.code==="JWT_EXPIRED"){O("登入已過期，請重新登入"),localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("school_id");return}throw new Error(mt.error?.message||"操作失敗")}const Ke=await De.json();d(mt=>mt.map(xt=>xt.id===de?{...xt,stats:Ke.stats,user_reaction:Ke.user_reaction}:xt))}catch(De){console.error("留言反應操作失敗:",De),O("操作失敗，請稍後再試")}},Ee=async()=>{if(!J.trim()){O("請輸入刪文理由");return}w(!0),O(null);try{const de=await fetch(`/api/posts/${s}/delete_request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({reason:J.trim()})});if(!de.ok){const be=await de.json().catch(()=>({}));throw new Error(be.error||"申請失敗")}A(!1),ae(""),O("已送出刪文申請")}catch(de){O(de.message||"申請失敗，請稍後再試")}finally{w(!1)}},$e=async de=>{if(confirm("確定要刪除此留言嗎？"))try{if(O(null),!(await fetch(`/api/comments/${de}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}})).ok)throw new Error("刪除失敗");d(De=>De.filter(Ke=>Ke.id!==de)),C(De=>Math.max(0,De-1))}catch(be){console.error("刪除留言失敗:",be),O("刪除失敗，請稍後再試")}},Ie=de=>{f(de.target.value);const be=de.target;be.style.height="auto",be.style.height=Math.min(be.scrollHeight,120)+"px"};return h.useEffect(()=>{b&&T(1)},[b,s]),h.useEffect(()=>{K()},[s]),h.useEffect(()=>{if(N){const de=setTimeout(()=>O(null),5e3);return()=>clearTimeout(de)}},[N]),t.jsxs("div",{className:"border-t border-border pt-4",children:[N&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[t.jsx(ct,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:N})]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Object.entries($b).map(([de,be])=>{const De=Y[de]||0,Ke=V.includes(de),mt=z===de;return t.jsxs("button",{onClick:()=>ge(de),disabled:mt||!re,className:`flex items-center gap-1 px-3 py-1.5 rounded-full text-sm transition-all ${Ke?"bg-primary text-white shadow-sm":"bg-surface-hover hover:bg-surface-active text-muted hover:text-fg"} ${re?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:[mt?t.jsx(Qs,{className:"w-4 h-4 animate-spin"}):t.jsx(be,{className:`w-4 h-4 ${Ke?"fill-current":""}`}),t.jsx("span",{children:Db[de]}),De>0&&t.jsx("span",{className:"font-medium",children:De})]},de)})}),t.jsxs("div",{className:"flex items-center gap-2",children:[ee&&t.jsxs("button",{onClick:()=>A(!0),disabled:B,className:"flex items-center gap-1 px-3 py-1.5 rounded-full bg-red-100 text-red-700 hover:bg-red-200 transition-colors text-sm disabled:opacity-50",children:[t.jsx(ps,{className:"w-4 h-4"}),B?"處理中...":"刪文請求"]}),I&&t.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-7 w-full max-w-md border border-border relative animate-fadein",children:[t.jsx("button",{className:"absolute top-3 right-3 text-muted hover:text-fg transition-colors",onClick:()=>A(!1),disabled:B,"aria-label":"關閉",children:t.jsx(Eo,{className:"w-5 h-5"})}),t.jsxs("h2",{className:"text-xl font-bold mb-4 text-red-700 flex items-center gap-2",children:[t.jsx(ps,{className:"w-5 h-5"}),"申請刪除貼文"]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"block text-sm font-medium mb-1 text-muted",children:"刪除理由"}),t.jsx("textarea",{className:"w-full border rounded-lg p-2 text-sm focus:ring focus:border-primary min-h-[60px]",rows:3,placeholder:"請輸入刪除理由...",value:J,onChange:de=>ae(de.target.value),disabled:B,maxLength:300}),t.jsxs("div",{className:"text-xs text-muted mt-1 text-right",children:[J.length,"/300"]})]}),N&&t.jsxs("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 rounded text-xs text-red-700 flex items-center gap-2",children:[t.jsx(ct,{className:"w-4 h-4"}),t.jsx("span",{children:N})]}),t.jsxs("div",{className:"flex gap-3 justify-end mt-4",children:[t.jsx("button",{className:"px-4 py-2 rounded-lg bg-muted text-white font-semibold hover:bg-fg/80 transition-colors",onClick:()=>A(!1),disabled:B,children:"取消"}),t.jsx("button",{className:"px-4 py-2 rounded-lg bg-red-600 text-white font-semibold shadow hover:bg-red-700 transition-colors disabled:opacity-50",onClick:Ee,disabled:B||!J.trim(),children:B?"送出中...":"送出申請"})]})]})}),t.jsxs("button",{onClick:()=>j(!b),className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-surface-hover hover:bg-surface-active text-muted hover:text-fg transition-all",children:[t.jsx(Va,{className:"w-4 h-4"}),t.jsx("span",{children:"留言"}),k>0&&t.jsx("span",{className:"font-medium",children:k})]})]})]}),b&&t.jsxs("div",{className:"space-y-4",children:[re?t.jsx("div",{className:"bg-surface border border-border rounded-xl p-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:t.jsx(Va,{className:"w-4 h-4 text-primary"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("textarea",{ref:se,value:u,onChange:Ie,placeholder:"寫下你的留言...",className:"w-full bg-transparent border-none outline-none resize-none text-sm placeholder:text-muted",style:{minHeight:"36px"},disabled:g,maxLength:1e3}),t.jsxs("div",{className:"flex justify-between items-center mt-2",children:[t.jsxs("span",{className:"text-xs text-muted",children:[u.length,"/1000"]}),t.jsxs("button",{onClick:fe,disabled:!u.trim()||g,className:"btn-primary px-4 py-1.5 text-sm flex items-center justify-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:[g?t.jsx(Qs,{className:"w-4 h-4 animate-spin"}):t.jsx(pd,{className:"w-4 h-4"}),t.jsx("span",{children:"發布"})]})]})]})]})}):t.jsx("div",{className:"bg-surface-hover border border-border rounded-xl p-4 text-center",children:t.jsx("p",{className:"text-muted text-sm",children:"請先登入以發布留言"})}),p&&i.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Qs,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-primary"}),t.jsx("p",{className:"text-muted text-sm",children:"載入留言中..."})]}):i.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Va,{className:"w-12 h-12 mx-auto mb-3 text-muted opacity-50"}),t.jsx("p",{className:"text-muted",children:"暫無留言，來搶沙發吧！"})]}):t.jsxs("div",{className:"space-y-3",children:[i.map(de=>t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center",children:t.jsx(Va,{className:"w-3 h-3 text-primary"})}),t.jsx("span",{className:"text-sm font-medium text-fg",children:de.author_label}),t.jsx("span",{className:"text-xs text-muted",children:new Date(de.created_at).toLocaleString()})]}),ee&&t.jsx("button",{onClick:()=>$e(de.id),className:"p-1 text-muted hover:text-red-600 transition-colors",title:"刪除留言",children:t.jsx(ps,{className:"w-3 h-3"})})]}),t.jsx("p",{className:"text-sm text-fg mb-3 whitespace-pre-wrap",children:de.content}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:()=>Re(de.id,"like"),disabled:!re,className:`flex items-center gap-1 px-2 py-1 rounded text-xs transition-all ${de.user_reaction==="like"?"bg-primary text-white":"hover:bg-surface-hover text-muted hover:text-fg"} ${re?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:[t.jsx(Gf,{className:`w-3 h-3 ${de.user_reaction==="like"?"fill-current":""}`}),t.jsx("span",{children:de.stats.likes})]}),t.jsxs("button",{onClick:()=>Re(de.id,"dislike"),disabled:!re,className:`flex items-center gap-1 px-2 py-1 rounded text-xs transition-all ${de.user_reaction==="dislike"?"bg-primary text-white":"hover:bg-surface-hover text-muted hover:text-fg"} ${re?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:[t.jsx(Yf,{className:`w-3 h-3 ${de.user_reaction==="dislike"?"fill-current":""}`}),t.jsx("span",{children:de.stats.dislikes})]})]})]},de.id)),E&&t.jsx("div",{className:"text-center",children:t.jsx("button",{onClick:()=>T(R+1,!0),disabled:p,className:"btn-secondary px-4 py-2 text-sm",children:p?t.jsxs(t.Fragment,{children:[t.jsx(Qs,{className:"w-4 h-4 animate-spin mr-2"}),"載入中..."]}):"載入更多留言"})})]})]})]})}function Np({injectedItems:s=[]}){const[a,l]=h.useState(null),[i,d]=h.useState(1),[u,f]=h.useState(!0),[p,x]=h.useState(!1),[g,v]=h.useState(null),b=10,[j,R]=h.useState(null),M=h.useRef(null),E=async(N=1)=>{if(!p){x(!0),v(null);try{const O=localStorage.getItem("school_slug")||"";let B="",w=!1;try{const ae=await fetch("/api/auth/profile",{cache:"no-store"});ae.ok&&(w=(await ae.json()).role==="dev_admin")}catch{}O?B=`&school=${encodeURIComponent(O)}`:w&&(B="&all_schools=true");const I=await Bt(`/api/posts?page=${N}&per_page=${b}${B}`);let A;try{A=td(I)}catch(ae){if(I&&Array.isArray(I.items)&&(I.page===void 0||I.per_page===void 0||I.total===void 0)){const Y=I.items.map((Z,V)=>(typeof Z?.id!="number"&&(Z.id=-1*(V+1)),typeof Z?.content!="string"&&(Z.content=""),Z));A=td({items:Y,page:N,per_page:b,total:Y.length})}else throw ae}l(N===1?A:ae=>ae?{...A,items:Co([...ae.items,...A.items])}:A);const J=N*b;f(J<A.total),d(N)}catch(O){O instanceof Cr||O instanceof Error?v(O.message):v("載入貼文時發生未知錯誤")}finally{x(!1)}}};h.useEffect(()=>{E(1)},[]),h.useEffect(()=>{const N=()=>E(1);return window.addEventListener("fk_school_changed",N),window.addEventListener("fk_reload_posts",N),()=>window.removeEventListener("fk_school_changed",N)},[]);const S=(()=>{try{return new Set(JSON.parse(localStorage.getItem("forumkit_my_posts")||"[]"))}catch{return new Set}})(),k=a?Co([...a.items,...s]):s,C=async N=>{if(!N)return;const O=`${location.origin}/posts/${N}`;try{await navigator.clipboard.writeText(O),R(N),setTimeout(()=>R(B=>B===N?null:B),1500);try{"vibrate"in navigator&&navigator.vibrate(12)}catch{}}catch{const B=document.createElement("textarea");B.value=O,document.body.appendChild(B),B.select(),document.execCommand("copy"),document.body.removeChild(B),R(N),setTimeout(()=>R(w=>w===N?null:w),1500)}};return p&&!a?t.jsx("div",{className:"text-center py-8 text-muted",children:"載入中..."}):g?t.jsx(Xh,{message:g,title:"載入貼文失敗"}):Array.isArray(k)?t.jsxs("div",{className:"space-y-3 mobile-list oppo-list-lg",children:[k.length===0?t.jsx("div",{className:"text-center py-8 text-muted mobile-text-base oppo-text-lg",children:"目前沒有貼文。"}):k.map(N=>{const O=typeof N.cover_path=="string"?N.cover_path.startsWith("public/")?`https://cdn.serelix.xyz/${N.cover_path.replace(/^public\//,"")}`:N.cover_path.startsWith("media/")?`https://cdn.serelix.xyz/${N.cover_path}`:null:null,B=typeof N.cover_path=="string"?N.cover_path.match(/public\/(?:media\/)?(\d+)\./):null;B&&Number(B[1]),Et();const w=typeof N.media_count=="number"?N.media_count:0,I=()=>{const[A,J]=h.useState(!!O),[ae,Y]=h.useState(!1),[Z,V]=h.useState(O);if(!Z)return null;const $=t.jsxs("div",{className:"mb-3 relative overflow-hidden rounded-lg border border-border bg-surface/50",children:[!ae&&t.jsx("img",{src:Z,alt:"封面",className:`w-full h-48 object-cover transition-opacity ${A?"opacity-0":"opacity-100"}`,loading:"lazy",onLoad:()=>J(!1),onError:()=>{J(!1),Y(!0)}}),A&&t.jsx("div",{className:"absolute inset-0 animate-pulse bg-neutral-200 dark:bg-neutral-800"}),ae&&t.jsx("div",{className:"w-full h-48 grid place-items-center text-xs text-muted",children:"封面載入失敗"}),w>1&&t.jsxs("span",{className:"absolute bottom-2 right-2 text-xs px-2 py-0.5 rounded-md bg-neutral-900/70 text-white",children:[w," 張"]})]});return N.id?t.jsx(Er,{to:`/posts/${N.id}`,children:$}):$};return t.jsxs("article",{id:N.id?`post-${N.id}`:void 0,className:"rounded-xl border border-border bg-surface p-4 relative mobile-card mobile-list-item oppo-post-lg oppo-list-item-lg",children:[t.jsxs("div",{className:"text-xs text-muted mb-2 mobile-text-sm oppo-text-lg",children:["#",N.id||N.tempKey||"待確認"," ",t.jsx("span",{className:"mx-1",children:"•"})," ",N.created_at?new Date(N.created_at).toLocaleString():"時間未知"," ",t.jsx("span",{className:"mx-1",children:"•"}),(()=>{const A=String(N.author_hash||"").trim(),J=/^[A-Z0-9]{6}$/.test(A);return A==="系統訊息"?t.jsx("span",{className:"text-fg",children:"系統訊息"}):J?t.jsxs("span",{className:"text-muted",children:["匿名 ",A]}):A?t.jsx("span",{className:"text-fg",children:A}):t.jsx("span",{className:"text-muted",children:"匿名"})})()]}),t.jsx(I,{}),N.id?t.jsx(Er,{to:`/posts/${N.id}`,className:"block hover:opacity-90 transition-opacity",children:t.jsx("div",{className:"prose prose-sm max-w-none text-fg mobile-text-base oppo-text-lg",dangerouslySetInnerHTML:{__html:N.content}})}):t.jsx("div",{className:"prose prose-sm max-w-none text-fg mobile-text-base oppo-text-lg",dangerouslySetInnerHTML:{__html:N.content}}),N.id&&t.jsx(wp,{postId:N.id}),t.jsxs("div",{className:"mt-3 flex items-center justify-end gap-2 mobile-gap-sm",onTouchStart:A=>{if(N.id){try{if(!matchMedia("(pointer: coarse)").matches)return}catch{}M.current&&clearTimeout(M.current),M.current=setTimeout(()=>C(N.id),600)}},onTouchEnd:()=>{M.current&&(clearTimeout(M.current),M.current=null)},onTouchCancel:()=>{M.current&&(clearTimeout(M.current),M.current=null)},children:[N.pending_private?t.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-200",children:[t.jsx(Qs,{className:"w-3.5 h-3.5 animate-spin"})," 送審中"]}):S.has(N.id)&&N.created_at?t.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md bg-neutral-100 text-neutral-700 dark:bg-neutral-900/40 dark:text-neutral-200",children:[t.jsx(ta,{className:"w-3.5 h-3.5"})," ",new Date(N.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}):null,N.id&&t.jsxs("button",{onClick:()=>C(N.id),className:"hidden md:inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md border border-border hover:bg-surface/70",title:"複製貼文連結",children:[j===N.id?t.jsx(zf,{className:"w-3.5 h-3.5 text-primary"}):t.jsx(Vf,{className:"w-3.5 h-3.5"}),j===N.id?"已複製":"複製連結"]})]})]},N.id??N.tempKey??`fallback-${k.indexOf(N)}`)}),t.jsx("div",{className:"pt-2",children:u?t.jsx("button",{onClick:()=>E(i+1),disabled:p,className:"px-4 py-2 rounded-xl border bg-surface/60 hover:bg-surface/80 border-border text-sm",children:p?"載入中…":"載入更多"}):k.length>0?t.jsx("div",{className:"text-center text-muted text-sm py-2",children:"沒有更多了"}):null})]}):t.jsx(Xh,{message:"資料格式錯誤：items 非陣列"})}const Ob=[".jpg",".jpeg",".png",".webp"],Ab=[".mp4",".webm"];function kp(s){const a=s.toLowerCase();return Ob.some(l=>a.endsWith(l))?"image":Ab.some(l=>a.endsWith(l))?"video":null}function zb(s,a,l=6,i=8,d=50){const u=[],f=[];if(a+s.length>l)return u.push(`最多只能上傳 ${l} 個附件`),{ok:[],errors:u};for(const p of s){const x=kp(p.name);if(!x){u.push(`不支援的副檔名：${p.name}`);continue}const g=p.size/(1024*1024);if(x==="image"&&g>i){u.push(`圖片過大（>${i}MB）：${p.name}`);continue}if(x==="video"&&g>d){u.push(`影片過大（>${d}MB）：${p.name}`);continue}f.push(p)}return{ok:f,errors:u}}function Sp({value:s,onChange:a,maxCount:l=6}){const i=h.useRef(null),[d,u]=h.useState([]),[f,p]=h.useState(!1),x=h.useCallback(j=>{const{ok:R,errors:M}=zb(j,s.length,l);u(M),R.length&&a([...s,...R])},[s,a,l]),g=j=>{j.target.files&&(x(Array.from(j.target.files)),j.target.value="")},v=j=>{j.preventDefault(),p(!1),x(Array.from(j.dataTransfer.files||[]))},b=j=>{const R=s.slice();R.splice(j,1),a(R)};return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{onDragOver:j=>{j.preventDefault(),p(!0)},onDragLeave:()=>p(!1),onDrop:v,className:`border-2 border-dashed rounded-2xl p-6 text-center cursor-pointer transition
          ${f?"border-blue-500 bg-blue-50/10":"border-neutral-600"}`,onClick:()=>i.current?.click(),children:[t.jsx("p",{className:"text-sm text-neutral-300",children:"拖放檔案到此，或點擊選擇（JPG/PNG/WebP/MP4/WebM）"}),t.jsxs("p",{className:"text-xs text-neutral-400 mt-1",children:["最多 ",l," 個，圖片 ≤ 8MB，影片 ≤ 50MB"]}),t.jsx("input",{ref:i,type:"file",accept:".jpg,.jpeg,.png,.webp,.mp4,.webm",multiple:!0,className:"hidden",onChange:g})]}),d.length>0&&t.jsx("ul",{className:"text-red-400 text-sm list-disc list-inside",children:d.map((j,R)=>t.jsx("li",{children:j},R))}),s.length>0&&t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:s.map((j,R)=>{const M=kp(j.name),E=URL.createObjectURL(j);return t.jsxs("div",{className:"relative group border border-neutral-700 rounded-xl p-2",children:[t.jsx("button",{type:"button",onClick:()=>b(R),className:"absolute top-1 right-1 bg-neutral-900/80 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100",children:"刪除"}),M==="image"?t.jsx("img",{src:E,alt:j.name,className:"w-full h-32 object-cover rounded-lg"}):t.jsx("video",{src:E,className:"w-full h-32 rounded-lg",controls:!0,preload:"metadata"}),t.jsx("div",{className:"mt-1 text-xs text-neutral-400 truncate",children:j.name})]},R)})})]})}function Fb({onCreated:s}){const[a,l]=h.useState(""),[i,d]=h.useState([]),[u,f]=h.useState(!1),[p,x]=h.useState(null),[g,v]=h.useState(null),b=async()=>{const j=a.trim();f(!0),x(null);const R=tl(),M=mp(),E=new Date().toISOString();s?.({tempKey:`tmp_${M}`,client_tx_id:M,content:j,author_hash:"您",created_at:E,pending_private:!0});try{let S;if(i.length>0){const k=new FormData;k.set("content",j),k.set("client_tx_id",M),i.forEach(N=>k.append("files",N)),S=await Ld("/api/posts/with-media",k,{headers:{"X-Client-Id":R,"X-Tx-Id":M}})}else S=await vp("/api/posts",{content:j,client_tx_id:M},{headers:{"Content-Type":"application/json","X-Client-Id":R,"X-Tx-Id":M}});Pd(S),l(""),d([]),v("貼文已提交審核，通過後會在清單中顯示。")}catch(S){S instanceof Cr||S instanceof Error?x(S.message):x("發文時發生未知錯誤")}finally{f(!1)}};return t.jsxs("div",{className:"rounded-2xl border border-border bg-surface p-3 sm:p-4 shadow-soft",children:[t.jsx("h3",{className:"font-semibold dual-text mb-2 text-base sm:text-lg",children:"發表新貼文"}),t.jsx("textarea",{className:"form-control min-h-[100px] sm:min-h-[120px] text-sm sm:text-base",placeholder:"想說點什麼？支援 Markdown 語法：**粗體**、*斜體*、`程式碼`、[連結](網址)、# 標題、- 清單",value:a,onChange:j=>l(j.target.value)}),t.jsx("div",{className:"mt-3",children:t.jsx(Sp,{value:i,onChange:d,maxCount:6})}),g&&t.jsx("p",{className:"text-sm text-green-700 dark:text-green-300 mt-2",children:g}),p&&t.jsx("p",{className:"text-sm text-rose-600 mt-2",children:p}),t.jsxs("div",{className:"mt-3 flex gap-2 justify-between items-center",children:[t.jsx("div",{className:"text-sm text-muted",children:i.length>0&&`${i.length} 個檔案`}),t.jsx("button",{onClick:b,disabled:u,className:"px-4 py-2 rounded-xl border dual-btn disabled:opacity-50 text-sm sm:text-base",children:u?"送出中…":"送出"})]})]})}const rd=new Map;function Bb(s,a,l){const i=tn(),d=g=>{g?.room===s&&l?.onBacklog?.(g.messages||[])},u=g=>{g?.room===s&&l?.onPresence?.(Number(g.count||0))},f=g=>{g?.room===s&&l?.onMessage?.(g)},p=g=>{!g||g.room&&g.room!==s||l?.onError?.({room:g.room,error:String(g.error||"UNKNOWN")})};i.on("room.backlog",d),i.on("room.presence",u),i.on("chat.message",f),i.on("room.error",p),rd.set(s,{clientId:a}),i.emit("room.join",{room:s,client_id:a});const x=()=>{const g=rd.get(s);g&&i.emit("room.join",{room:s,client_id:g.clientId})};return i.on("connect",x),()=>{i.off("room.backlog",d),i.off("room.presence",u),i.off("chat.message",f),i.off("room.error",p),i.off("connect",x)}}function Ub(s,a){tn().emit("room.leave",{room:s,client_id:a}),rd.delete(s)}function Hb(s,a,l,i){tn().emit("chat.send",{room:s,message:a,client_id:l,...i?{ts:i}:{}})}function To({room:s,title:a,subtitle:l}){const i=h.useMemo(()=>tl(),[]),[d,u]=h.useState([]),[f,p]=h.useState(0),[x,g]=h.useState(""),[v,b]=h.useState(null),j=h.useRef(null),R=h.useRef(new Set);h.useEffect(()=>{const E=Bb(s,i,{onBacklog:S=>{const k=new Set,C=S.map(N=>{const O=`${N.client_id||""}|${N.ts||""}|${N.message}`;return k.add(O),N});R.current=k,u(C)},onPresence:S=>p(S),onMessage:S=>{const k=`${S.client_id||""}|${S.ts||""}|${S.message}`;R.current.has(k)||(R.current.add(k),u(C=>[...C,S]))},onError:S=>b(S.error)});return()=>{try{E?.()}catch{}try{Ub(s,i)}catch{}}},[s,i]),h.useEffect(()=>{j.current?.scrollIntoView({behavior:"auto",block:"end"})},[d.length]);const M=E=>{E.preventDefault();const S=x.trim();if(!S)return;const k=new Date().toISOString(),C={room:s,message:S,client_id:i,ts:k},N=`${C.client_id}|${C.ts}|${C.message}`;R.current.add(N),u(O=>[...O,C]),Hb(s,S,i,k),g("")};return t.jsxs("div",{className:"rounded-2xl border border-border bg-surface shadow-soft flex flex-col min-h-[280px]",children:[t.jsxs("div",{className:"p-3 sm:p-4 border-b border-border flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold dual-text text-base",children:a||`聊天室：${s}`}),l&&t.jsx("p",{className:"text-xs text-muted mt-0.5",children:l})]}),t.jsxs("div",{className:"text-xs text-muted",children:["在線：",f]})]}),v&&t.jsx("div",{className:"px-3 py-2 text-xs text-amber-700 bg-amber-50 border-b border-border",children:v}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:[d.length===0?t.jsx("div",{className:"text-sm text-muted",children:"暫無訊息"}):d.map(E=>{const S=`${E.client_id||""}|${E.ts||""}|${E.message}`;return t.jsxs("div",{className:`max-w-[85%] p-2 rounded-xl border border-border ${E.client_id===i?"ml-auto bg-primary/10":"bg-surface/70"}`,children:[t.jsx("div",{className:"text-xs text-muted mb-0.5",children:E.client_id===i?"我":E.client_id||"匿名"}),t.jsx("div",{className:"text-sm text-fg break-words whitespace-pre-wrap",children:E.message}),t.jsx("div",{className:"text-[10px] text-muted mt-0.5",children:E.ts?new Date(E.ts).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]},S)}),t.jsx("div",{ref:j})]}),t.jsxs("form",{onSubmit:M,className:"p-3 border-t border-border flex gap-2",children:[t.jsx("input",{value:x,onChange:E=>g(E.target.value),placeholder:"輸入訊息…",className:"form-control text-sm flex-1",maxLength:2e3}),t.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm rounded-xl border dual-btn",children:"送出"})]})]})}function at(){const[s,a]=h.useState(!1),{isLoggedIn:l,logout:i}=rr(),d=l?Et():"guest",u=(b=10)=>{try{"vibrate"in navigator&&navigator.vibrate(b)}catch{}},f=[{to:"/",label:"首頁",icon:Zt},{to:"/boards",label:"貼文",icon:Hs},{to:"/create",label:"發文",icon:hd,require:b=>b!=="guest"},{to:"/about",label:"關於",icon:_o},{to:"/rules",label:"版規",icon:qc}],p=[{to:"/admin",label:"後台",icon:Js,require:b=>["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"].includes(b)},{to:"/admin/comments",label:"留言監控",icon:tr,require:b=>["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"].includes(b)},{to:"/mode",label:"模式管理",icon:yd,require:b=>b==="dev_admin"},{to:"/admin/events",label:"事件",icon:er,require:b=>["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"].includes(b)},{to:"/admin/support",label:"回報",icon:Bv,require:b=>["dev_admin","campus_admin","cross_admin"].includes(b)}],x=[{to:"/settings/profile",label:"個人設定",icon:Vs,require:b=>b!=="guest"}],g=l?[{to:"#logout",label:"登出",icon:Jf}]:[{to:"/auth",label:"登入",icon:qf}],v=[...f,...p,...x,...g].filter(b=>!b.require||b.require(d));return t.jsxs("div",{className:"fixed inset-0 pointer-events-none md:hidden",children:[s&&t.jsx("div",{className:"absolute inset-0 bg-black/40 pointer-events-auto",onClick:()=>a(!1)}),t.jsx("div",{className:`absolute inset-x-0 bottom-0 pb-[env(safe-area-inset-bottom)] transition-transform duration-200 ${s?"translate-y-0 pointer-events-auto":"translate-y-full pointer-events-none"}`,children:t.jsxs("div",{className:"mx-auto max-w-5xl rounded-t-2xl border border-border border-b-0 bg-surface/95 backdrop-blur shadow-2xl",children:[t.jsxs("div",{className:"p-4 flex items-center justify-between",children:[t.jsx("div",{className:"text-sm text-muted",children:"快速操作"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ro,{}),l&&t.jsx(Er,{to:"/settings/profile",className:"px-2 py-1 text-xs rounded border border-border",children:"設定"})]})]}),t.jsx("div",{className:"px-3 pb-3 grid grid-cols-4 gap-2",children:v.map((b,j)=>b.to==="#logout"?t.jsxs("button",{onClick:()=>{u(12),i()},className:"flex flex-col items-center gap-1 p-3 rounded-xl border border-border bg-surface hover:bg-surface/80",children:[t.jsx(b.icon,{className:"w-5 h-5"}),t.jsx("span",{className:"text-xs",children:b.label})]},j):t.jsxs(Er,{to:b.to,onClick:()=>{u(8),a(!1)},className:"flex flex-col items-center gap-1 p-3 rounded-xl border border-border bg-surface hover:bg-surface/80",children:[t.jsx(b.icon,{className:"w-5 h-5"}),t.jsx("span",{className:"text-xs",children:b.label})]},j))})]})}),t.jsx("div",{className:"absolute right-4 bottom-4 pb-[env(safe-area-inset-bottom)] pointer-events-auto",children:t.jsx("button",{onClick:()=>{u(8),a(b=>!b)},"aria-expanded":s,"aria-label":"開啟操作選單",className:"w-14 h-14 rounded-full dual-btn shadow-xl border border-border grid place-items-center",children:t.jsx(Qf,{className:`w-6 h-6 transition-transform ${s?"rotate-45":""}`})})})]})}function Vb(){const{pathname:s}=Ut(),[a,l]=h.useState("lobby");return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:s}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-3xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 shadow-soft mb-4",children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text mb-2",children:"聊天室示範"}),t.jsx("p",{className:"text-sm text-muted",children:"輸入任意房間名稱（建議使用 post:<id> 格式）"}),t.jsx("div",{className:"mt-3 flex items-center gap-2",children:t.jsx("input",{className:"form-control text-sm",value:a,onChange:i=>l(i.target.value),placeholder:"room name"})})]}),t.jsx(To,{room:a||"lobby"})]})]})}function _p(){const s=en();Et(),ed();const[a,l]=h.useState(""),[i,d]=h.useState([]),[u,f]=h.useState(!0),[p,x]=h.useState(null),[g,v]=h.useState([]),[b,j]=h.useState(!1),[R,M]=h.useState(!1);h.useEffect(()=>{if(!jn()){s("/auth");return}(async()=>{try{f(!0),x(null);const O=await fetch("/api/admin/chat-rooms",{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(O.ok){const w=(await O.json()).rooms.map(I=>({id:I.id,name:I.name,description:I.description,icon:S(I.id),accessRoles:I.access_roles,schoolSpecific:I.school_specific,onlineCount:I.online_count||0}));d(w),w.length>0&&!a&&l(w[0].id)}else{const B=await O.json().catch(()=>({}));x(B.error||"無法載入聊天室列表")}}catch(O){console.error("Error fetching chat rooms:",O),x("網路連線錯誤，請稍後再試")}finally{f(!1)}})()},[s]),h.useEffect(()=>{a&&E()},[a]),h.useEffect(()=>{if(!a)return;const N=setInterval(()=>{E()},1e4);return()=>clearInterval(N)},[a]);const E=async()=>{if(a)try{M(!0);const N=await fetch(`/api/admin/chat-rooms/${a}/users`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(N.ok){const O=await N.json();v(O.online_users||[])}else console.error("Failed to load online users")}catch(N){console.error("Error loading online users:",N)}finally{M(!1)}},S=N=>{if(N.startsWith("admin_campus:"))return Qa;switch(N){case"admin_global":return qv;case"admin_cross":return Gn;case"admin_dev":return Ff;default:return tr}},k=N=>({dev_admin:"開發人員",campus_admin:"校內管理員",cross_admin:"跨校管理員",campus_moderator:"校內審核",cross_moderator:"跨校審核",user:"一般用戶"})[N]||N,C=i.find(N=>N.id===a);return jn()?t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/admin/chat"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-6xl px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-6",children:[t.jsx("div",{className:"flex items-center gap-3 mb-2",children:t.jsxs("button",{onClick:()=>s("/admin"),className:"flex items-center gap-2 text-muted hover:text-fg transition-colors",children:[t.jsx(Gr,{className:"w-4 h-4"}),"返回後台"]})}),t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"管理員聊天室"}),t.jsx("p",{className:"text-sm text-muted mt-1",children:"選擇聊天室與其他管理員交流"})]}),u?t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-8 text-center",children:[t.jsx(Qs,{className:"w-8 h-8 mx-auto mb-4 text-muted animate-spin"}),t.jsx("h3",{className:"text-lg font-semibold text-fg mb-2",children:"載入中..."}),t.jsx("p",{className:"text-muted",children:"正在載入聊天室列表"})]}):p?t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-8 text-center",children:[t.jsx(tr,{className:"w-12 h-12 mx-auto mb-4 text-muted"}),t.jsx("h3",{className:"text-lg font-semibold text-fg mb-2",children:"載入失敗"}),t.jsx("p",{className:"text-muted mb-4",children:p}),t.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:"重新載入"})]}):t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 shadow-soft",children:[t.jsx("h3",{className:"font-semibold text-fg mb-4",children:"聊天室列表"}),t.jsx("div",{className:"space-y-2",children:i.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(tr,{className:"w-8 h-8 mx-auto mb-2 text-muted"}),t.jsx("p",{className:"text-sm text-muted",children:"無可用聊天室"})]}):i.map(N=>t.jsx("button",{onClick:()=>l(N.id),className:`w-full text-left p-3 rounded-xl transition-all ${a===N.id?"bg-primary text-white shadow-md":"bg-surface-hover hover:bg-surface-hover/80 text-fg hover:shadow-sm"}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`p-2 rounded-lg ${a===N.id?"bg-white/20":"bg-surface"}`,children:t.jsx(N.icon,{className:"w-4 h-4"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("div",{className:"font-medium truncate",children:N.name}),t.jsx("div",{className:`text-xs truncate ${a===N.id?"opacity-80":"text-muted"}`,children:N.description})]}),t.jsxs("div",{className:"text-xs text-muted",children:[N.onlineCount||0," 在線"]})]})},N.id))})]})}),t.jsx("div",{className:"lg:col-span-3",children:C?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl shadow-soft overflow-hidden",children:[t.jsx("div",{className:"p-4 border-b border-border",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:t.jsx(C.icon,{className:"w-5 h-5 text-primary"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-fg",children:C.name}),t.jsx("p",{className:"text-sm text-muted",children:C.description})]})]}),t.jsxs("button",{onClick:()=>j(!b),className:"flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg border hover:bg-surface/80 transition-colors",children:[t.jsx(gs,{className:"w-4 h-4"}),b?"隱藏":"顯示","線上用戶"]})]})}),t.jsx(To,{room:a,title:C.name,subtitle:C.description})]}),b&&t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 shadow-soft",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-semibold text-fg",children:"線上用戶"}),t.jsxs("div",{className:"flex items-center gap-2",children:[R&&t.jsx(Qs,{className:"w-4 h-4 animate-spin text-muted"}),t.jsxs("span",{className:"text-sm text-muted",children:[g.length+1," 人在線"]})]})]}),g.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(zr,{className:"w-8 h-8 mx-auto mb-2 text-muted"}),t.jsx("p",{className:"text-sm text-muted",children:"目前沒有其他用戶在線"})]}):t.jsx("div",{className:"grid gap-2",children:g.map(N=>t.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-surface-hover",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium text-fg truncate",children:N.username}),t.jsx("div",{className:"text-xs text-muted",children:k(N.role)})]})]},N.client_id))})]})]}):t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-8 text-center shadow-soft",children:[t.jsx(tr,{className:"w-12 h-12 mx-auto mb-4 text-muted"}),t.jsx("h3",{className:"text-lg font-semibold text-fg mb-2",children:"無可用聊天室"}),t.jsx("p",{className:"text-muted",children:"您目前沒有權限訪問任何聊天室"})]})})]})]})]}):null}function Ep({id:s}){const a=Cy(),l=en(),i=s??Number(a.id),[d,u]=h.useState(!0),[f,p]=h.useState(null),[x,g]=h.useState(null),[v,b]=h.useState(null),[j,R]=h.useState(!1),[M,E]=h.useState(!1),[S,k]=h.useState(""),[C,N]=h.useState(null);if(!i||isNaN(i))return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/posts/404"}),t.jsx(at,{}),t.jsx("main",{className:"mx-auto max-w-5xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:t.jsx(Ys,{status:404,title:"無效的貼文編號"})})]});Et(),h.useEffect(()=>{(async()=>{try{if(u(!0),p(null),!i||Number.isNaN(i)){p("無效的貼文編號"),u(!1);return}const w=await Bt(`/api/posts/${i}`);g(w)}catch(w){w instanceof Cr?p(w.message):p(String(w))}finally{u(!1)}})()},[i]);const O=async()=>{if(!S.trim()){alert("請填寫刪文理由");return}try{R(!0);const w=await fetch(`/api/posts/${i}/delete_request`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({reason:S.trim()})});if(!w.ok){const I=await w.json().catch(()=>({})),A=typeof I?.error=="string"?I.error:I?.error?.message||"發送刪文請求失敗";throw new Error(A)}alert("刪文請求已發送，管理員將進行審核"),E(!1),k(""),l("/")}catch(w){console.error("刪文請求失敗:",w),alert(w.message||"發送刪文請求失敗")}finally{R(!1)}};if(d)return t.jsx("div",{className:"min-h-screen grid place-items-center",children:t.jsx("div",{className:"text-muted",children:"載入中..."})});if(f){const w=f,I=w?._http?.status||(typeof w?.status=="number"?w.status:void 0);return t.jsx(Ys,{status:I||404,title:I===404?"貼文不存在或尚未公開":void 0,message:String(f)})}if(!x)return t.jsx(Ys,{status:404,title:"貼文不存在或尚未公開"});const B=({m:w})=>{const I=/\.(jpg|jpeg|png|webp|gif)$/i.test(w.path||"")||w.kind==="image",A=/\.(mp4|webm|mov)$/i.test(w.path||"")||w.kind==="video",[J,ae]=h.useState(I),[Y,Z]=h.useState(!1),[V,$]=h.useState(null);return Et(),h.useEffect(()=>{let z=!0;return(async()=>{try{let se=(w.path||"").replace(/^\/+/,"");if(se.startsWith("public/")){const G=`https://cdn.serelix.xyz/${se.replace(/^public\//,"")}?t=${Date.now()}`;$(G);return}throw new Error("NO_PUBLIC_PATH")}catch{if(!z)return;try{let G=(w.path||"").replace(/^\/+/,"");if(G.startsWith("public/"))$(`https://cdn.serelix.xyz/${G.replace(/^public\//,"")}?t=${Date.now()}`);else if(G.startsWith("media/"))$(`https://cdn.serelix.xyz/${G}?t=${Date.now()}`);else{const re=(w.path||"").split(".").pop()||"jpg",ee=`https://cdn.serelix.xyz/${w.id}.${re}?t=${Date.now()}`;$(ee)}}catch{Z(!0)}}})(),()=>{z=!1}},[w.id,w.path]),t.jsxs("div",{className:"border border-border rounded-xl p-2 min-h-[6rem] grid place-items-center bg-surface/50",children:[I?V?t.jsx("img",{src:V,alt:`media-${w.id}`,className:`w-full h-64 object-contain rounded transition-opacity ${J?"opacity-0":"opacity-100"}`,loading:"lazy",onLoad:()=>ae(!1),onError:()=>{ae(!1),Z(!0)},onClick:()=>!Y&&b({url:V})}):t.jsx("div",{className:"text-xs text-muted",children:"載入中..."}):A?V?t.jsx("video",{src:V,controls:!0,className:"w-full h-64 object-contain rounded"}):t.jsx("div",{className:"text-xs text-muted",children:"載入中..."}):V?t.jsx("a",{href:V,className:"text-sm underline break-all",target:"_blank",rel:"noreferrer",children:"下載附件"}):t.jsx("div",{className:"text-xs text-muted",children:"載入中..."}),J&&t.jsx("div",{className:"absolute w-[92%] h-[88%] animate-pulse rounded-lg bg-neutral-200 dark:bg-neutral-800"}),Y&&t.jsx("div",{className:"text-xs text-muted",children:"無法載入圖片"})]})};return t.jsxs("div",{className:"min-h-screen min-h-dvh",children:[t.jsx(Ge,{pathname:`/posts/${x.id}`}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-5xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-24 md:pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4",children:[t.jsx("div",{className:"flex justify-between items-start mb-4",children:t.jsxs("div",{className:"text-xs text-muted",children:["#",x.id," ",t.jsx("span",{className:"mx-1",children:"•"})," ",x.created_at?new Date(x.created_at).toLocaleString():""," ",t.jsx("span",{className:"mx-1",children:"•"}),(()=>{const w=String(x.author_hash||"").trim(),I=/^[A-Z0-9]{6}$/.test(w);return w==="系統訊息"?t.jsx("span",{className:"text-fg",children:"系統訊息"}):I?t.jsxs("span",{className:"text-muted",children:["匿名 ",w]}):w?t.jsx("span",{className:"text-fg",children:w}):t.jsx("span",{className:"text-muted",children:"匿名"})})()]})}),t.jsx("div",{className:"prose prose-sm max-w-none text-fg",dangerouslySetInnerHTML:{__html:x.content||""}}),x.media&&x.media.length>0&&t.jsx("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:x.media.map(w=>t.jsx(B,{m:w},w.id))})]}),t.jsx("div",{id:"comments-anchor"}),t.jsx(wp,{postId:x.id}),M&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold text-fg mb-4",children:"刪文請求"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"請填寫刪文理由，管理員將根據理由進行審核。"}),t.jsx("textarea",{value:S,onChange:w=>k(w.target.value),placeholder:"請詳細說明刪文理由...",className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none",rows:4,maxLength:500}),t.jsx("div",{className:"flex justify-between items-center mt-2 mb-4",children:t.jsxs("span",{className:"text-xs text-muted",children:[S.length,"/500"]})}),t.jsxs("div",{className:"flex gap-3 flex-col sm:flex-row",children:[t.jsx("button",{onClick:()=>{E(!1),k("")},className:"btn-ghost flex-1 py-2",children:"取消"}),t.jsx("button",{onClick:O,disabled:j||!S.trim(),className:"btn-primary flex-1 py-2 disabled:opacity-50",children:j?"發送中...":"發送請求"})]})]})})]}),v&&t.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>b(null),children:t.jsx("img",{src:v.url,alt:"放大圖片",className:"max-w-full max-h-full object-contain",onClick:w=>w.stopPropagation()})}),t.jsxs("div",{className:"fixed inset-x-0 bottom-0 z-40 md:hidden pb-[env(safe-area-inset-bottom)]",children:[t.jsx("div",{className:"mx-3 mb-3 rounded-2xl border border-border bg-surface/95 backdrop-blur shadow-lg",children:t.jsxs("div",{className:"flex items-center justify-around py-2",children:[t.jsxs("button",{onClick:()=>{try{document.getElementById("comments-anchor")?.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},className:"flex flex-col items-center gap-1 px-3 py-1 text-fg",children:[t.jsx(Va,{className:"w-5 h-5"}),t.jsx("span",{className:"text-xs",children:"留言"})]}),t.jsxs("button",{onClick:async()=>{const w=`${location.origin}/posts/${x.id}`,I=(x.content||"").replace(/<[^>]+>/g,"").slice(0,60);try{navigator.share?await navigator.share({title:`#${x.id}`,text:I,url:w}):(await navigator.clipboard.writeText(w),N("連結已複製"),setTimeout(()=>N(null),1500))}catch{}},className:"flex flex-col items-center gap-1 px-3 py-1 text-fg",children:[t.jsx(d0,{className:"w-5 h-5"}),t.jsx("span",{className:"text-xs",children:"分享"})]}),t.jsxs("button",{onClick:()=>{try{window.location.href=`/support?subject=${encodeURIComponent("回報貼文 #"+x.id)}`}catch{}},className:"flex flex-col items-center gap-1 px-3 py-1 text-fg",children:[t.jsx(Wv,{className:"w-5 h-5"}),t.jsx("span",{className:"text-xs",children:"回報"})]})]})}),C&&t.jsx("div",{className:"mx-auto max-w-sm mb-2 text-center text-xs text-fg bg-surface border border-border px-2 py-1 rounded-full shadow",children:C})]})]})}function Cp(){const[s,a]=h.useState(!0),[l,i]=h.useState(null),[d,u]=h.useState([]),[f,p]=h.useState(null),[x,g]=h.useState(null),[v,b]=h.useState(null),[j,R]=h.useState(null),[M,E]=h.useState(null),[S,k]=h.useState(null),[C,N]=h.useState(null),[O,B]=h.useState(!1),[w,I]=h.useState(""),[A,J]=h.useState(""),[ae,Y]=h.useState(!1),[Z,V]=h.useState(""),[$,z]=h.useState(""),[q,se]=h.useState(""),G=()=>(localStorage.getItem("school_slug")||"").trim(),[re,ee]=h.useState(G()),[T,K]=h.useState(1),[fe,ge]=h.useState(1),[Re,Ee]=h.useState(0),$e=Et(),Ie=async()=>{try{a(!0),i(null);const ie=new URLSearchParams;Z&&ie.append("status",Z),$&&ie.append("keyword",$),q&&ie.append("post_id",q),re?ie.append("school",re):ie.append("scope","cross"),ie.append("page",T.toString()),ie.append("per_page","50");const He=await Bt(`/api/admin/comments/monitor?${ie}`);if(He.ok)u(He.items||[]),Ee(He.total||0),ge(He.total_pages||1);else throw new Error("載入失敗")}catch(ie){ie instanceof Cr?i(ie.message):i("載入失敗")}finally{a(!1)}},de=async()=>{try{const ie=new URLSearchParams;re?ie.append("school",re):ie.append("scope","cross");const He=await Bt(`/api/admin/comments/stats?${ie}`);He.ok&&p(He.stats)}catch(ie){console.error("載入統計失敗:",ie)}},be=async ie=>{try{if(g(ie),!(await fetch(`/api/admin/comments/${ie}/approve`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}})).ok)throw new Error("批准失敗");await Ie(),await de()}catch{i("批准失敗")}finally{g(null)}},De=async ie=>{try{if(g(ie),!(await fetch(`/api/admin/comments/${ie}/reject`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({reason:w||"未符合社群規範"})})).ok)throw new Error("拒絕失敗");await Ie(),await de(),R(null),I("")}catch{i("拒絕失敗")}finally{g(null)}},Ke=async ie=>{try{if(g(ie),!(await fetch(`/api/admin/comments/${ie}/delete`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({reason:A||"管理員刪除"})})).ok)throw new Error("刪除失敗");await Ie(),await de(),E(null),J("")}catch{i("刪除失敗")}finally{g(null)}},mt=async ie=>{try{B(!0);const He=await Bt(`/api/admin/comments/${ie}/detail`);if(He.ok)N(He.comment);else throw new Error("載入詳情失敗")}catch(He){console.error("載入詳情失敗:",He),alert("載入詳情失敗")}finally{B(!1)}},xt=async()=>{try{const ie=new URLSearchParams;Z&&ie.append("status",Z),$&&ie.append("keyword",$),q&&ie.append("post_id",q),re&&ie.append("school",re),ie.append("per_page","1000");const He=await Bt(`/api/admin/comments/monitor?${ie}`);if(He.ok&&He.items){const sr=[["ID","內容","狀態","作者","貼文ID","學校","創建時間","更新時間"],...He.items.map(ht=>[ht.id,`"${ht.content.replace(/"/g,'""')}"`,ht.status,ht.author.username,ht.post.id,ht.post.school_name||"",ht.created_at,ht.updated_at])].map(ht=>ht.join(",")).join(`
`),Zr=new Blob(["\uFEFF"+sr],{type:"text/csv;charset=utf-8;"}),nr=document.createElement("a");nr.href=URL.createObjectURL(Zr),nr.download=`comments_export_${new Date().toISOString().split("T")[0]}.csv`,nr.click()}}catch(ie){console.error("匯出失敗:",ie),alert("匯出失敗")}};return h.useEffect(()=>{Ie(),de()},[T,Z,$,q,re]),h.useEffect(()=>{const ie=He=>{const sr=He?.detail?.slug??G();ee(sr||""),K(1)};return window.addEventListener("fk_school_changed",ie),()=>window.removeEventListener("fk_school_changed",ie)},[]),l?t.jsx(Ys,{title:"留言監控載入失敗",message:l}):t.jsxs("div",{className:"min-h-screen bg-base",children:[t.jsx(Ge,{pathname:"/admin/comments"}),t.jsx("div",{className:"container mx-auto px-4 py-6 max-w-7xl pt-20 sm:pt-24 md:pt-28",children:t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h1",{className:"text-2xl font-bold text-fg flex items-center gap-3",children:[t.jsx(tr,{className:"w-6 h-6"}),"留言監控",t.jsxs("span",{className:"text-sm px-2 py-1 rounded-full bg-primary/10 text-primary",children:[Re," 則留言"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-sm text-muted",children:["身份：",rl($e)]}),t.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary",children:$e==="campus_moderator"?"校內審核":$e==="cross_moderator"?"跨校審核":$e==="campus_admin"?"校內管理":$e==="cross_admin"?"跨校管理":$e==="dev_admin"?"全站管理":"一般用戶"}),t.jsxs("button",{onClick:()=>{Ie(),de()},className:"btn-secondary px-3 py-2 flex items-center gap-2",disabled:s,children:[t.jsx(_t,{className:`w-4 h-4 ${s?"animate-spin":""}`}),"刷新"]})]})]}),f&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Av,{className:"w-4 h-4 text-blue-500"}),t.jsx("h3",{className:"font-medium text-sm text-fg",children:"總留言數"})]}),t.jsx("div",{className:"text-2xl font-bold text-fg",children:f.total})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(ta,{className:"w-4 h-4 text-amber-500"}),t.jsx("h3",{className:"font-medium text-sm text-fg",children:"待檢查"})]}),t.jsx("div",{className:"text-2xl font-bold text-fg",children:f.pending})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(mr,{className:"w-4 h-4 text-green-500"}),t.jsx("h3",{className:"font-medium text-sm text-fg",children:"正常"})]}),t.jsx("div",{className:"text-2xl font-bold text-fg",children:f.approved})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(bn,{className:"w-4 h-4 text-red-500"}),t.jsx("h3",{className:"font-medium text-sm text-fg",children:"違規"})]}),t.jsx("div",{className:"text-2xl font-bold text-fg",children:f.rejected})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(ps,{className:"w-4 h-4 text-gray-500"}),t.jsx("h3",{className:"font-medium text-sm text-fg",children:"已刪除"})]}),t.jsx("div",{className:"text-2xl font-bold text-fg",children:f.deleted})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(qa,{className:"w-4 h-4 text-purple-500"}),t.jsx("h3",{className:"font-medium text-sm text-fg",children:"今日新增"})]}),t.jsx("div",{className:"text-2xl font-bold text-fg",children:f.today})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(qa,{className:"w-4 h-4 text-indigo-500"}),t.jsx("h3",{className:"font-medium text-sm text-fg",children:"本月新增"})]}),t.jsx("div",{className:"text-2xl font-bold text-fg",children:f.month})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-medium text-fg",children:"篩選條件"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:xt,className:"text-sm text-primary hover:text-primary-dark flex items-center gap-1",children:[t.jsx(md,{className:"w-4 h-4"}),"匯出 CSV"]}),t.jsxs("button",{onClick:()=>Y(!ae),className:"text-sm text-primary hover:text-primary-dark",children:[t.jsx(fd,{className:"w-4 h-4 inline mr-1"}),ae?"隱藏":"顯示","篩選"]})]})]}),ae&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"狀態"}),t.jsxs("select",{value:Z,onChange:ie=>V(ie.target.value),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[t.jsx("option",{value:"",children:"全部狀態"}),t.jsx("option",{value:"pending",children:"待檢查"}),t.jsx("option",{value:"approved",children:"正常"}),t.jsx("option",{value:"rejected",children:"違規"}),t.jsx("option",{value:"deleted",children:"已刪除"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"關鍵字"}),t.jsx("input",{type:"text",value:$,onChange:ie=>z(ie.target.value),placeholder:"搜尋留言內容...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"貼文ID"}),t.jsx("input",{type:"text",value:q,onChange:ie=>se(ie.target.value),placeholder:"貼文編號",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"學校"}),t.jsx("input",{type:"text",value:re,onChange:ie=>ee(ie.target.value),placeholder:"學校代碼",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]})]}),t.jsx("div",{className:"space-y-4",children:s?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(_t,{className:"w-8 h-8 mx-auto mb-2 animate-spin opacity-50"}),t.jsx("p",{className:"text-muted",children:"載入中..."})]}):d.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(tr,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"text-muted",children:"沒有找到符合條件的留言"})]}):t.jsxs(t.Fragment,{children:[d.map(ie=>t.jsx("div",{className:"bg-surface border border-border rounded-xl p-6 space-y-4",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsxs("span",{className:"text-sm font-medium text-fg",children:["留言 #",ie.id]}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ie.status==="pending"?"bg-warning-bg text-warning-text":ie.status==="approved"?"bg-success-bg text-success-text":ie.status==="rejected"?"bg-danger-bg text-danger-text":(ie.status==="deleted","bg-muted/10 text-muted")}`,children:ie.status==="pending"?"待檢查":ie.status==="approved"?"正常":ie.status==="rejected"?"違規":ie.status==="deleted"?"已刪除":"未知"}),t.jsx("span",{className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded-full",children:ie.post.school_name||"跨校"})]}),t.jsxs("div",{className:"text-xs text-muted mb-2",children:["來源：",ie.post.school_name||"跨校",ie.author?.school_name?` · 作者：${ie.author.school_name}`:""]}),t.jsx("div",{className:"prose prose-sm max-w-none mb-3",children:t.jsx("div",{className:"text-fg whitespace-pre-line",children:ie.content.length>200?t.jsxs(t.Fragment,{children:[ie.content.substring(0,200),"...",t.jsx("button",{onClick:()=>{k({id:ie.id,content:ie.content}),mt(ie.id)},className:"text-primary hover:text-primary-dark text-sm ml-2 underline",children:"查看完整內容"})]}):ie.content})}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(zr,{className:"w-3 h-3"}),ie.author.username]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(gs,{className:"w-3 h-3"}),"貼文 #",ie.post.id]}),ie.created_at&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(qa,{className:"w-3 h-3"}),new Date(ie.created_at).toLocaleString("zh-TW")]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[ie.status==="pending"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>be(ie.id),disabled:x===ie.id,className:"btn-primary px-4 py-2 text-sm flex items-center gap-2",children:[t.jsx(mr,{className:"w-4 h-4"}),"標記正常"]}),t.jsxs("button",{onClick:()=>R({id:ie.id,content:ie.content}),disabled:x===ie.id,className:"btn-danger px-4 py-2 text-sm flex items-center gap-2",children:[t.jsx(bn,{className:"w-4 h-4"}),"標記違規"]})]}),ie.status!=="deleted"&&t.jsxs("button",{onClick:()=>E({id:ie.id,content:ie.content}),disabled:x===ie.id,className:"btn-secondary px-4 py-2 text-sm flex items-center gap-2",children:[t.jsx(ps,{className:"w-4 h-4"}),"刪除"]})]})]})},ie.id)),fe>1&&t.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[t.jsx("button",{onClick:()=>K(Math.max(1,T-1)),disabled:T===1,className:"px-3 py-2 text-sm rounded-lg border dual-btn disabled:opacity-50",children:"上一頁"}),t.jsxs("span",{className:"px-3 py-2 text-sm text-muted",children:["第 ",T," 頁，共 ",fe," 頁"]}),t.jsx("button",{onClick:()=>K(Math.min(fe,T+1)),disabled:T===fe,className:"px-3 py-2 text-sm rounded-lg border dual-btn disabled:opacity-50",children:"下一頁"})]})]})})]})}),j&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold text-fg mb-4",children:"標記違規"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"請填寫違規理由（可選）："}),t.jsx("textarea",{value:w,onChange:ie=>I(ie.target.value),placeholder:"不符合社群規範...",className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none",rows:3}),t.jsxs("div",{className:"flex gap-3 justify-end mt-4",children:[t.jsx("button",{onClick:()=>{R(null),I("")},className:"btn-secondary px-4 py-2",children:"取消"}),t.jsx("button",{onClick:()=>De(j.id),className:"btn-danger px-4 py-2",children:"確認標記"})]})]})}),M&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold text-fg mb-4",children:"刪除留言"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"請填寫刪除理由（可選）："}),t.jsx("textarea",{value:A,onChange:ie=>J(ie.target.value),placeholder:"管理員刪除...",className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none",rows:3}),t.jsxs("div",{className:"flex gap-3 justify-end mt-4",children:[t.jsx("button",{onClick:()=>{E(null),J("")},className:"btn-secondary px-4 py-2",children:"取消"}),t.jsx("button",{onClick:()=>Ke(M.id),className:"btn-danger px-4 py-2",children:"確認刪除"})]})]})}),S&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-fg",children:"留言詳情"}),t.jsx("button",{onClick:()=>{k(null),N(null)},className:"text-muted hover:text-fg",children:"✕"})]}),O?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(_t,{className:"w-8 h-8 mx-auto mb-2 animate-spin opacity-50"}),t.jsx("p",{className:"text-muted",children:"載入中..."})]}):C?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-fg mb-2",children:"留言內容"}),t.jsx("div",{className:"bg-surface-hover border border-border rounded-lg p-4",children:t.jsx("div",{className:"prose prose-sm max-w-none text-fg",dangerouslySetInnerHTML:{__html:C.content||""}})})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-fg mb-2",children:"所屬貼文"}),t.jsxs("div",{className:"bg-surface-hover border border-border rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsxs("span",{className:"text-sm text-muted",children:["貼文 #",C.post.id]}),C.post.school_name&&t.jsx("span",{className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded-full",children:C.post.school_name})]}),t.jsx("div",{className:"prose prose-sm max-w-none text-fg",dangerouslySetInnerHTML:{__html:C.post.content||""}})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-fg mb-2",children:"作者信息"}),t.jsx("div",{className:"bg-surface-hover border border-border rounded-lg p-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"用戶名："}),t.jsx("span",{className:"text-fg",children:C.author.username})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"角色："}),t.jsx("span",{className:"text-fg",children:C.author.role||"一般用戶"})]}),C.author.school_name&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"學校："}),t.jsx("span",{className:"text-fg",children:C.author.school_name})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"狀態："}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${C.status==="pending"?"bg-amber-100 text-amber-800":C.status==="approved"?"bg-green-100 text-green-800":C.status==="rejected"?"bg-red-100 text-red-800":(C.status==="deleted","bg-gray-100 text-gray-800")}`,children:C.status==="pending"?"待檢查":C.status==="approved"?"正常":C.status==="rejected"?"違規":C.status==="deleted"?"已刪除":"未知"})]})]})})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-fg mb-2",children:"時間信息"}),t.jsx("div",{className:"bg-surface-hover border border-border rounded-lg p-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"創建時間："}),t.jsx("span",{className:"text-fg",children:C.created_at?new Date(C.created_at).toLocaleString("zh-TW"):"未知"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"更新時間："}),t.jsx("span",{className:"text-fg",children:C.updated_at?new Date(C.updated_at).toLocaleString("zh-TW"):"未知"})]}),C.deleted_at&&t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"刪除時間："}),t.jsx("span",{className:"text-fg",children:new Date(C.deleted_at).toLocaleString("zh-TW")})]})]})})]})]}):t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-muted",children:"無法載入詳情"})})]})}),t.jsx(at,{})]})}function Wb(){const s=Et(),[a,l]=h.useState(null),[i,d]=h.useState(null),[u,f]=h.useState(!1),p=async()=>{if(s==="dev_admin")try{f(!0),d(null);const x=await fetch("/api/status/events/stats",{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`},cache:"no-store"}),g=await x.json().catch(()=>({}));if(!x.ok||g?.ok===!1)throw new Error(g?.error?.message||`HTTP ${x.status}`);l(g.stats)}catch(x){d(x?.message||String(x))}finally{f(!1)}};return h.useEffect(()=>{p();const x=setInterval(p,3e4);return()=>clearInterval(x)},[]),s!=="dev_admin"?null:t.jsx("div",{className:"fixed top-4 left-4 z-50 max-w-xs sm:max-w-sm",children:t.jsxs("div",{className:"rounded-2xl border border-border bg-surface/80 backdrop-blur px-3 py-2 shadow-soft",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(er,{className:"w-4 h-4 text-info"}),t.jsx("div",{className:"text-sm font-medium text-fg",children:"平台狀態"}),t.jsx("button",{onClick:p,className:"ml-auto text-xs underline text-muted",children:"刷新"})]}),u?t.jsx("div",{className:"text-xs text-muted",children:"載入中…"}):i?t.jsxs("div",{className:"text-xs text-danger-text flex items-center gap-1",children:[t.jsx(ct,{className:"w-3 h-3"})," ",i]}):a?t.jsxs("div",{className:"space-y-1 text-xs",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Af,{className:"w-3 h-3 text-info"}),t.jsx("span",{className:"text-muted",children:"24h："}),t.jsx("span",{className:"text-fg font-medium",children:a.events_24h}),t.jsx("span",{className:"text-muted ml-2",children:"總計："}),t.jsx("span",{className:"text-fg",children:a.total_events})]}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:Object.entries(a.type_distribution).slice(0,3).map(([x,g])=>t.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-surface-hover border border-border",children:[x,":",g]},x))}),a.recent_events&&a.recent_events.length>0&&t.jsxs("div",{className:"mt-1",children:[t.jsx("div",{className:"text-muted mb-1",children:"最新："}),a.recent_events.slice(0,2).map((x,g)=>t.jsxs("div",{className:"truncate",children:["• ",new Date(x.timestamp).toLocaleTimeString()," ",x.title||x.event_type]},g))]})]}):t.jsx("div",{className:"text-xs text-muted",children:"無資料"})]})})}function mo({title:s,children:a,min:l=160,max:i=600,initial:d=280,storageKey:u,className:f=""}){const[p,x]=h.useState(d),[g,v]=h.useState(!1),b=h.useRef(null);h.useEffect(()=>{if(u){const E=localStorage.getItem(u);if(E){const S=parseInt(E,10);!isNaN(S)&&S>=l&&S<=i&&x(S)}}},[u,l,i]),h.useEffect(()=>{u&&localStorage.setItem(u,p.toString())},[p,u]);const j=E=>{if(!b.current)return;const S=b.current.getBoundingClientRect(),k=E-S.top;k>=l&&k<=i&&x(k),v(!0)},R=E=>{E.preventDefault(),j(E.clientY)},M=E=>{E.preventDefault();const S=E.touches[0]?.clientY??0;j(S)};return h.useEffect(()=>{if(!g)return;const E=C=>{if(!b.current)return;const N=b.current.getBoundingClientRect(),O=C.clientY-N.top;O>=l&&O<=i&&x(O)},S=C=>{if(!b.current)return;const N=C.touches[0]?.clientY??0,O=b.current.getBoundingClientRect(),B=N-O.top;B>=l&&B<=i&&x(B),C.preventDefault()},k=()=>v(!1);return document.addEventListener("mousemove",E),document.addEventListener("mouseup",k),document.addEventListener("touchmove",S,{passive:!1}),document.addEventListener("touchend",k),()=>{document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",k),document.removeEventListener("touchmove",S),document.removeEventListener("touchend",k)}},[g,l,i]),t.jsxs("div",{ref:b,className:`relative flex flex-col rounded-xl border border-border/60 bg-surface/50 ${f}`,style:{height:`${p}px`},children:[t.jsx("div",{className:"sticky top-0 z-10 bg-surface/80 backdrop-blur px-2 sm:px-3 py-2 border-b border-border/60",children:t.jsx("h3",{className:"font-semibold dual-text text-sm sm:text-base",children:s})}),t.jsx("div",{className:"flex-1 min-h-0 overflow-auto p-2 sm:p-3",children:a}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-3 sm:h-3.5 bg-border/40 cursor-ns-resize hover:bg-primary/60 transition-colors",onMouseDown:R,onTouchStart:M,style:{touchAction:"none"},"aria-label":"拖拉調整高度",role:"separator","aria-orientation":"horizontal"})]})}const qb={};function Jb(){const{isLoggedIn:s}=rr(),a=()=>t.jsx("style",{children:`
      @media (min-width: 740px) and (max-width: 820px) {
        .right-col-spacing { row-gap: 1rem; }
        .right-top-fixed  { height: 300px !important; }
      }
    `});function l(){const[Y,Z]=h.useState(!1),[V,$]=h.useState(!1);return h.useEffect(()=>{const z=()=>{const q=window.innerWidth;Z(q<768),$(q<640)};return z(),window.addEventListener("resize",z),()=>window.removeEventListener("resize",z)},[]),{isSmallScreen:Y,isTinyScreen:V}}function i(Y){const[Z,V]=h.useState([]);return h.useEffect(()=>{let $=1;const z=T=>{const K=$++;V(fe=>[...fe,{id:K,text:T}]),setTimeout(()=>V(fe=>fe.filter(ge=>ge.id!==K)),5e3)},q=tl(),se=s?Rb():null,G=T=>{const{post:K,origin:fe,client_tx_id:ge}=T;if(console.info(`[App] processing socket payload: post_id=${K?.id} origin=${fe} tx_id=${ge}`),fe===`client:${q}`||se&&fe===`user:${se}`){z(`您的貼文已提交審核：${(K?.content??"").slice(0,30)}…`);try{Y?.({...T,post:{...K,pending_private:!0}})}catch{}try{const Re="forumkit_my_posts",Ee=JSON.parse(localStorage.getItem(Re)||"[]");if(typeof K?.id=="number"&&!Ee.includes(K.id)){Ee.unshift(K.id),localStorage.setItem(Re,JSON.stringify(Ee.slice(0,500)));try{window.dispatchEvent(new CustomEvent("forumkit_local_change",{detail:{key:Re}}))}catch{}}}catch{}}},re=T=>z(`新留言：${(T?.content??"").slice(0,20)}…`),ee=T=>z(`公告：${(T?.message??"").slice(0,30)}…`);xb(G),gb(re),yb(ee),vb(T=>{const K=Number(T?.id);if(K)try{const fe="forumkit_my_posts",ge=JSON.parse(localStorage.getItem(fe)||"[]");if(ge.includes(K)){z(`您的貼文 #${K} 已通過審核`);const Re="forumkit_approved_posts",Ee=JSON.parse(localStorage.getItem(Re)||"[]");if(!Ee.includes(K)){localStorage.setItem(Re,JSON.stringify([K,...Ee].slice(0,500)));try{window.dispatchEvent(new CustomEvent("forumkit_local_change",{detail:{key:Re}}))}catch{}}const $e=ge.filter(Ie=>Ie!==K);localStorage.setItem(fe,JSON.stringify($e));try{window.dispatchEvent(new CustomEvent("forumkit_local_change",{detail:{key:fe}}))}catch{}try{window.dispatchEvent(new CustomEvent("fk_reload_posts"))}catch{}}}catch{}},T=>{const K=Number(T?.id),fe=String(T?.reason||"不符合規範");if(K)try{const ge="forumkit_my_posts",Re=JSON.parse(localStorage.getItem(ge)||"[]");if(Re.includes(K)){z(`您的貼文 #${K} 已被退件（${fe}）`);const Ee=Re.filter($e=>$e!==K);localStorage.setItem(ge,JSON.stringify(Ee));try{window.dispatchEvent(new CustomEvent("forumkit_local_change",{detail:{key:ge}}))}catch{}try{window.dispatchEvent(new CustomEvent("fk_reload_posts"))}catch{}}}catch{}}),tn()},[Y]),Z}function d({onNewPost:Y}){const Z=i(Y);return t.jsx("div",{className:"fixed bottom-3 sm:bottom-4 right-3 sm:right-4 left-3 sm:left-auto z-50 space-y-2",children:Z.map(V=>t.jsx("div",{className:"rounded-xl border border-border bg-surface/90 px-3 py-2 shadow-soft max-w-sm sm:max-w-none ml-auto",children:t.jsx("span",{className:"text-sm text-fg",children:V.text})},V.id))})}const[u,f]=h.useState(()=>{try{return window?.location?.pathname||"/"}catch{return"/"}}),[p,x]=h.useState(null),[g,v]=h.useState(!0),[b,j]=h.useState(null),[R,M]=h.useState(void 0),[E,S]=h.useState(null),[k,C]=h.useState(!0),{isSmallScreen:N}=l(),O=qb?.VITE_MOBILE_UNDER_CONSTRUCTION==="1",B=(()=>{try{return localStorage.getItem("fk_mobile_ok")==="1"}catch{return!1}})(),[w,I]=h.useState([]);if(h.useEffect(()=>{if(!s){try{localStorage.removeItem("forumkit_my_posts")}catch{}try{localStorage.removeItem("forumkit_approved_posts")}catch{}}},[]),O&&N&&!B)return t.jsx(v0,{});function A(){const[Y,Z]=h.useState([]),[V,$]=h.useState([]);h.useEffect(()=>{const q=()=>{try{Z(JSON.parse(localStorage.getItem("forumkit_my_posts")||"[]")||[])}catch{}try{$(JSON.parse(localStorage.getItem("forumkit_approved_posts")||"[]")||[])}catch{}};q();const se=re=>{(!re.key||re.key==="forumkit_my_posts"||re.key==="forumkit_approved_posts")&&q()},G=()=>q();return window.addEventListener("storage",se),window.addEventListener("forumkit_local_change",G),()=>{window.removeEventListener("storage",se),window.removeEventListener("forumkit_local_change",G)}},[]);const z=Math.max(0,Y.filter(q=>!V.includes(q)).length);return t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-3 sm:p-4 shadow-soft",children:[t.jsx("h3",{className:"font-semibold dual-text mb-2 text-base",children:"我的送審 / 已審"}),t.jsxs("div",{className:"text-sm text-muted",children:["送審：",z," 筆 · 已審：",V.length," 筆"]}),V.length>0&&t.jsxs("div",{className:"mt-2 text-xs text-fg",children:["最近通過：#",V.slice(0,5).join(", #")]})]})}const J=Y=>{const Z=new Date().toISOString();if(Y?.post)console.info(`[handleNewPost] socket payload at ${Z}:`,{post_id:Y.post?.id,origin:Y.origin,tx_id:Y.client_tx_id,event_id:Y.event_id}),I(V=>{const $=wb(V,Y);return console.info(`[handleNewPost] socket upsert: ${V.length} -> ${$.length} items`),$});else{const V=!Y?.id;console.info(`[handleNewPost] direct post at ${Z}: ${V?"optimistic":"confirmed"} id=${Y?.id} tx_id=${Y?.client_tx_id}`),I($=>{const z=hp($,Y);return console.info(`[handleNewPost] direct upsert: ${$.length} -> ${z.length} items`),z})}};if(h.useEffect(()=>{const Y=document.documentElement;return Y.getAttribute("data-theme")||Y.setAttribute("data-theme","beige"),Y.classList.add("theme-ready"),()=>Y.classList.remove("theme-ready")},[]),h.useEffect(()=>{fetch("/api/mode").then(Y=>{if(!Y.ok)throw M(Y.status),new Error(`HTTP ${Y.status}: ${Y.statusText}`);return Y.json()}).then(x).catch(Y=>{const Z=Y&&Y.message?String(Y.message):String(Y);if(j(Z),!R){const V=Z.match(/HTTP\s+(\d{3})/);V&&M(Number(V[1]))}}).finally(()=>v(!1))},[]),h.useEffect(()=>{console.log("[ForumKit] build tag","mode-panel-v1-2025-08-26T12:38:49.845Z")},[]),h.useEffect(()=>{const Y=()=>{try{const Z=window?.location?.pathname||"/";f(Z)}catch(Z){console.warn("[App] Failed to get pathname:",Z),f("/")}};return window.addEventListener("popstate",Y),()=>window.removeEventListener("popstate",Y)},[]),h.useEffect(()=>{(p?.mode==="development"&&u==="/"||p?.mode==="test"&&u==="/"&&!Ks())&&(async()=>{try{C(!0);const Z=await fetch("/api/progress",{cache:"no-store"});if(!Z.ok)throw new Error(`HTTP ${Z.status}`);const V=await Z.json();V&&typeof V=="object"&&Array.isArray(V.progress_items)&&Array.isArray(V.recent_updates)?S(V):S({progress_items:[],recent_updates:[],last_updated:new Date().toISOString(),error:"資料格式不正確"})}catch(Z){S({progress_items:[],recent_updates:[],last_updated:new Date().toISOString(),error:Z?.message||String(Z)})}finally{C(!1)}})()},[p?.mode,u]),g)return t.jsx("div",{className:"min-h-screen grid place-items-center",children:t.jsx("div",{className:"text-muted",children:"載入中..."})});if(b||!p){const Y=R||502,Z=Y===502||Y===503||Y===504?"服務暫時不可用":void 0;return t.jsx(Ys,{status:Y,title:Z,message:b||"無法取得平台模式",hint:"伺服器可能正在重啟或暫時不可用，稍候將自動恢復。"})}if(u==="/mode")return t.jsx(Kb,{platform:p,onUpdated:x,full:!0});if(u==="/chat")return t.jsx(Vb,{});if(u==="/admin/chat")return t.jsx(_p,{});if(u&&u.startsWith("/posts/")){const Y=u.split("/")[2],Z=Number(Y);if(!Number.isNaN(Z)&&Z>0)return t.jsx(Ep,{id:Z})}if(u==="/admin/comments")return t.jsx(Cp,{});if(p.mode==="maintenance")return t.jsxs("div",{className:"min-h-screen flex items-center justify-center p-3 sm:p-6 text-center",children:[t.jsx("div",{className:"fixed top-3 sm:top-4 right-3 sm:right-4 z-50",children:t.jsxs("div",{className:"flex items-center gap-2 px-2 sm:px-3 py-1.5 sm:py-2 rounded-2xl bg-surface/70 backdrop-blur border border-border shadow-sm",children:[t.jsx(Ro,{}),t.jsx("span",{className:"text-xs text-muted",children:"主題"})]})}),t.jsxs("div",{className:"max-w-2xl w-full rounded-2xl p-4 sm:p-6 md:p-8 shadow-lg bg-white/70 dark:bg-neutral-900/70 border border-neutral-200 dark:border-neutral-800 backdrop-blur",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:"系統維護中"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"我們正在升級服務以提供更佳體驗，造成不便敬請見諒。"}),t.jsx("p",{className:"mb-4 whitespace-pre-wrap text-sm sm:text-base",children:p.maintenance_message||"維護作業進行中。"}),p.maintenance_until&&t.jsxs("p",{className:"text-sm text-muted mb-4 sm:mb-6",children:["預計完成：",p.maintenance_until]}),t.jsx(Yh,{})]})]});const ae=Y=>{if(!Y)return{text:""};const Z=/(^(?:\d{4}-\d{2}-\d{2}|\d{4}\/\d{1,2}\/\d{1,2}|\d{1,2}\/\d{1,2}|\d{1,2}月\d{1,2}日))\s*[-：:·]?\s*/;let V=Y.trim(),$;const z=V.match(Z);z&&($=z[1]);let q=0;for(;Z.test(V)&&q++<10;)V=V.replace(Z,"");return{date:$,text:V.trim()}};return(p.mode==="development"||p.mode==="test"&&!Ks())&&u==="/"?t.jsxs("div",{className:"min-h-screen",children:[t.jsx(a,{}),t.jsx(Wb,{}),t.jsx("div",{className:"fixed top-4 right-4 z-50",children:t.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-2xl bg-surface/70 backdrop-blur border border-border shadow-sm",children:[t.jsx(Ro,{}),t.jsx("span",{className:"text-xs text-muted",children:"主題"})]})}),t.jsxs("div",{className:"flex flex-col items-center pt-12 sm:pt-16 md:pt-20 px-3 sm:px-4 pb-6 sm:pb-8",children:[t.jsxs("div",{className:"max-w-4xl w-full space-y-4 sm:space-y-6 md:space-y-8",children:[t.jsx("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 md:p-8 shadow-soft",children:t.jsxs("div",{className:"text-center mb-4 sm:mb-6 md:mb-8",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold dual-text mb-2 sm:mb-3",children:"ForumKit"}),t.jsx("h2",{className:"text-base sm:text-lg text-fg mb-3 sm:mb-4",children:"校園匿名討論平台"}),t.jsx("p",{className:"leading-relaxed text-sm md:text-base text-fg px-2 sm:px-0",children:"ForumKit 是一個專為校園環境設計的現代化討論平台，提供安全、匿名且友善的交流空間。"})]})}),N?t.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-3 sm:p-4 md:p-6 shadow-soft",children:[t.jsx("h3",{className:"font-semibold dual-text mb-3 sm:mb-4",children:"顏色搭配器"}),t.jsx(Gh,{})]}),t.jsx(To,{room:"lobby",title:"聊天室",subtitle:"開發模式示範聊天室"}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-3 sm:p-4 md:p-6 shadow-soft right-col-spacing",children:[t.jsx("h3",{className:"font-semibold dual-text mb-3 sm:mb-4",children:"開發紀錄"}),t.jsx(mo,{title:"項目進度",min:200,max:720,initial:200,storageKey:"fk-progress-height-mobile",children:k?t.jsx("div",{className:"py-8 text-center text-fg",children:"載入中..."}):E?.error?t.jsxs("div",{className:"text-center py-8 text-rose-600",children:["載入失敗：",E.error]}):t.jsx("div",{className:"space-y-2 sm:space-y-3",children:E?.progress_items?.map((Y,Z)=>t.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-3 rounded-xl border border-border bg-surface",children:[t.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[t.jsx("h5",{className:"font-medium dual-text text-sm sm:text-base truncate",children:Y.name}),Y.description&&t.jsx("p",{className:"text-xs text-muted line-clamp-2 sm:line-clamp-none",children:Y.description})]}),t.jsx("span",{className:"px-2 py-1 text-xs rounded-lg bg-neutral-100 text-neutral-700 dark:bg-neutral-900/30 dark:text-neutral-300 whitespace-nowrap",children:Y.status==="completed"?"完成":Y.status==="in_progress"?"開發中":"規劃中"})]},Z))})}),t.jsx(mo,{title:"更新紀錄",min:200,max:720,initial:200,storageKey:"fk-updates-height-mobile",className:"mt-3 sm:mt-4",children:k?t.jsx("div",{className:"py-8 text-center text-fg",children:"載入中..."}):E?.recent_updates&&E.recent_updates.length>0?t.jsx("div",{className:"space-y-1.5 sm:space-y-2",children:E.recent_updates.map((Y,Z)=>{const{date:V,text:$}=ae(Y);return t.jsx("div",{className:"p-2 rounded-lg bg-neutral-50 dark:bg-neutral-800/50 border border-border",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"px-2 py-0.5 rounded-md bg-neutral-200/70 dark:bg-neutral-700 text-xs text-neutral-700 dark:text-neutral-200 shrink-0 whitespace-nowrap",children:V||"未標記日期"}),t.jsx("span",{className:"text-xs text-fg leading-relaxed min-w-0 break-words",children:$})]})},Z)})}):t.jsx("div",{className:"p-4 text-center text-muted text-sm",children:"暫無更新記錄"})})]})]}):t.jsxs("div",{className:"flex h-[740px] md:h-[780px] lg:h-[820px] bg-surface border border-border rounded-2xl overflow-hidden shadow-soft relative isolate",children:[t.jsx("div",{className:"w-[400px] flex-shrink-0",children:t.jsxs("div",{className:"h-full min-h-[740px] p-4 md:p-6 overflow-y-auto",children:[t.jsx("h3",{className:"font-semibold dual-text mb-4",children:"顏色搭配器"}),t.jsx(Gh,{})]})}),t.jsxs("div",{className:"flex-1 h-full p-4 md:p-6 overflow-hidden flex flex-col right-col-spacing min-h-0",children:[t.jsx("h3",{className:"font-semibold dual-text mb-4",children:"開發紀錄"}),t.jsxs("div",{className:"flex-1 flex flex-col space-y-4 min-h-0",children:[t.jsx(mo,{title:"項目進度",min:350,max:700,initial:350,storageKey:"fk-progress-height-desktop",children:k?t.jsx("div",{className:"py-8 text-center text-fg",children:"載入中..."}):E?.error?t.jsxs("div",{className:"text-center py-8 text-rose-600",children:["載入失敗：",E.error]}):t.jsx("div",{className:"space-y-3",children:E?.progress_items?.map((Y,Z)=>t.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-border bg-surface/50 shadow-sm",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("h5",{className:"font-medium dual-text",children:Y.name}),Y.description&&t.jsx("p",{className:"text-xs text-muted",children:Y.description})]}),t.jsx("span",{className:"px-2 py-1 text-xs rounded-lg bg-neutral-100 text-neutral-700 dark:bg-neutral-900/30 dark:text-neutral-300 whitespace-nowrap",children:Y.status==="completed"?"完成":Y.status==="in_progress"?"開發中":"規劃中"})]},Z))})}),t.jsx(mo,{title:"更新紀錄",min:350,max:700,initial:350,storageKey:"fk-updates-height-desktop",children:k?t.jsx("div",{className:"py-8 text-center text-fg",children:"載入中..."}):E?.recent_updates&&E.recent_updates.length>0?t.jsx("div",{className:"space-y-2",children:E.recent_updates.map((Y,Z)=>{const{date:V,text:$}=ae(Y);return t.jsx("div",{className:"p-2 rounded-lg bg-surface/30 border border-border/50",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"px-2 py-0.5 rounded-md bg-neutral-200/70 dark:bg-neutral-700 text-xs text-neutral-700 dark:text-neutral-200 shrink-0 whitespace-nowrap",children:V||"未標記日期"}),t.jsx("span",{className:"text-xs text-fg min-w-0 break-words leading-relaxed",children:$})]})},Z)})}):t.jsx("div",{className:"p-4 text-center text-muted text-sm",children:"暫無更新記錄"})})]})]})]}),!N&&t.jsx("div",{className:"mt-4 bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft",children:t.jsx(To,{room:"lobby",title:"聊天室",subtitle:"開發模式示範聊天室"})}),t.jsxs("div",{id:"feedback",className:"bg-surface border border-border rounded-2xl p-3 sm:p-4 md:p-6 shadow-soft relative z-[5]",children:[t.jsx("h3",{className:"font-semibold dual-text mb-3 sm:mb-4",children:"意見回饋"}),t.jsx(Yh,{compact:!0})]})]}),t.jsx(d,{onNewPost:J})]})]}):N?t.jsxs("div",{className:"min-h-screen flex flex-col",children:[t.jsxs("header",{className:"sticky top-0 z-30 bg-surface/95 backdrop-blur border-b border-border px-4 py-3",children:[t.jsx("h1",{className:"font-semibold text-lg text-fg",children:"ForumKit"}),t.jsx("p",{className:"text-sm text-muted",children:"校園匿名討論平台"})]}),t.jsx("div",{className:"flex-1",children:t.jsx(jp,{injectedItems:w})}),t.jsx(Ed,{}),t.jsx(d,{onNewPost:J})]}):t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:u}),t.jsxs("main",{className:"mx-auto max-w-5xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28",children:[t.jsxs("section",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4 sm:mb-6",children:[t.jsx("div",{className:"flex items-center justify-between gap-3 sm:gap-4 mb-4",children:t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"ForumKit"})}),t.jsx(Fb,{onCreated:J})]}),t.jsxs("section",{className:"bg-surface/90 border border-border rounded-2xl p-3 sm:p-4 md:p-6 shadow-soft",children:[t.jsx("h2",{className:"font-semibold dual-text mb-3",children:"最新貼文"}),t.jsx(Np,{injectedItems:w})]}),t.jsx("div",{className:"mt-4",children:t.jsx(A,{})})]}),t.jsx(d,{onNewPost:J})]})}function Yh({compact:s}){const[a,l]=h.useState(""),[i,d]=h.useState("一般回報"),[u,f]=h.useState(""),[p,x]=h.useState(!1),[g,v]=h.useState(""),[b,j]=h.useState("success"),[R,M]=h.useState("已送出"),[E,S]=h.useState("已傳送至開發團隊"),k=s?3:5,C=async()=>{if(u.trim().length<5){alert("請至少填寫 5 個字的說明，謝謝！");return}x(!0),v("");try{const N=await fetch("/api/report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contact:a,category:i,message:u})}),O=await N.json().catch(()=>({})),B=N.headers.get("X-ForumKit-Ticket")||O?.ticket_id||N.headers.get("X-Request-ID")||"",w=!!O?.ok&&N.ok,I=O?.delivery;if(w&&I==="discord"?(j("success"),M("已送出"),S("已傳送至開發團隊")):w?(j("warn"),M("已暫存"),S("尚未確認傳送，請保留單號")):(j("error"),M("送出失敗"),S("請稍後重試或回報")),v(B),B){const A="forumkit_recent_tickets",J=Date.now(),ae=JSON.parse(localStorage.getItem(A)||"[]");ae.unshift({id:B,kind:"report",ts:J,note:i}),localStorage.setItem(A,JSON.stringify(ae.slice(0,10)))}w&&f("")}catch{v(""),j("error"),M("送出失敗"),S("請檢查網路後再試")}finally{x(!1)}};return t.jsx("div",{className:"text-left",children:t.jsxs("div",{className:"grid gap-3",children:[t.jsxs("div",{className:"grid gap-2 grid-cols-1 sm:grid-cols-2",children:[t.jsx("input",{type:"text",placeholder:"你的聯絡方式（DC ID 或 Email，可留空）",value:a,onChange:N=>l(N.target.value),className:"form-control text-sm sm:text-base"}),t.jsxs("select",{value:i,onChange:N=>d(N.target.value),className:"form-control text-sm sm:text-base",children:[t.jsx("option",{children:"一般回報"}),t.jsx("option",{children:"無法載入"}),t.jsx("option",{children:"帳號/登入"}),t.jsx("option",{children:"安全性"}),t.jsx("option",{children:"建議改善"})]})]}),t.jsx("textarea",{placeholder:"請描述你遇到的情況（盡量提供操作步驟與時間點）",value:u,onChange:N=>f(N.target.value),rows:k,className:"form-control text-sm sm:text-base"}),t.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:t.jsx("button",{onClick:C,disabled:p,className:"px-4 py-2 rounded-xl border dual-btn disabled:opacity-50 text-sm sm:text-base",children:p?"送出中...":"送出回報"})}),g&&t.jsx("div",{className:`mt-3 rounded-xl border px-4 py-3 ${b==="success"?"bg-success-bg text-success-text border-success-border":b==="warn"?"bg-warning-bg text-warning-text border-warning-border":"bg-danger-bg text-danger-text border-danger-border"}`,children:t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold",children:R}),t.jsx("div",{className:"text-sm opacity-90",children:E}),t.jsxs("div",{className:"mt-1 text-sm",children:[t.jsx("span",{className:"opacity-70",children:"處理單號："}),t.jsx("code",{className:"px-1.5 py-0.5 rounded bg-black/5 dark:bg-white/10",children:g})]}),t.jsx("div",{className:"mt-1 text-xs opacity-70",children:"請保留此單號以便後續查詢或接收通知。"})]}),t.jsx("button",{onClick:()=>{navigator.clipboard.writeText(g)},className:"shrink-0 rounded-lg border px-3 py-1.5 text-sm hover:bg-black/5 dark:hover:bg-white/10","aria-label":"複製單號",children:"複製"})]})})]})})}function Gh(){const[s,a]=h.useState("#F8F5EE"),[l,i]=h.useState(null),[d,u]=h.useState(""),[f,p]=h.useState(""),[x,g]=h.useState(!1),[v,b]=h.useState(null),j=async()=>{if(!d.trim()){alert("請為您的主題命名！");return}g(!0),b(null);try{const I=await fetch("/api/color_vote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:d,description:f,colors:{primary:s}})}),A=await I.json().catch(()=>({})),J=I.headers.get("X-ForumKit-Ticket")||A?.ticket_id||I.headers.get("X-Request-ID")||"",ae=!!A?.ok&&I.ok,Y=A?.delivery;if(b(ae&&Y==="discord"?`感謝！已送至 Discord。處理單號：${J}`:ae?`已送出（本機記錄）。處理單號：${J}`:"提交失敗，請稍後重試"),J){const Z="forumkit_recent_tickets",V=Date.now(),$=JSON.parse(localStorage.getItem(Z)||"[]");$.unshift({id:J,kind:"color",ts:V,note:d}),localStorage.setItem(Z,JSON.stringify($.slice(0,10)))}I.ok&&(u(""),p(""))}catch{b("提交失敗，請稍後重試")}finally{g(!1)}},R=w=>Math.max(0,Math.min(255,Math.round(w))).toString(16).padStart(2,"0").toUpperCase(),M=w=>{const I=w.replace(/[^0-9A-Fa-f]/g,"");if(I.length===3){const A=parseInt(I[0]+I[0],16),J=parseInt(I[1]+I[1],16),ae=parseInt(I[2]+I[2],16);return{r:A,g:J,b:ae}}if(I.length===6){const A=parseInt(I.slice(0,2),16),J=parseInt(I.slice(2,4),16),ae=parseInt(I.slice(4,6),16);return{r:A,g:J,b:ae}}return null},E=(w,I,A)=>`#${R(w)}${R(I)}${R(A)}`,S=(w,I=.75)=>{const A=M(w);if(!A)return w;const J=A.r+(255-A.r)*I,ae=A.g+(255-A.g)*I,Y=A.b+(255-A.b)*I;return E(J,ae,Y)},k=(w,I=.2)=>{const A=M(w);if(!A)return w;const J=A.r*(1-I),ae=A.g*(1-I),Y=A.b*(1-I);return E(J,ae,Y)},C=w=>{const A=(w||"").trim().replace(/[^0-9A-Fa-f]/g,"");return A.length===3?{ok:!0,value:`#${A[0]}${A[0]}${A[1]}${A[1]}${A[2]}${A[2]}`.toUpperCase()}:A.length===6?{ok:!0,value:`#${A.toUpperCase()}`}:{ok:!1}},N=w=>{const I=C(w);I.ok?(i(null),a(I.value)):i("請輸入 #RRGGBB 或 RRGGBB/ABC")},O=w=>{const I=C(w);I.ok?(setSecondaryErr(null),setSecondaryColor(I.value)):setSecondaryErr("請輸入 #RRGGBB 或 RRGGBB/ABC")},B=()=>{if(!(l||secondaryErr))try{const w=document.documentElement;w.style.setProperty("--primary",s),w.style.setProperty("--primary-600",k(s,.25)),w.style.setProperty("--primary-100",S(s,.78)),w.style.setProperty("--primary-hover",k(s,.22)),w.style.setProperty("--border",secondaryColor),w.style.setProperty("--button-secondary",S(s,.86)),w.style.setProperty("--button-secondary-hover",S(s,.8))}catch{}};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-surface/50 rounded-xl p-4 border border-border",children:[t.jsx("h4",{className:"font-semibold dual-text mb-3",children:"主題預覽"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-20 rounded-xl flex items-center justify-center font-semibold border shadow-sm",style:{backgroundColor:s,borderColor:secondaryColor,color:textColor},children:"背景顏色 (主色)"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{className:"px-4 py-2 rounded-xl font-semibold shadow-sm",style:{backgroundColor:btnColor,color:colorType==="light"?"#FFFFFF":"#1F1F1F"},children:"按鈕樣式"}),t.jsx("div",{className:"px-4 py-2 rounded-xl font-semibold shadow-sm border",style:{backgroundColor:s,borderColor:secondaryColor,color:textColor},children:"框線樣式"})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"主色調 (背景顏色)"}),t.jsxs("div",{className:"flex gap-3 items-center",children:[t.jsx("input",{type:"color",value:s,onChange:w=>{i(null),a(w.target.value)},className:"w-10 h-10 rounded-lg cursor-pointer"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("input",{type:"text",value:s,onChange:w=>N(w.target.value),onBlur:w=>N(w.target.value),className:"form-control"}),l&&t.jsx("div",{className:"mt-1 text-xs text-rose-600",children:l})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"輔助色 (框線顏色)"}),t.jsxs("div",{className:"flex gap-3 items-center",children:[t.jsx("input",{type:"color",value:secondaryColor,onChange:w=>{setSecondaryErr(null),setSecondaryColor(w.target.value)},className:"w-10 h-10 rounded-lg cursor-pointer"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("input",{type:"text",value:secondaryColor,onChange:w=>O(w.target.value),onBlur:w=>O(w.target.value),className:"form-control"}),secondaryErr&&t.jsx("div",{className:"mt-1 text-xs text-rose-600",children:secondaryErr})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"深淺色類型"}),t.jsxs("div",{className:"px-3 py-2 rounded-xl border bg-surface/60 text-fg text-sm",children:["自動判斷：",colorType==="light"?"淺色主題 (黑字白按鈕)":"深色主題 (白字黑按鈕)"]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"主題名稱"}),t.jsx("input",{type:"text",value:d,onChange:w=>u(w.target.value),placeholder:"為您的主題命名...",className:"form-control"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"主題描述 (可選)"}),t.jsx("textarea",{value:f,onChange:w=>p(w.target.value),placeholder:"描述您的主題設計理念...",className:"form-control min-h-[80px]"})]})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[t.jsx("button",{onClick:j,disabled:x||!d.trim(),className:"px-4 py-2 rounded-xl border dual-btn disabled:opacity-50",children:x?"提交中...":"提交配色方案"}),t.jsx("button",{type:"button",onClick:B,className:"px-4 py-2 rounded-xl border hover:bg-surface/70",children:"一鍵套用到主題"}),v&&t.jsx("span",{className:"text-sm text-muted",children:v})]})]})}function Kb({platform:s,onUpdated:a,full:l}){const[i,d]=h.useState(s.mode),[u,f]=h.useState(s.maintenance_message||""),[p,x]=h.useState(s.maintenance_until||""),[g,v]=h.useState(!1),b=async()=>{try{v(!0);const R=await fetch("/api/mode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:i,...u&&u.trim()?{notice:u.trim()}:{},...p&&p.trim()?{eta:p.trim()}:{}})}),M=await R.json().catch(()=>({}));R.ok&&a(M),location.assign("/"),setTimeout(()=>{try{const E=location?.pathname;E&&E!=="/"&&location.assign("/")}catch(E){console.warn("[AdminModePanel] Failed to check pathname:",E)}},800)}finally{v(!1)}},j=t.jsxs("div",{className:"max-w-xl w-full bg-surface/80 border border-border rounded-2xl p-4 sm:p-6 shadow backdrop-blur mt-8 sm:mt-10",children:[t.jsx("h2",{className:"font-semibold text-lg sm:text-xl mb-4",children:"平台模式管理"}),t.jsx("div",{className:"flex gap-2 sm:gap-4 flex-wrap mb-4",children:["normal","maintenance","development","test"].map(R=>t.jsxs("label",{className:`px-3 py-2 rounded-xl border cursor-pointer text-sm sm:text-base ${i===R?"dual-btn ring-2 ring-primary/50":"bg-surface/60 hover:bg-surface/80 border-border"}`,children:[t.jsx("input",{type:"radio",name:"mode",value:R,className:"hidden",checked:i===R,onChange:()=>d(R)}),R]},R))}),i==="maintenance"&&t.jsxs("div",{className:"space-y-3 mb-4",children:[t.jsx("textarea",{value:u,onChange:R=>f(R.target.value),placeholder:"維護訊息",className:"form-control min-h-[80px] text-sm sm:text-base"}),t.jsx("input",{value:p,onChange:R=>x(R.target.value),placeholder:"預計完成時間 (ISO 或描述)",className:"form-control text-sm sm:text-base"})]}),t.jsx("button",{onClick:b,disabled:g,className:"px-4 py-2 rounded-xl border dual-btn disabled:opacity-50 text-sm sm:text-base",children:g?"儲存中...":"儲存"}),t.jsx("p",{className:"text-xs text-muted mt-4",children:"尚未加入權限驗證（後續需登入才可操作）。"})]});return l?t.jsx("div",{className:"min-h-screen flex flex-col items-center pt-20 sm:pt-24 md:pt-32 px-3 sm:px-4",children:j}):t.jsx("div",{className:"mt-10",children:j})}const Qb={},Zh=Qb?.VITE_API_BASE_URL||"",Sr=s=>Zh?Zh.replace(/\/?$/,"")+(s.startsWith("/")?s:`/${s}`):s;function Xb(){let s=localStorage.getItem("client_id");if(!s){s="c_"+Math.random().toString(16).slice(2)+Date.now().toString(16);try{localStorage.setItem("client_id",s)}catch{}}return s}function ef(){try{const s=localStorage.getItem("selected_school_slug");return s&&s.trim()?s.trim():null}catch{return null}}async function xs(s,a){const l=async u=>fetch(Sr(s),{...a,headers:{"Content-Type":"application/json",...a?.headers||{},"X-Client-Id":Xb(),...ef()?{"X-School-Slug":ef()}:{},...u?{Authorization:`Bearer ${u}`}:{}}});let i=localStorage.getItem("token")||void 0,d=await l(i);if(d.status===401)try{const u=await d.clone().text();let f={};try{f=u?JSON.parse(u):{}}catch{f={raw:u}}const p=f?.error?.code||f?.code,x=localStorage.getItem("refresh_token")||void 0;if(x&&(p==="JWT_EXPIRED"||p==="JWT_INVALID"||p==="JWT_MISSING")){const g=await fetch(Sr("/api/auth/refresh"),{method:"POST",headers:{Authorization:`Bearer ${x}`}});if(g.ok){const v=await g.json();v?.access_token&&(localStorage.setItem("token",v.access_token),i=v.access_token,d=await l(i))}else{try{Ga()}catch{}const v=location?.pathname;v&&!v.startsWith("/auth")&&(location.href="/auth")}}}catch{}if(!d.ok){const u=await d.text().catch(()=>"");try{const f=u?JSON.parse(u):{};if(d.status===401){const x=f?.error?.code||f?.code;if(x==="JWT_INVALID"||x==="JWT_MISSING"){try{Ga()}catch{}const g=location?.pathname;g&&!g.startsWith("/auth")&&(location.href="/auth")}}const p=Lo(d.status,f,u||`HTTP ${d.status}`);throw new Error(p)}catch{let f=u||`HTTP ${d.status}`;try{const p=f.match(/"msg"\s*:\s*"([\s\S]*?)"/);if(p&&p[1]){const x=JSON.parse(`"${p[1]}"`);throw new Error(x)}}catch{}try{const p=f.match(/"message"\s*:\s*"([\s\S]*?)"/);if(p&&p[1]){const x=JSON.parse(`"${p[1]}"`);throw new Error(x)}}catch{}throw new Error(f)}}return d.json()}const tf={login:s=>xs(Sr("/api/auth/login"),{method:"POST",body:JSON.stringify(s)}),register:s=>xs(Sr("/api/auth/register"),{method:"POST",body:JSON.stringify(s)})},Oc={get:()=>xs(Sr("/api/mode")),set:(s,a,l,i,d)=>xs(Sr("/api/mode"),{method:"POST",body:JSON.stringify({...s?{mode:s}:{},...a&&a.trim()?{notice:a.trim()}:{},...l&&l.trim()?{eta:l.trim()}:{},...i?{login_mode:i}:{},...d||{}})})},rf={get:()=>xs(Sr("/api/settings/content_rules")),set:s=>xs(Sr("/api/settings/content_rules"),{method:"POST",body:JSON.stringify(s)})},sf={changePassword:s=>xs(Sr("/api/auth/change_password"),{method:"POST",body:JSON.stringify(s)}),profile:()=>xs(Sr("/api/account/profile")),updateProfile:s=>xs(Sr("/api/account/profile"),{method:"PUT",body:JSON.stringify(s)}),uploadAvatar:async s=>{const a=new FormData;a.append("file",s);const l=await fetch(Sr("/api/account/avatar"),{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:a});if(!l.ok)throw new Error(await l.text());return l.json()}};function Yb(){const[s,a]=h.useState("login"),[l,i]=h.useState(!1),[d,u]=h.useState(""),f=en(),{login:p}=rr(),{pathname:x}=Ut();h.useEffect(()=>{const b=document.documentElement;b.getAttribute("data-theme")||b.setAttribute("data-theme","beige"),b.classList.add("theme-ready");try{const j=window.location.hash||"";if(j.startsWith("#")){const R=new URLSearchParams(j.slice(1)),M=R.get("access_token"),E=R.get("refresh_token"),S=R.get("role")||"user",k=R.get("school_id");if(M&&E){p(M,S,k?Number(k):null,E);try{const C=window?.location?.pathname||"/";history.replaceState(null,"",C)}catch(C){console.warn("[AuthPage] Failed to get pathname:",C),history.replaceState(null,"","/")}setTimeout(()=>{window.location.href="/"},10)}}}catch{}return()=>b.classList.remove("theme-ready")},[]);async function g(b){b.preventDefault(),i(!0),u("");const j=new FormData(b.target),R=M=>{const E=M&&typeof M=="object"&&typeof M.message=="string"?M.message:typeof M=="string"?M:M?.toString?.()??"登入失敗",S=String(E);try{const k=S?JSON.parse(S):{},C=k?.msg||k?.error?.message||k?.error||S;if(typeof C=="string")try{return JSON.parse(`"${C.replace(/"/g,'\\"')}"`)}catch{return C}return String(C)}catch{}try{const k=S.match(/"msg"\s*:\s*"([\s\S]*?)"/);if(k&&k[1])try{return JSON.parse(`"${k[1].replace(/"/g,'\\"')}"`)}catch{return k[1]}}catch{}try{const k=S.match(/"message"\s*:\s*"([\s\S]*?)"/);if(k&&k[1])try{return JSON.parse(`"${k[1].replace(/"/g,'\\"')}"`)}catch{return k[1]}}catch{}return S||"登入失敗"};try{const M=await tf.login({username:String(j.get("username")||""),password:String(j.get("password")||"")});p(M.access_token,M.role,M.school_id,M.refresh_token,String(j.get("username")||"")),f("/")}catch(M){u(R(M))}finally{i(!1)}}async function v(b){b.preventDefault(),i(!0),u("");const j=new FormData(b.target);try{await tf.register({username:String(j.get("username")||""),email:String(j.get("email")||""),password:String(j.get("password")||""),...String(j.get("school_slug")||"")?{school_slug:String(j.get("school_slug")||"")}:{}}),a("login")}catch(R){u((E=>{const S=E&&typeof E=="object"&&typeof E.message=="string"?E.message:typeof E=="string"?E:E?.toString?.()??"註冊失敗",k=String(S);try{const C=k?JSON.parse(k):{},N=C?.msg||C?.error?.message||C?.error||k;if(typeof N=="string")try{return JSON.parse(`"${N.replace(/"/g,'\\"')}"`)}catch{return N}return String(N)}catch{}try{const C=k.match(/"msg"\s*:\s*"([\s\S]*?)"/);if(C&&C[1])try{return JSON.parse(`"${C[1].replace(/"/g,'\\"')}"`)}catch{return C[1]}}catch{}try{const C=k.match(/"message"\s*:\s*"([\s\S]*?)"/);if(C&&C[1])try{return JSON.parse(`"${C[1].replace(/"/g,'\\"')}"`)}catch{return C[1]}}catch{}return k||"註冊失敗"})(R))}finally{i(!1)}}return t.jsxs("div",{className:"min-h-screen grid place-items-center",children:[t.jsx(Ge,{pathname:x}),t.jsxs("div",{className:"w-full max-w-md p-6 md:p-8 bg-surface border border-border rounded-2xl shadow-soft backdrop-blur",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx("button",{className:`px-4 py-2 rounded-xl border transition-all ${s==="login"?"dual-btn":"bg-surface hover:bg-surface/80 border-border"}`,onClick:()=>a("login"),children:"登入"}),t.jsx("button",{className:`px-4 py-2 rounded-xl border transition-all ${s==="register"?"dual-btn":"bg-surface hover:bg-surface/80 border-border"}`,onClick:()=>a("register"),children:"註冊"}),t.jsx("div",{className:"ml-auto text-sm text-muted",children:"ForumKit"})]}),d&&t.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-rose-100 text-rose-800 dark:bg-rose-900/30 dark:text-rose-100 border border-rose-300 dark:border-rose-700",children:[d,t.jsxs("div",{className:"mt-2 text-sm",children:["需要協助？",t.jsx("a",{href:"/support",className:"underline",children:"留言給管理員"})]})]}),s==="login"?t.jsxs("form",{onSubmit:g,className:"grid gap-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm text-muted",children:"帳號/Email"}),t.jsx("input",{name:"username",placeholder:"帳號/Email",className:"form-control",autoComplete:"username",required:!0})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm text-muted",children:"密碼"}),t.jsx("input",{name:"password",placeholder:"請輸入密碼",type:"password",className:"form-control",autoComplete:"current-password",required:!0})]}),t.jsx("button",{disabled:l,className:"px-4 py-3 rounded-xl dual-btn font-semibold disabled:opacity-60 transition-all",children:l?"登入中...":"登入"}),t.jsxs("div",{className:"relative my-3",children:[t.jsx("div",{className:"h-px bg-border"}),t.jsx("div",{className:"absolute inset-0 -top-2 flex justify-center",children:t.jsx("span",{className:"px-2 text-xs text-muted bg-surface",children:"或"})})]}),t.jsx("button",{type:"button",onClick:()=>{window.location.href="/api/auth/google/login"},className:"px-4 py-3 rounded-xl border border-border bg-surface hover:bg-surface/80",children:"使用 Google 校園帳號登入"}),t.jsx("button",{type:"button",disabled:!0,className:"px-4 py-3 rounded-xl border border-border bg-surface text-muted disabled:opacity-80",children:"使用 Blurizon 帳號登入（預留）"}),t.jsx("p",{className:"text-xs text-muted",children:"僅接受學校網域（.edu/.edu.tw 等）之 Google 帳號；一般 gmail.com 暫不開放。"})]}):t.jsxs("form",{onSubmit:v,className:"grid gap-4",children:[t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm text-muted",children:"使用者名稱"}),t.jsx("input",{name:"username",placeholder:"用於登入與顯示",className:"form-control",autoComplete:"username",required:!0})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm text-muted",children:"Email"}),t.jsx("input",{name:"email",placeholder:"example@school.edu",type:"email",className:"form-control",autoComplete:"email",required:!0})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm text-muted",children:"密碼"}),t.jsx("input",{name:"password",placeholder:"至少 8 碼",type:"password",className:"form-control",autoComplete:"new-password",required:!0})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx("label",{className:"text-sm text-muted",children:"校內綁定（選填）"}),t.jsx("input",{name:"school_slug",placeholder:"school-slug（校外留空）",className:"form-control"})]}),t.jsx("button",{disabled:l,className:"px-4 py-3 rounded-xl dual-btn font-semibold disabled:opacity-60 transition-all",children:l?"註冊中...":"註冊"}),t.jsx("p",{className:"text-xs text-muted",children:"註冊僅接受校園信箱（.edu/.edu.tw 等），gmail.com 不開放。"})]})]}),t.jsx(at,{})]})}const ho={normal:{name:"正常模式",description:"平台正常運行，所有功能可用",icon:mr,color:"text-success",bgColor:"bg-success-bg",textColor:"text-success-text"},development:{name:"開發模式",description:"開發者模式，顯示額外的調試資訊",icon:y0,color:"text-info",bgColor:"bg-info-bg",textColor:"text-info-text"},maintenance:{name:"維護模式",description:"系統維護中，部分功能受限",icon:ct,color:"text-warning",bgColor:"bg-warning-bg",textColor:"text-warning-text"},test:{name:"測試模式",description:"對外測試：管理員看正常頁，其他人看開發頁",icon:yd,color:"text-accent",bgColor:"bg-accent/10",textColor:"text-accent"}};function Gb(){const{isLoggedIn:s}=rr(),[a,l]=h.useState("normal"),[i,d]=h.useState(""),[u,f]=h.useState(""),[p,x]=h.useState("admin_only"),[g,v]=h.useState(!1),[b,j]=h.useState(""),[R,M]=h.useState("success"),[E,S]=h.useState(!0),[k,C]=h.useState(null),[N,O]=h.useState(!0),[B,w]=h.useState(15);h.useEffect(()=>{const V=document.documentElement;return V.getAttribute("data-theme")||V.setAttribute("data-theme","beige"),V.classList.add("theme-ready"),()=>V.classList.remove("theme-ready")},[]),h.useEffect(()=>{I(),ae()},[]),h.useEffect(()=>{const V=setInterval(ae,3e4);return()=>clearInterval(V)},[]);async function I(){try{const V=await Oc.get();l(V.mode),d(V.maintenance_message||""),f(V.maintenance_until||""),x(V.login_mode||"admin_only");try{const $=await rf.get();typeof $.enforce_min_post_chars=="boolean"&&O($.enforce_min_post_chars),typeof $.min_post_chars=="number"&&w($.min_post_chars)}catch{}}catch(V){Y(V.message||"載入模式失敗","error")}}async function A(){if(!Ks()){Y("權限不足：僅 dev_admin 可設定登入模式","error");return}if(!s){Y("請先登入後再設定登入模式","error");return}v(!0);try{const V=await Oc.set(void 0,void 0,void 0,p);Y(`登入模式已更新為：${p==="single"?"單一模式":p==="admin_only"?"管理組模式":"全開模式"}`,"success")}catch(V){console.error("Login mode save error:",V);let $="保存失敗";V.message.includes("401")||V.message.includes("Unauthorized")?$="認證失敗：請重新登入":V.message.includes("403")||V.message.includes("Forbidden")?$="權限不足：僅 dev_admin 可執行此操作":V.message&&($=V.message),Y($,"error")}finally{v(!1)}}async function J(V){if(!Ks()){Y("權限不足：僅 dev_admin 可切換模式","error");return}if(!s){Y("請先登入後再切換模式","error");return}const $=`確定要切換到「${ho[V].name}」嗎？`;if(window.confirm($)){v(!0);try{const z=await Oc.set(V,V==="maintenance"?i:void 0,V==="maintenance"?u:void 0);l(z.mode),Y(`已切換至${ho[V].name}`,"success"),setTimeout(I,500)}catch(z){console.error("Mode switch error:",z);let q="切換失敗";z.message.includes("401")||z.message.includes("Unauthorized")?q="認證失敗：請重新登入":z.message.includes("403")||z.message.includes("Forbidden")?q="權限不足：僅 dev_admin 可執行此操作":z.message&&(q=z.message),Y(q,"error")}finally{v(!1)}}}async function ae(){try{S(!0);const $=await(await fetch("/api/healthz",{cache:"no-store"})).json().catch(()=>({}));C($)}catch(V){C({ok:!1,error:String(V)})}finally{S(!1)}}function Y(V,$){j(V),M($),setTimeout(()=>j(""),3e3)}const Z=ho[a];return t.jsxs("div",{className:"min-h-screen min-h-dvh",children:[t.jsx(Ge,{pathname:"/mode"}),t.jsx(at,{}),t.jsxs("div",{className:"max-w-4xl mx-auto px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[t.jsx(c0,{className:"w-6 h-6 sm:w-8 sm:h-8 text-primary"}),t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold dual-text",children:"系統模式管理"})]}),t.jsx("p",{className:"text-muted",children:"管理平台運行模式和維護設定"})]}),t.jsxs("div",{className:`rounded-2xl border p-4 sm:p-6 mb-8 ${Z.bgColor} border-current`,children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"p-3 rounded-xl bg-white/50 dark:bg-black/20",children:t.jsx(Z.icon,{className:`w-6 h-6 ${Z.color}`})}),t.jsxs("div",{children:[t.jsxs("h2",{className:`text-lg sm:text-xl font-semibold ${Z.textColor}`,children:["目前模式：",Z.name]}),t.jsx("p",{className:`text-sm ${Z.textColor} opacity-80`,children:Z.description})]})]}),a==="maintenance"&&(i||u)&&t.jsxs("div",{className:`mt-4 p-4 rounded-xl ${Z.bgColor} border border-current/20`,children:[i&&t.jsxs("div",{className:"mb-2",children:[t.jsx("span",{className:`text-sm font-medium ${Z.textColor} opacity-80`,children:"維護公告："}),t.jsx("span",{className:`${Z.textColor}`,children:i})]}),u&&t.jsxs("div",{children:[t.jsx("span",{className:`text-sm font-medium ${Z.textColor} opacity-80`,children:"預計完成："}),t.jsx("span",{className:`${Z.textColor}`,children:u})]})]})]}),t.jsx("div",{className:"grid gap-4 md:grid-cols-2 mb-8",children:Object.entries(ho).map(([V,$])=>{const z=a===V,q=!Ks()||g;return t.jsxs("button",{onClick:()=>J(V),disabled:q,className:`
                  p-6 rounded-2xl border transition-all text-left
                  ${z?`${$.bgColor} border-current ring-2 ring-current/20`:"bg-surface border-border hover:border-primary/50 hover:shadow-md"}
                  ${q?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                `,children:[t.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[t.jsx("div",{className:`p-2 rounded-lg ${z?"bg-white/50 dark:bg-black/20":"bg-surface"}`,children:t.jsx($.icon,{className:`w-5 h-5 ${z?$.color:"text-muted"}`})}),t.jsx("h3",{className:`font-semibold ${z?$.textColor:"text-fg"}`,children:$.name}),z&&t.jsx("span",{className:`text-xs px-2 py-1 rounded-full bg-white/60 dark:bg-black/30 ${$.textColor}`,children:"目前"})]}),t.jsx("p",{className:`text-sm ${z?`${$.textColor} opacity-80`:"text-muted"}`,children:$.description})]},V)})}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 mb-8",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx(Wf,{className:"w-5 h-5 text-fg"}),t.jsx("h3",{className:"font-semibold text-fg",children:"登入模式設定"})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[t.jsxs("button",{onClick:()=>{x("single"),setTimeout(A,100)},disabled:g,className:`
                p-4 rounded-xl border transition-all text-left
                ${p==="single"?"bg-danger-bg border-danger-border ring-2 ring-danger-border/20":"bg-surface border-border hover:border-danger-border/50 hover:shadow-md"}
                ${g?"opacity-50 cursor-not-allowed":"cursor-pointer"}
              `,children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:`p-2 rounded-lg ${p==="single"?"bg-surface-hover":"bg-surface"}`,children:t.jsx(ct,{className:`w-4 h-4 ${p==="single"?"text-danger":"text-muted"}`})}),t.jsx("h4",{className:`font-medium ${p==="single"?"text-danger-text":"text-fg"}`,children:"單一模式"}),p==="single"&&t.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-danger-bg text-danger-text border border-danger-border",children:"目前"})]}),t.jsx("p",{className:`text-sm ${p==="single"?"text-danger-text":"text-muted"}`,children:"僅允許指定帳號登入"})]}),t.jsxs("button",{onClick:()=>{x("admin_only"),setTimeout(A,100)},disabled:g,className:`
                p-4 rounded-xl border transition-all text-left
                ${p==="admin_only"?"bg-warning-bg border-warning-border ring-2 ring-warning-border/20":"bg-surface border-border hover:border-warning-border/50 hover:shadow-md"}
                ${g?"opacity-50 cursor-not-allowed":"cursor-pointer"}
              `,children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:`p-2 rounded-lg ${p==="admin_only"?"bg-surface-hover":"bg-surface"}`,children:t.jsx(Gn,{className:`w-4 h-4 ${p==="admin_only"?"text-warning":"text-muted"}`})}),t.jsx("h4",{className:`font-medium ${p==="admin_only"?"text-warning-text":"text-fg"}`,children:"管理組模式"}),p==="admin_only"&&t.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-warning-bg text-warning-text border border-warning-border",children:"目前"})]}),t.jsx("p",{className:`text-sm ${p==="admin_only"?"text-warning-text":"text-muted"}`,children:"僅允許管理員帳號登入"})]}),t.jsxs("button",{onClick:()=>{x("open"),setTimeout(A,100)},disabled:g,className:`
                p-4 rounded-xl border transition-all text-left
                ${p==="open"?"bg-success-bg border-success-border ring-2 ring-success-border/20":"bg-surface border-border hover:border-success-border/50 hover:shadow-md"}
                ${g?"opacity-50 cursor-not-allowed":"cursor-pointer"}
              `,children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:`p-2 rounded-lg ${p==="open"?"bg-surface-hover":"bg-surface"}`,children:t.jsx(mr,{className:`w-4 h-4 ${p==="open"?"text-success":"text-muted"}`})}),t.jsx("h4",{className:`font-medium ${p==="open"?"text-success-text":"text-fg"}`,children:"全開模式"}),p==="open"&&t.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-success-bg text-success-text border border-success-border",children:"目前"})]}),t.jsx("p",{className:`text-sm ${p==="open"?"text-success-text":"text-muted"}`,children:"允許所有用戶登入和註冊"})]})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"font-semibold text-fg",children:"系統健康檢查"}),t.jsxs("button",{onClick:ae,className:"px-3 py-1.5 text-sm rounded-lg border hover:bg-surface/80 flex items-center gap-2",children:[t.jsx(_t,{className:"w-4 h-4"})," 重新整理"]})]}),E?t.jsx("div",{className:"py-8 text-center text-muted",children:"檢查中..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:`rounded-xl border p-4 ${k?.ok?"bg-green-50 dark:bg-green-900/20 border-green-300/60":"bg-rose-50 dark:bg-rose-900/20 border-rose-300/60"}`,children:t.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[t.jsx(er,{className:`w-5 h-5 ${k?.ok?"text-green-600 dark:text-green-400":"text-rose-600 dark:text-rose-400"}`}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:"font-medium text-fg",children:["整體狀態：",k?.ok?"正常":"異常"]}),t.jsxs("div",{className:"text-xs text-muted break-all font-mono",children:["版本: ",k?.version||"-"," · 環境: ",k?.environment||"-"]}),t.jsxs("div",{className:"text-xs text-muted break-all font-mono",children:["運行時間: ",k?.uptime?Math.floor(k.uptime/3600)+"小時":"-"," · 重啟ID: ",k?.restart_id||"-"]})]})]})}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[t.jsxs("div",{className:"rounded-xl border border-border p-4",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx(Bf,{className:"w-5 h-5 text-fg"}),t.jsx("div",{className:"font-medium text-fg",children:"資料庫"}),t.jsx("span",{className:`ml-auto text-xs px-2 py-0.5 rounded ${k?.db?.ok?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-rose-100 text-rose-700 dark:bg-rose-900/20 dark:text-rose-300"}`,children:k?.db?.ok?"OK":"FAIL"})]}),t.jsxs("div",{className:"text-xs text-muted space-y-1 break-all font-mono",children:[t.jsxs("div",{children:["driver：",k?.db?.driver||"-"]}),t.jsxs("div",{children:["url：",k?.db?.url||"-"]}),k?.db?.error&&t.jsx("div",{className:"text-rose-600 dark:text-rose-400 break-all",children:k.db.error})]})]}),t.jsxs("div",{className:"rounded-xl border border-border p-4",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[k?.redis?.ok?t.jsx(Vc,{className:"w-5 h-5 text-fg"}):t.jsx(Hv,{className:"w-5 h-5 text-fg"}),t.jsx("div",{className:"font-medium text-fg",children:"Redis"}),t.jsx("span",{className:`ml-auto text-xs px-2 py-0.5 rounded ${k?.redis?.ok?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-rose-100 text-rose-700 dark:bg-rose-900/20 dark:text-rose-300"}`,children:k?.redis?.ok?"OK":"FAIL"})]}),t.jsxs("div",{className:"text-xs text-muted space-y-1 break-all font-mono",children:[t.jsxs("div",{children:["url：",k?.redis?.url||"-"]}),k?.redis?.error&&t.jsx("div",{className:"text-rose-600 dark:text-rose-400 break-all",children:k.redis.error})]})]}),t.jsxs("div",{className:"rounded-xl border border-border p-4",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx(Vc,{className:"w-5 h-5 text-fg"}),t.jsx("div",{className:"font-medium text-fg",children:"CDN"}),t.jsx("span",{className:`ml-auto text-xs px-2 py-0.5 rounded ${k?.cdn?.ok?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":"bg-rose-100 text-rose-700 dark:bg-rose-900/20 dark:text-rose-300"}`,children:k?.cdn?.status||(k?.cdn?.ok?"OK":"FAIL")})]}),t.jsxs("div",{className:"text-xs text-muted space-y-1 break-all font-mono",children:[t.jsxs("div",{children:["host：",k?.cdn?.host||"-"]}),t.jsxs("div",{children:["port：",k?.cdn?.port||"-"]}),k?.cdn?.tcp_ok!==void 0&&t.jsxs("div",{children:["TCP連線：",k.cdn.tcp_ok?"OK":"FAIL"]}),k?.cdn?.http_ok!==void 0&&t.jsxs("div",{children:["HTTP狀態：",k.cdn.http_ok?"OK":"FAIL"," (",k.cdn.http_status||"N/A",")"]}),k?.cdn?.file_test_ok!==void 0&&t.jsxs("div",{children:["檔案服務：",k.cdn.file_test_ok?"OK":"FAIL"]}),k?.cdn?.error&&t.jsx("div",{className:"text-rose-600 dark:text-rose-400 break-all",children:k.cdn.error})]})]})]})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 mb-8",children:[t.jsx("h3",{className:"font-semibold text-fg mb-4",children:"維護模式設定"}),t.jsxs("div",{className:"grid gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"維護公告"}),t.jsx("textarea",{value:i,onChange:V=>d(V.target.value),placeholder:"例：系統升級中，暫停服務約30分鐘，造成不便敬請見諒",className:"form-control w-full",rows:3}),t.jsx("p",{className:"text-xs text-muted mt-1",children:"如果留空，將顯示預設的維護訊息"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"預計完成時間"}),t.jsx("input",{type:"text",value:u,onChange:V=>f(V.target.value),placeholder:"例：2025-08-17 12:00 或 約2小時後",className:"form-control w-full"}),t.jsx("p",{className:"text-xs text-muted mt-1",children:"可選填預計維護完成的時間"})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-700 rounded-xl p-3",children:[t.jsx("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-100 mb-1",children:"快速設定"}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsx("button",{type:"button",onClick:()=>{d("系統升級中，預計30分鐘內完成，造成不便敬請見諒"),f("約30分鐘後")},className:"px-3 py-1 text-xs rounded-lg bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-100 hover:bg-blue-200 dark:hover:bg-blue-700 transition-colors",children:"升級維護"}),t.jsx("button",{type:"button",onClick:()=>{d("資料庫維護作業進行中，請稍候再試"),f("約1小時後")},className:"px-3 py-1 text-xs rounded-lg bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-100 hover:bg-blue-200 dark:hover:bg-blue-700 transition-colors",children:"資料庫維護"}),t.jsx("button",{type:"button",onClick:()=>{d("緊急維護中，請關注官方公告"),f("預計2小時內")},className:"px-3 py-1 text-xs rounded-lg bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-100 hover:bg-blue-200 dark:hover:bg-blue-700 transition-colors",children:"緊急維護"})]})]})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 mb-8",children:[t.jsx("h3",{className:"font-semibold text-fg mb-4",children:"發文內容規則"}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:N,onChange:V=>O(V.target.checked)}),"啟用最小字數限制"]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-muted mb-1",children:"最小字數"}),t.jsx("input",{type:"number",value:B,min:0,onChange:V=>w(Math.max(0,Number(V.target.value||0))),className:"form-control w-32"})]})]}),t.jsx("div",{className:"mt-4 flex justify-end",children:t.jsx("button",{onClick:async()=>{try{await rf.set({enforce_min_post_chars:N,min_post_chars:B}),Y("已保存發文內容規則","success")}catch(V){Y(V?.message||"保存失敗","error")}},className:"btn-primary px-4 py-2",children:"保存規則"})})]}),t.jsxs("div",{className:"space-y-4",children:[!s&&t.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ct,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-red-800 dark:text-red-100",children:"未登入"}),t.jsx("p",{className:"text-sm text-red-700 dark:text-red-200",children:"請先登入才能切換系統模式"})]})]})}),s&&!Ks()&&t.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-300 dark:border-amber-700 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ct,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-amber-800 dark:text-amber-100",children:"權限不足"}),t.jsxs("p",{className:"text-sm text-amber-700 dark:text-amber-200",children:["目前角色：",Et(),"，僅 dev_admin、campus_admin、cross_admin 可切換系統模式"]})]})]})}),s&&Ks()&&t.jsx("div",{className:"bg-success-bg border border-success-border rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(mr,{className:"w-5 h-5 text-success"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-success-text",children:"已授權"}),t.jsxs("p",{className:"text-sm text-success-text/80",children:["目前角色：",Et(),"，有權限切換系統模式"]})]})]})}),b&&t.jsx("div",{className:`rounded-xl p-4 ${R==="success"?"bg-success-bg border border-success-border text-success-text":"bg-danger-bg border border-danger-border text-danger-text"}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[R==="success"?t.jsx(mr,{className:"w-5 h-5 text-success"}):t.jsx(ct,{className:"w-5 h-5 text-danger"}),t.jsx("span",{className:"font-medium",children:b})]})})]})]})]})}function nf(){const{pathname:s}=Ut(),a=Et(),l=["admin","dev_admin","campus_admin","cross_admin"].includes(a),[i,d]=h.useState({}),[u,f]=h.useState(null),[p,x]=h.useState(null),[g,v]=h.useState(null),[b,j]=h.useState(!1),[R,M]=h.useState(null),[E,S]=h.useState(!0),[k,C]=h.useState(!1),[N,O]=h.useState(null),[B,w]=h.useState(document.documentElement.getAttribute("data-theme")||"beige"),[I,A]=h.useState({current_password:"",new_password:""});h.useEffect(()=>{const $=document.documentElement;return $.getAttribute("data-theme")||$.setAttribute("data-theme","beige"),$.classList.add("theme-ready"),()=>$.classList.remove("theme-ready")},[]),h.useEffect(()=>{J()},[]),h.useEffect(()=>{const $=()=>Y();return window.addEventListener("fk_school_changed",$),()=>window.removeEventListener("fk_school_changed",$)},[]);const J=async()=>{try{S(!0);const $=await sf.profile();f($),d({email:$.email,school_slug:$.school?.slug||"",notification_enabled:!0,theme_preference:B,language:"zh-TW"}),await Y()}catch{O("載入設定失敗")}finally{S(!1)}},ae=()=>(localStorage.getItem("school_slug")||"").trim(),Y=async()=>{try{const $=ae();if(!$){x(null),v(null),j(!1);return}const z=await fetch(`/api/schools/${encodeURIComponent($)}/settings`,{cache:"no-store"});if(!z.ok)throw new Error("學校設定載入失敗");const q=await z.json().catch(()=>({}));v(q?.school||null);try{const re=q?.data,ee=typeof re=="string"?JSON.parse(re||"{}"):re||{};x({announcement:ee.announcement||"",allow_anonymous:!!(ee.allow_anonymous??!0),min_post_chars:Number(ee.min_post_chars??15)})}catch{x({announcement:"",allow_anonymous:!0,min_post_chars:15})}const se=Et(),G=se==="dev_admin"||se==="campus_admin"&&u?.school?.slug===$;j(!!G)}catch{x(null),j(!1)}},Z=async()=>{try{C(!0),O(null),O("設定已儲存")}catch{O("儲存失敗")}finally{C(!1)}},V=async()=>{const $=ae();if(!(!$||!b||!p))try{C(!0),O(null);const z={announcement:p.announcement||"",allow_anonymous:!!p.allow_anonymous,min_post_chars:Math.max(1,Number(p.min_post_chars??15))},q=await fetch(`/api/schools/${encodeURIComponent($)}/settings`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify(z)});if(!q.ok)throw new Error(await q.text());O("學校設定已儲存")}catch(z){O(z?.message||"學校設定儲存失敗")}finally{C(!1)}};return jn()?E?t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:s}),t.jsx(at,{}),t.jsx("main",{className:"mx-auto max-w-4xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:t.jsx("div",{className:"bg-surface border border-border rounded-2xl p-8 text-center text-muted",children:"載入中..."})})]}):t.jsxs("div",{className:"min-h-screen min-h-dvh",children:[t.jsx(Ge,{pathname:s}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-4xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[l?t.jsx(Gn,{className:"w-5 h-5 sm:w-6 sm:h-6"}):t.jsx(zr,{className:"w-5 h-5 sm:w-6 sm:h-6"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:l?"管理設定":"個人設定"}),t.jsx("p",{className:"text-sm text-muted",children:"自訂您的使用體驗與偏好設定"})]})]}),t.jsxs("div",{className:"text-sm text-muted hidden sm:block",children:["角色：",a]})]}),N&&t.jsx("div",{className:`mt-3 p-2 rounded-lg text-sm border ${N.includes("失敗")?"bg-danger-bg text-danger-text border-danger-border":"bg-success-bg text-success-text border-success-border"}`,children:N})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-soft",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx(Qa,{className:"w-6 h-6 text-primary"}),t.jsx("h2",{className:"text-xl font-semibold dual-text",children:"學校設定"}),t.jsxs("div",{className:"ml-auto text-sm text-muted",children:["目前學校：",g?.name||"跨校（唯讀）"]})]}),!g&&t.jsxs("div",{className:"mb-4 p-3 rounded-lg border border-border bg-surface-hover text-sm text-muted flex items-center gap-2",children:[t.jsx(ct,{className:"w-4 h-4"}),"跨校視圖僅供檢視。請透過上方學校切換選擇特定學校以進行設定。"]}),g&&!b&&t.jsxs("div",{className:"mb-4 p-3 rounded-lg border bg-warning-bg border-warning-border text-sm text-warning-text flex items-center gap-2",children:[t.jsx(ct,{className:"w-4 h-4"}),"權限不足：您只能檢視此學校的設定，無法修改。"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"公告文字"}),t.jsx("textarea",{value:p?.announcement||"",onChange:$=>x(z=>({...z||{},announcement:$.target.value})),disabled:!b||!g,className:"w-full p-3 bg-surface-hover rounded-xl border border-border focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary min-h-[88px]",placeholder:g?"顯示於該校頁面（可留空）":"跨校視圖不可編輯"})]}),t.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-hover rounded-xl border border-border",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-fg",children:"允許匿名發文"}),t.jsx("div",{className:"text-sm text-muted",children:"限制該校是否允許匿名內容"})]}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",disabled:!b||!g,checked:!!p?.allow_anonymous,onChange:$=>x(z=>({...z||{},allow_anonymous:$.target.checked})),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"最小發文字數"}),t.jsx("input",{type:"number",disabled:!b||!g,value:Number(p?.min_post_chars??15),onChange:$=>x(z=>({...z||{},min_post_chars:Number($.target.value||15)})),className:"w-40 p-3 bg-surface-hover rounded-xl border border-border focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",min:1})]}),t.jsx("div",{className:"flex justify-end",children:t.jsxs("button",{onClick:V,disabled:!b||!g||k,className:"btn-primary flex items-center gap-2 px-6 py-3 whitespace-nowrap disabled:opacity-60",children:[t.jsx(Xa,{className:"w-4 h-4"}),"儲存學校設定"]})})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-soft",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx(zr,{className:"w-6 h-6 text-primary"}),t.jsx("h2",{className:"text-xl font-semibold dual-text",children:"帳號資訊"})]}),u&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-muted",children:"用戶名稱"}),t.jsx("div",{className:"p-4 bg-surface-hover rounded-xl border border-border",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-surface flex items-center justify-center flex-shrink-0",children:t.jsx(zr,{className:"w-5 h-5 text-fg"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium text-fg truncate",title:u.username,children:u.username}),u.auth_provider&&t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted",children:[t.jsx(Mh,{className:"w-3 h-3 text-fg"}),t.jsx("span",{children:"已驗證"})]})]}),t.jsx("button",{onClick:()=>{const $=prompt("請輸入新的用戶名稱",u.username);$&&$.trim()&&$!==u.username&&O("用戶名稱更新功能開發中")},className:"p-1 rounded hover:bg-surface transition-colors flex-shrink-0 ml-auto",title:"編輯用戶名稱",children:t.jsx(xd,{className:"w-4 h-4 text-fg"})})]})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-muted",children:"電子郵件"}),t.jsx("div",{className:"p-4 bg-surface-hover rounded-xl border border-border",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-surface flex items-center justify-center flex-shrink-0",children:t.jsx(Kf,{className:"w-5 h-5 text-fg"})}),t.jsx("div",{className:"text-fg break-all min-w-0 flex-1",children:u.email}),u.auth_provider==="google"&&t.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted flex-shrink-0",children:[t.jsx(Mh,{className:"w-3 h-3 text-fg"}),t.jsx("span",{children:"Gmail"})]})]})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-muted",children:"用戶角色"}),t.jsx("div",{className:"p-4 bg-surface-hover rounded-xl border border-border",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-surface flex items-center justify-center",children:t.jsx(Gn,{className:"w-5 h-5 text-fg"})}),t.jsx("div",{className:"text-fg",children:rl(u.role)})]})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-muted",children:"所屬學校"}),t.jsx("div",{className:"p-4 bg-surface-hover rounded-xl border border-border",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-surface flex items-center justify-center",children:t.jsx(Qa,{className:"w-5 h-5 text-fg"})}),t.jsx("div",{className:"text-fg",children:u.school?.name||"未設定"})]})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-soft",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx(Wc,{className:"w-6 h-6 text-primary"}),t.jsx("h2",{className:"text-xl font-semibold dual-text",children:"密碼設定"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"目前密碼"}),t.jsx("input",{type:"password",value:I.current_password,onChange:$=>A(z=>({...z,current_password:$.target.value})),className:"w-full p-3 bg-surface-hover rounded-xl border border-border focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",placeholder:"輸入目前密碼"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"新密碼"}),t.jsx("input",{type:"password",value:I.new_password,onChange:$=>A(z=>({...z,new_password:$.target.value})),className:"w-full p-3 bg-surface-hover rounded-xl border border-border focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",placeholder:"輸入新密碼"})]}),t.jsx("button",{onClick:async()=>{try{await sf.changePassword({current_password:I.current_password||void 0,new_password:I.new_password}),O("密碼已更新"),A({current_password:"",new_password:""})}catch($){O($?.message||"密碼更新失敗")}},className:"btn-primary px-6 py-3 text-sm w-full",children:"更新密碼"})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-soft",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx(Af,{className:"w-6 h-6 text-primary"}),t.jsx("h2",{className:"text-xl font-semibold dual-text",children:"通知設定"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-surface-hover rounded-xl border border-border",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-fg",children:"推播通知"}),t.jsx("div",{className:"text-sm text-muted",children:"接收新回覆和系統消息"})]}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:i.notification_enabled,onChange:$=>d(z=>({...z,notification_enabled:$.target.checked})),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary peer-checked:border-primary"})]})]}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{className:"flex justify-between p-3 bg-surface-hover rounded-lg",children:[t.jsx("span",{className:"text-muted",children:"認證方式"}),t.jsx("span",{className:"font-medium",children:u?.auth_provider||"本地帳號"})]}),t.jsxs("div",{className:"flex justify-between p-3 bg-surface-hover rounded-lg",children:[t.jsx("span",{className:"text-muted",children:"密碼設定"}),t.jsx("span",{className:"font-medium",children:u?.has_password?"已設定":"未設定"})]}),t.jsxs("div",{className:"flex justify-between p-3 bg-surface-hover rounded-lg",children:[t.jsx("span",{className:"text-muted",children:"註冊時間"}),t.jsx("span",{className:"font-medium",children:"未知"})]})]})]})]})]})]}),t.jsx("div",{className:"flex justify-end mt-6",children:t.jsxs("button",{onClick:Z,disabled:k,className:"btn-primary flex items-center gap-2 px-6 py-3 whitespace-nowrap",children:[t.jsx(Xa,{className:"w-4 h-4"}),k?"儲存中...":"儲存設定"]})})]})]}):t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/settings/profile"}),t.jsx(at,{}),t.jsx("main",{className:"mx-auto max-w-4xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 shadow-soft text-center",children:[t.jsx(Wc,{className:"w-12 h-12 mx-auto mb-4 text-muted"}),t.jsx("h1",{className:"text-xl font-semibold dual-text mb-2",children:"需要登入"}),t.jsx("p",{className:"text-muted",children:"請先登入才能查看和修改設定。"})]})})]})}function Zb(){const[s,a]=h.useState(!1),[l,i]=h.useState([]);return h.useEffect(()=>{const d=()=>{a(window.innerWidth<768)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]),s?t.jsxs("div",{className:"min-h-screen flex flex-col",children:[t.jsxs("header",{className:"sticky top-0 z-30 bg-surface/95 backdrop-blur border-b border-border px-4 py-3",children:[t.jsx("h1",{className:"font-semibold text-lg text-fg",children:"討論看板"}),t.jsx("p",{className:"text-sm text-muted",children:"校園匿名討論"})]}),t.jsx("div",{className:"flex-1",children:t.jsx(jp,{injectedItems:l})}),t.jsx(Ed,{})]}):t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/boards"}),t.jsxs("main",{className:"mx-auto max-w-5xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4",children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"看板"}),t.jsx("p",{className:"text-sm text-muted mt-1",children:"瀏覽已審核通過的貼文。依目前選擇的學校載入貼文。"})]}),t.jsx("div",{className:"bg-surface border border-border rounded-2xl p-3 sm:p-4 shadow-soft",children:t.jsx(Np,{injectedItems:l})})]})]})}function ej(){const[s,a]=h.useState(!0),[l,i]=h.useState(null),[d,u]=h.useState([]),[f,p]=h.useState([]),[x,g]=h.useState(null),[v,b]=h.useState(new Set),[j,R]=h.useState("posts"),[M,E]=h.useState(null),[S,k]=h.useState(""),[C,N]=h.useState(null),[O,B]=h.useState(null),[w,I]=h.useState(!1),[A,J]=h.useState(null),[ae,Y]=h.useState([]),[Z,V]=h.useState("all"),[$,z]=h.useState(null),[q,se]=h.useState(null),[G,re]=h.useState(""),[ee,T]=h.useState(!1),[K,fe]=h.useState(""),[ge,Re]=h.useState(""),[Ee,$e]=h.useState(""),[Ie,de]=h.useState(""),[be,De]=h.useState(""),[Ke,mt]=h.useState(""),[xt,ie]=h.useState([]),[He,sr]=h.useState({pending_posts:0,processed_today:0}),Zr=Et(),nr=({id:W,path:me,kind:Xe,url:Pt})=>{const[gt,Ur]=h.useState(null),[ts,hr]=h.useState(null),[rs,ss]=h.useState(null),sn=/\.(jpg|jpeg|png|webp|gif)$/i.test(me||"")||Xe==="image",Rr=/\.(mp4|webm|mov)$/i.test(me||"")||Xe==="video";if(h.useEffect(()=>{let ns=!0,lr=null;return(async()=>{if(Pt){console.log(`MediaPreview: Using provided URL for media ${W}:`,Pt),Ur(Pt);return}console.log(`MediaPreview: No provided URL, fetching media ${W} via authorized endpoint`);try{const Mt=await fetch(`/api/media/${W}/file`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(ss(Mt.status),console.log(`MediaPreview: Auth endpoint response for media ${W}:`,Mt.status,Mt.headers.get("Content-Type")),Mt.ok){if((Mt.headers.get("Content-Type")||"").includes("application/json")){const F=await Mt.text();throw console.log(`MediaPreview: JSON response for media ${W}:`,F),new Error(F||"服務回應非檔案")}const L=await Mt.blob();lr=URL.createObjectURL(L),ns&&(console.log(`MediaPreview: Created blob URL for media ${W}:`,lr),Ur(lr));return}throw new Error(`HTTP ${Mt.status}`)}catch(Mt){if(!ns)return;console.log(`MediaPreview: Auth endpoint failed for media ${W}, trying direct uploads:`,Mt.message);try{let Rt=(me||"").replace(/^\/+/,"");if(Rt.startsWith("public/")){Rt=Rt.replace(/^public\//,"");const L=`https://cdn.serelix.xyz/${Rt}?t=${Date.now()}`;console.log(`MediaPreview: Using direct CDN URL for media ${W}:`,L),Ur(L),hr(null);return}else if(!Rt.startsWith("pending/")){Rt=`pending/${Rt}`;const L=`https://cdn.serelix.xyz/${Rt}?t=${Date.now()}`;console.log(`MediaPreview: Using pending CDN URL for media ${W}:`,L),Ur(L),hr(null);return}}catch(Rt){console.log(`MediaPreview: All methods failed for media ${W}:`,Rt.message),hr(Mt?.message||Rt?.message||"載入失敗")}}})(),()=>{ns=!1,lr&&URL.revokeObjectURL(lr)}},[W,me,Pt]),ts)return t.jsxs("div",{className:"text-xs text-muted",children:["無法載入附件",rs?`（${rs}）`:"",t.jsx("div",{className:"mt-1 break-all opacity-80",children:String(ts).slice(0,180)})]});if(!gt)return t.jsx("div",{className:"h-24 grid place-items-center text-xs text-muted border border-border rounded",children:"載入中…"});const Lr=()=>{try{window.open(gt,"_blank")}catch{}};return sn?t.jsxs("div",{children:[t.jsx("img",{src:gt,alt:`media-${W}`,className:"max-h-64 rounded border border-border"}),t.jsx("div",{className:"mt-1",children:t.jsx("button",{onClick:Lr,className:"text-xs underline",children:"開新視窗預覽"})})]}):Rr?t.jsxs("div",{children:[t.jsx("video",{src:gt,controls:!0,className:"w-full max-h-64 rounded border border-border"}),t.jsx("div",{className:"mt-1",children:t.jsx("button",{onClick:Lr,className:"text-xs underline",children:"開新視窗預覽"})})]}):t.jsx("a",{href:gt,download:!0,className:"text-xs underline",children:"下載附件"})},ht=()=>{const W=new URLSearchParams;K&&W.append("q",K),ge&&W.append("client_id",ge),Ee&&W.append("ip",Ee),Ie&&W.append("start_date",Ie),be&&W.append("end_date",be),Ke&&W.append("school",Ke);const me=W.toString();return me?`?${me}`:""},Ht=async()=>{try{a(!0),i(null);const W=ht(),[me,Xe]=await Promise.all([Bt(`/api/moderation/queue${W}`),Bt("/api/schools")]),Pt=me.posts||me.items||[];u(Pt),ie(Xe.items||[]),sr(gt=>({...gt,pending_posts:Pt.length||0}));try{const gt=await Bt("/api/moderation/stats");sr(Ur=>({...Ur,processed_today:gt.processed_today||0}))}catch(gt){console.error("載入統計失敗:",gt)}}catch(W){W instanceof Cr?i(W.message):i("載入失敗")}finally{a(!1)}},Ct=async()=>{try{const W=await Bt("/api/moderation/logs"),me=W.logs||W.items||[];p(me)}catch(W){console.error("載入審核紀錄失敗:",W)}},Vt=async()=>{try{const W=Z!=="all"?`?status=${Z}`:"",me=await fetch(`/api/admin/delete-requests${W}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(!me.ok)throw new Error("載入失敗");const Xe=await me.json();Y(Xe.items||[])}catch(W){console.error("載入刪文請求失敗:",W)}},rn=async W=>{if(confirm("確定要批准這個刪文請求嗎？此操作不可撤銷。"))try{se(W);const me=await fetch(`/api/admin/delete-requests/${W}/approve`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({note:G.trim()||void 0})});if(!me.ok){const Xe=await me.json();throw new Error(Xe.error||"操作失敗")}await Vt(),re(""),z(null)}catch(me){alert(me.message||"操作失敗")}finally{se(null)}},ys=async W=>{if(confirm("確定要拒絕這個刪文請求嗎？"))try{se(W);const me=await fetch(`/api/admin/delete-requests/${W}/reject`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({note:G.trim()||void 0})});if(!me.ok){const Xe=await me.json();throw new Error(Xe.error||"操作失敗")}await Vt(),re(""),z(null)}catch(me){alert(me.message||"操作失敗")}finally{se(null)}},ar=async(W,me)=>{try{if(I(!0),me==="post"){const Xe=await Bt(`/api/moderation/post/${W}`);B(Xe)}else if(me==="media")try{const Pt=(await Bt(`/api/moderation/media/${W}`)).post_id;if(Pt){const gt=await Bt(`/api/moderation/post/${Pt}`);B(gt)}else B({type:"media",id:W})}catch{B({type:"media",id:W})}}catch(Xe){console.error("載入詳情失敗:",Xe),B(null)}finally{I(!1)}},At=async W=>{try{if(g(W),!(await fetch("/api/moderation/approve",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({type:"post",id:W,reason:""})})).ok)throw new Error("批准失敗");await Ht()}catch{i("批准失敗")}finally{g(null)}},es=async W=>{try{if(g(W),!(await fetch("/api/moderation/reject",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({type:"post",id:W,reason:S||"未符合社群規範"})})).ok)throw new Error("拒絕失敗");await Ht(),E(null),k("")}catch{i("拒絕失敗")}finally{g(null)}},vs=async W=>{try{if(g(W),!(await fetch("/api/moderation/reject",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({type:"media",id:W,reason:S||"未符合社群規範"})})).ok)throw new Error("拒絕失敗");await Ht(),E(null),k("")}catch{i("拒絕失敗")}finally{g(null)}};return h.useEffect(()=>{j==="posts"?Ht():j==="logs"?Ct():j==="delete_requests"&&Vt()},[j,K,ge,Ee,Ie,be,Ke,Z]),l?t.jsx(Ys,{title:"管理後台載入失敗",message:l}):t.jsxs("div",{className:"min-h-screen min-h-dvh bg-base",children:[t.jsx(Ge,{pathname:"/admin/moderation"}),t.jsx("div",{className:"container mx-auto px-4 py-6 max-w-7xl pt-20 sm:pt-24 md:pt-28",children:t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[t.jsx("h1",{className:"text-2xl font-bold text-fg",children:"管理後台"}),t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",children:[t.jsxs("span",{className:"text-sm text-muted",children:["身份：",rl(Zr)]}),t.jsxs("button",{onClick:()=>j==="posts"?Ht():j==="logs"?Ct():Vt(),className:"btn-secondary px-3 py-2 flex items-center gap-2",disabled:s,children:[t.jsx(_t,{className:`w-4 h-4 ${s?"animate-spin":""}`}),"刷新"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"bg-surface border border-border rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center",children:t.jsx(ta,{className:"w-6 h-6 text-amber-700"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-fg",children:He.pending_posts}),t.jsx("div",{className:"text-sm text-muted",children:"待審核貼文"})]})]})}),t.jsx("div",{className:"bg-surface border border-border rounded-xl p-6",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:t.jsx(mr,{className:"w-6 h-6 text-green-700"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-fg",children:He.processed_today}),t.jsx("div",{className:"text-sm text-muted",children:"今日已處理"})]})]})})]}),t.jsx("div",{className:"border-b border-border",children:t.jsxs("nav",{className:"flex space-x-8","aria-label":"頁籤",children:[t.jsxs("button",{onClick:()=>R("posts"),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${j==="posts"?"border-primary text-primary":"border-transparent text-muted hover:text-fg hover:border-border"}`,children:[t.jsx(hd,{className:"w-4 h-4 inline mr-2"}),"待審核貼文"]}),t.jsxs("button",{onClick:()=>R("logs"),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${j==="logs"?"border-primary text-primary":"border-transparent text-muted hover:text-fg hover:border-border"}`,children:[t.jsx($h,{className:"w-4 h-4 inline mr-2"}),"審核紀錄"]}),t.jsxs("button",{onClick:()=>R("delete_requests"),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${j==="delete_requests"?"border-primary text-primary":"border-transparent text-muted hover:text-fg hover:border-border"}`,children:[t.jsx(ps,{className:"w-4 h-4 inline mr-2"}),"刪文請求"]})]})}),t.jsxs("div",{className:"space-y-4",children:[j==="posts"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-medium text-fg",children:"篩選條件"}),t.jsxs("button",{onClick:()=>T(!ee),className:"text-sm text-primary hover:text-primary-dark",children:[t.jsx(fd,{className:"w-4 h-4 inline mr-1"}),ee?"隱藏":"顯示","篩選"]})]}),ee&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"關鍵字"}),t.jsx("input",{type:"text",value:K,onChange:W=>fe(W.target.value),placeholder:"搜尋內容...",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"用戶端 ID"}),t.jsx("input",{type:"text",value:ge,onChange:W=>Re(W.target.value),placeholder:"client_xxx",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"IP 地址"}),t.jsx("input",{type:"text",value:Ee,onChange:W=>$e(W.target.value),placeholder:"192.168.1.1",className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"開始日期"}),t.jsx("input",{type:"date",value:Ie,onChange:W=>de(W.target.value),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"結束日期"}),t.jsx("input",{type:"date",value:be,onChange:W=>De(W.target.value),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"學校"}),t.jsxs("select",{value:Ke,onChange:W=>mt(W.target.value),className:"w-full px-3 py-2 border border-border rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[t.jsx("option",{value:"",children:"全部學校"}),xt.map(W=>t.jsx("option",{value:W.slug,children:W.name},W.id))]})]})]})]}),t.jsx("div",{className:"space-y-4",children:s?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(_t,{className:"w-8 h-8 mx-auto mb-2 animate-spin opacity-50"}),t.jsx("p",{className:"text-muted",children:"載入中..."})]}):d.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(mr,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"text-muted",children:"目前沒有待審核的貼文"})]}):d.map(W=>t.jsx("div",{className:"bg-surface border border-border rounded-xl p-6 space-y-4",children:t.jsxs("div",{className:"flex items-start justify-between gap-3 flex-col sm:flex-row",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsxs("span",{className:"text-sm font-medium text-fg",children:["貼文 #",W.id]}),t.jsx("span",{className:"text-xs px-2 py-1 bg-primary/10 text-primary rounded-full",children:W.school_name||"跨校"})]}),t.jsxs("div",{className:"prose prose-sm max-w-none mb-3",children:[t.jsx("div",{className:"text-fg",dangerouslySetInnerHTML:{__html:W.excerpt||W.content||""}}),(W.excerpt||W.content||"").length>200&&t.jsx("button",{onClick:()=>J({id:W.id,content:W.content||""}),className:"text-primary hover:text-primary-dark text-sm mt-2 underline",children:"查看完整內容"})]}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted",children:[W.created_at&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(qa,{className:"w-3 h-3"}),new Date(W.created_at).toLocaleString("zh-TW")]}),W.client_id&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(zr,{className:"w-3 h-3"}),W.client_id]}),W.ip&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(gs,{className:"w-3 h-3"}),W.ip]})]}),W.media&&W.media.length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsxs("h4",{className:"text-sm font-medium mb-2",children:["媒體附件 (",W.media.length,")"]}),t.jsx("div",{className:"space-y-2",children:W.media.map((me,Xe)=>t.jsxs("div",{className:"bg-surface-hover p-2 rounded border",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:me.file_name}),t.jsx(nr,{id:me.id,path:me.path,kind:me.file_type,url:me.preview_url})]},Xe))})]})]}),t.jsxs("div",{className:"flex items-center gap-2 sm:ml-4 mt-2 sm:mt-0 flex-wrap",children:[t.jsxs("button",{onClick:()=>At(W.id),disabled:x===W.id,className:"btn-primary px-4 py-2 text-sm flex items-center gap-2",children:[t.jsx(mr,{className:"w-4 h-4"}),"批准"]}),t.jsxs("button",{onClick:()=>E({type:"post",id:W.id}),disabled:x===W.id,className:"btn-danger px-4 py-2 text-sm flex items-center gap-2",children:[t.jsx(bn,{className:"w-4 h-4"}),"拒絕"]})]})]})},W.id))})]}),j==="logs"&&t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-medium text-fg",children:"審核紀錄"}),t.jsxs("button",{onClick:Ct,className:"text-sm text-primary hover:text-primary-dark flex items-center gap-1",children:[t.jsx(_t,{className:"w-4 h-4"}),"刷新"]})]}),f.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx($h,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"text-muted",children:"目前沒有審核紀錄"})]}):t.jsx("div",{className:"space-y-3",children:f.map(W=>t.jsxs("div",{className:"border border-border rounded-xl p-4 bg-surface/50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${W.action==="approve"?"bg-success-bg text-success-text":"bg-danger-bg text-danger-text"}`,children:W.action==="approve"?"批准":"拒絕"}),t.jsxs("span",{className:"text-xs px-2 py-1 bg-muted/10 text-muted rounded",children:[W.target_type==="post"?"貼文":"媒體"," #",W.target_id]}),W.old_status&&W.new_status&&t.jsxs("span",{className:"text-xs text-muted",children:[W.old_status," → ",W.new_status]})]}),t.jsx("div",{className:"text-xs text-muted",children:new Date(W.created_at).toLocaleString("zh-TW")})]}),t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx(zr,{className:"w-4 h-4 text-muted"}),t.jsx("span",{className:"text-muted",children:"審核者："}),t.jsx("span",{className:"font-medium text-fg",children:W.moderator||`ID: ${W.moderator_id}`})]}),t.jsxs("button",{onClick:()=>{C?.id===W.id?(N(null),B(null)):(N(W),ar(W.target_id,W.target_type))},className:"text-xs text-primary hover:text-primary-dark flex items-center gap-1",children:[t.jsx(gs,{className:"w-3 h-3"}),C?.id===W.id?"隱藏詳情":"查看詳情"]})]}),W.reason&&t.jsxs("div",{className:"mb-2",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:"拒絕理由："}),t.jsx("div",{className:"text-sm text-fg bg-surface-hover p-2 rounded border",children:W.reason})]}),W.details&&t.jsxs("div",{className:"mb-2",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:"備註："}),t.jsx("div",{className:"text-sm text-fg bg-surface-hover p-2 rounded border",children:W.details})]}),C?.id===W.id&&t.jsx("div",{className:"mt-3 p-3 bg-surface-hover rounded-lg border",children:w?t.jsxs("div",{className:"flex items-center justify-center py-4",children:[t.jsx(_t,{className:"w-4 h-4 animate-spin mr-2"}),t.jsx("span",{className:"text-sm text-muted",children:"載入詳情中..."})]}):O?O.type==="media"?t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-medium mb-2",children:"媒體檔案詳情"}),t.jsxs("div",{className:"text-muted",children:["媒體 ID: ",O.id]}),t.jsx("div",{className:"text-muted",children:"詳情功能開發中..."})]}):t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium mb-2",children:"貼文內容："}),t.jsx("div",{className:"text-sm text-fg bg-surface p-2 rounded border max-h-32 overflow-y-auto",children:t.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:O.content||"無內容"}})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"作者："}),t.jsx("span",{className:"font-medium",children:O.author||"匿名"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"留言數："}),t.jsx("span",{className:"font-medium",children:O.comment_count||0})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"按讚數："}),t.jsx("span",{className:"font-medium",children:O.like_count||0})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-muted",children:"狀態："}),t.jsx("span",{className:"font-medium",children:O.status||"未知"})]})]}),O.media&&O.media.length>0&&t.jsxs("div",{children:[t.jsx("div",{className:"font-medium mb-2",children:"媒體檔案："}),t.jsx("div",{className:"space-y-2",children:O.media.map(me=>t.jsxs("div",{className:"bg-surface p-2 rounded border",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:me.file_name||me.path}),t.jsx(nr,{id:me.id,path:me.path,kind:me.file_type,url:me.preview_url})]},me.id))})]}),["dev_admin","campus_admin","cross_admin"].includes(Zr)&&O.status&&O.id&&t.jsxs("div",{className:"border-t pt-2 mt-2",children:[t.jsx("div",{className:"text-xs text-muted mb-2",children:"否決操作"}),O.status==="approved"?t.jsx("button",{onClick:async()=>{const me=prompt("請輸入否決原因:");if(me)try{await fetch("/api/moderation/override",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({type:"post",id:O.id,action:"reject",reason:me})}),await Ct(),N(null),B(null)}catch{alert("否決操作失敗")}},className:"btn-danger px-3 py-1.5 text-sm flex items-center gap-2",children:"否決核准（下架）"}):O.status==="rejected"?t.jsx("button",{onClick:async()=>{const me=prompt("請輸入否決原因:");if(me)try{await fetch("/api/moderation/override",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({type:"post",id:O.id,action:"approve",reason:me})}),await Ct(),N(null),B(null)}catch{alert("否決操作失敗")}},className:"btn-secondary px-3 py-1.5 text-sm flex items-center gap-2",children:"否決拒絕（恢復）"}):null]})]}):t.jsx("div",{className:"text-sm text-muted",children:"無法載入詳情"})})]},W.id))})]}),j==="delete_requests"&&t.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-medium text-fg",children:"刪文請求管理"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("select",{value:Z,onChange:W=>V(W.target.value),className:"form-control text-sm",children:[t.jsx("option",{value:"all",children:"全部"}),t.jsx("option",{value:"pending",children:"待審核"}),t.jsx("option",{value:"approved",children:"已批准"}),t.jsx("option",{value:"rejected",children:"已拒絕"})]}),t.jsx("button",{onClick:Vt,className:"px-3 py-1.5 text-sm rounded-xl border dual-btn",children:"重新整理"})]})]}),ae.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(ps,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"text-muted",children:"沒有刪文請求"})]}):t.jsx("div",{className:"space-y-4",children:ae.map(W=>t.jsxs("div",{className:"border border-border rounded-xl p-4 bg-surface/50",children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${W.status==="pending"?"bg-amber-100 text-amber-800":W.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:W.status==="pending"?"待審核":W.status==="approved"?"已批准":"已拒絕"}),t.jsxs("span",{className:"text-sm text-muted",children:["#",W.post_id]})]}),t.jsx("div",{className:"text-xs text-muted",children:new Date(W.created_at).toLocaleString()})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"刪文理由："}),t.jsx("div",{className:"text-sm text-fg bg-surface-hover p-2 rounded border",children:W.reason})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"貼文內容預覽："}),t.jsx("div",{className:"text-sm text-fg bg-surface-hover p-2 rounded border max-h-20 overflow-y-auto",children:W.post_content.length>200?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:W.post_content.substring(0,200)+"..."}}),t.jsx("button",{onClick:()=>{const me=document.createElement("div");me.className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",me.innerHTML=`
                                      <div class="bg-surface border border-border rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                                        <div class="flex items-center justify-between mb-4">
                                          <h3 class="text-lg font-semibold text-fg">完整貼文內容</h3>
                                          <button onclick="this.closest('.fixed').remove()" class="text-muted hover:text-fg">✕</button>
                                        </div>
                                        <div class="prose prose-sm max-w-none text-fg bg-surface-hover p-4 rounded border">
                                          ${W.post_content.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
                                        </div>
                                      </div>
                                    `,document.body.appendChild(me),me.addEventListener("click",Xe=>{Xe.target===me&&me.remove()})},className:"text-primary hover:text-primary-dark text-sm ml-2 underline",children:"查看完整內容"})]}):t.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:W.post_content}})})]}),W.media_files&&W.media_files.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"text-sm font-medium mb-1",children:["媒體檔案 (",W.media_files.length,")："]}),t.jsx("div",{className:"space-y-2",children:W.media_files.map(me=>t.jsxs("div",{className:"bg-surface-hover p-2 rounded border",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:me.file_name}),t.jsx(nr,{id:me.id,path:me.path,kind:me.file_type,url:me.preview_url})]},me.id))})]}),W.review_note&&t.jsxs("div",{className:"mb-3",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"審核備註："}),t.jsx("div",{className:"text-sm text-fg bg-surface-hover p-2 rounded border",children:W.review_note})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"text-xs text-muted",children:[t.jsxs("div",{children:["請求者IP: ",W.requester_ip||"未知"]}),W.reviewed_at&&t.jsxs("div",{children:["審核時間: ",new Date(W.reviewed_at).toLocaleString()]})]}),W.status==="pending"&&t.jsx("div",{className:"flex gap-2",children:t.jsx("button",{onClick:()=>z(W),className:"px-3 py-1.5 text-sm rounded-xl border dual-btn",children:"處理請求"})})]})]},W.id))})]})]})]})}),M&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold text-fg mb-4",children:M.type==="post"?"拒絕貼文":M.type==="media"?"拒絕媒體":"拒絕項目"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"請填寫拒絕理由（可選）："}),t.jsx("textarea",{value:S,onChange:W=>k(W.target.value),placeholder:"不符合社群規範...",className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none",rows:3}),t.jsxs("div",{className:"flex gap-3 justify-end mt-4",children:[t.jsx("button",{onClick:()=>{E(null),k("")},className:"btn-secondary px-4 py-2",children:"取消"}),t.jsx("button",{onClick:()=>{M.type==="post"?es(M.id):M.type==="media"&&vs(M.id)},className:"btn-danger px-4 py-2",children:"確認拒絕"})]})]})}),$&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-md",children:[t.jsx("h3",{className:"text-lg font-semibold text-fg mb-4",children:"處理刪文請求"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"請選擇操作並填寫備註（可選）："}),t.jsx("textarea",{value:G,onChange:W=>re(W.target.value),placeholder:"審核備註...",className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none",rows:3}),t.jsxs("div",{className:"flex gap-3 justify-end mt-4",children:[t.jsx("button",{onClick:()=>{z(null),re("")},className:"btn-secondary px-4 py-2",children:"取消"}),t.jsx("button",{onClick:()=>ys($.id),disabled:q===$.id,className:"btn-secondary px-4 py-2",children:q===$.id?"處理中...":"拒絕"}),t.jsx("button",{onClick:()=>rn($.id),disabled:q===$.id,className:"btn-danger px-4 py-2",children:q===$.id?"處理中...":"批准刪除"})]})]})}),A&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-fg",children:"貼文完整內容"}),t.jsx("button",{onClick:()=>J(null),className:"text-muted hover:text-fg",children:"✕"})]}),t.jsx("div",{className:"bg-surface-hover border border-border rounded-lg p-4",children:t.jsx("div",{className:"prose prose-sm max-w-none text-fg",dangerouslySetInnerHTML:{__html:A.content||""}})})]})}),t.jsx(at,{})]})}function tj(){const s=Et();h.useEffect(()=>{const l=document.documentElement;return l.getAttribute("data-theme")||l.setAttribute("data-theme","beige"),l.classList.add("theme-ready"),()=>l.classList.remove("theme-ready")},[]);const a=({to:l,title:i,desc:d,icon:u,disabled:f})=>t.jsxs(Er,{to:f?"#":l,className:`p-4 rounded-2xl border border-border bg-surface shadow-soft flex items-start gap-3 ${f?"opacity-60 pointer-events-none":"hover:bg-surface/80"}`,children:[t.jsx("div",{className:"p-2 rounded-xl bg-neutral-100 dark:bg-neutral-900 border border-border",children:t.jsx(u,{className:"w-5 h-5"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("div",{className:"font-semibold dual-text",children:i}),t.jsx("div",{className:"text-sm text-muted hidden sm:block",children:d}),t.jsxs("div",{className:"text-xs text-muted sm:hidden",children:[d.split("、")[0],"..."]})]})]});return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/admin"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-6xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[t.jsx(Js,{className:"w-5 h-5"}),t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"後台主控台"})]}),t.jsxs("div",{className:"text-sm text-muted",children:["角色：",rl(s)]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[t.jsx(a,{to:"/admin/moderation",title:"審核管理",desc:"查看待審、詳情預覽、批次核准/退件、日誌匯出",icon:m0}),t.jsx(a,{to:"/admin/comments",title:"留言監控",desc:"留言審核、統計分析、篩選搜尋與 CSV 匯出",icon:Dh}),t.jsx(a,{to:"/mode",title:"模式管理",desc:"維護/開發/測試/正常模式切換與規則設定",icon:yd,disabled:!Ks()}),t.jsx(a,{to:"/admin/users",title:"使用者管理",desc:"檢視與搜尋、重設密碼、角色指派",icon:gd}),t.jsx(a,{to:"/admin/schools",title:"學校管理",desc:"清單、新增、重新命名",icon:Qa}),t.jsx(a,{to:"/admin/integrations",title:"整合狀態",desc:"Webhook/Redis/心跳服務概況",icon:r0}),t.jsx(a,{to:"/admin/pages",title:"頁面內容（Markdown）",desc:"關於/版規 的維護與即時預覽",icon:Js}),t.jsx(a,{to:"/admin/support",title:"使用者回報/聯絡",desc:"查看最近的狀況回報、快速聯絡回覆",icon:Dh})]})]})]})}function rj(){const[s,a]=h.useState(!0),[l,i]=h.useState(null),[d,u]=h.useState([]),[f,p]=h.useState(null),[x,g]=h.useState(""),[v,b]=h.useState(!1),j=async()=>{try{a(!0),i(null);const S=await Bt("/api/admin/comments/my-violations");if(S.ok)u(S.items||[]);else throw new Error("載入失敗")}catch(S){S instanceof Cr?i(S.message):i("載入失敗")}finally{a(!1)}},R=S=>{p(S.id),g(S.content)},M=()=>{p(null),g("")},E=async()=>{if(!(!f||!x.trim()))try{if(b(!0),!(await fetch(`/api/admin/comments/${f}/resubmit`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({content:x.trim()})})).ok)throw new Error("提交失敗");await j(),p(null),g("")}catch{i("提交失敗")}finally{b(!1)}};return h.useEffect(()=>{j()},[]),l?t.jsx(Ys,{title:"載入失敗",message:l}):t.jsxs("div",{className:"min-h-screen bg-base",children:[t.jsx(Ge,{pathname:"/my-violations"}),t.jsx("div",{className:"container mx-auto px-4 py-6 max-w-4xl pt-20 sm:pt-24 md:pt-28",children:t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h1",{className:"text-2xl font-bold text-fg flex items-center gap-3",children:[t.jsx(ct,{className:"w-6 h-6 text-amber-500"}),"我的違規留言",t.jsxs("span",{className:"text-sm px-2 py-1 rounded-full bg-amber-100 text-amber-800",children:[d.length," 則留言"]})]}),t.jsxs("button",{onClick:j,className:"btn-secondary px-3 py-2 flex items-center gap-2",disabled:s,children:[t.jsx(_t,{className:`w-4 h-4 ${s?"animate-spin":""}`}),"刷新"]})]}),t.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(ct,{className:"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"text-sm text-amber-800",children:[t.jsx("p",{className:"font-medium mb-2",children:"違規留言處理說明："}),t.jsxs("ul",{className:"space-y-1",children:[t.jsx("li",{children:"• 您的留言因違反社群規範被標記為違規並自動下架"}),t.jsx("li",{children:"• 您可以修改留言內容後重新提交審核"}),t.jsx("li",{children:"• 重新提交的留言將進入待審核狀態"}),t.jsx("li",{children:"• 如果多次違規，您的帳號可能會受到限制"})]})]})]})}),t.jsx("div",{className:"space-y-4",children:s?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(_t,{className:"w-8 h-8 mx-auto mb-2 animate-spin opacity-50"}),t.jsx("p",{className:"text-muted",children:"載入中..."})]}):d.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(tr,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{className:"text-muted",children:"您目前沒有違規留言"})]}):t.jsx(t.Fragment,{children:d.map(S=>t.jsx("div",{className:"bg-surface border border-border rounded-xl p-6 space-y-4",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsxs("span",{className:"text-sm font-medium text-fg",children:["留言 #",S.id]}),t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"違規"})]}),f===S.id?t.jsxs("div",{className:"space-y-3",children:[t.jsx("textarea",{value:x,onChange:k=>g(k.target.value),placeholder:"修改留言內容...",className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none",rows:3}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:E,disabled:v||!x.trim(),className:"btn-primary px-4 py-2 text-sm",children:v?"提交中...":"提交修改"}),t.jsx("button",{onClick:M,disabled:v,className:"btn-secondary px-4 py-2 text-sm",children:"取消"})]})]}):t.jsx("div",{className:"prose prose-sm max-w-none mb-3",children:t.jsx("div",{className:"text-fg whitespace-pre-line",children:S.content})}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(gs,{className:"w-3 h-3"}),"貼文 #",S.post.id]}),S.created_at&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(qa,{className:"w-3 h-3"}),new Date(S.created_at).toLocaleString("zh-TW")]})]})]}),f!==S.id&&t.jsx("div",{className:"flex items-center gap-2 ml-4",children:t.jsxs("button",{onClick:()=>R(S),className:"btn-secondary px-4 py-2 text-sm flex items-center gap-2",children:[t.jsx(xd,{className:"w-4 h-4"}),"修改"]})})]})},S.id))})})]})}),t.jsx(at,{})]})}function sj(){const[s,a]=h.useState(""),[l,i]=h.useState([]),[d,u]=h.useState(!1),[f,p]=h.useState(null),[x,g]=h.useState(!1),[v,b]=h.useState({username:"",email:"",password:"",role:"user",school_slug:""}),[j,R]=h.useState(!1),[M,E]=h.useState(null),[S,k]=h.useState(null),[C,N]=h.useState({email:"",password:"",role:"user"});h.useEffect(()=>{const z=document.documentElement;return z.getAttribute("data-theme")||z.setAttribute("data-theme","beige"),z.classList.add("theme-ready"),()=>z.classList.remove("theme-ready")},[]);const O=[{value:"user",label:"一般用戶"},{value:"campus_moderator",label:"校內審核"},{value:"cross_moderator",label:"跨校審核"},{value:"campus_admin",label:"校內板主"},{value:"cross_admin",label:"跨校板主"},{value:"dev_admin",label:"開發人員"}],[B,w]=h.useState([{value:"",label:"無特定學校"},{value:"ncku",label:"國立成功大學"},{value:"ntu",label:"國立台灣大學"}]),I=async()=>{try{const z=await fetch("/api/schools");if(z.ok){const q=await z.json(),se=[{value:"",label:"無特定學校"},...q.items.map(G=>({value:G.slug,label:G.name}))];w(se)}}catch(z){console.error("Failed to load schools:",z)}};h.useEffect(()=>{I()},[]);const A=async()=>{try{u(!0),p(null);const z=await fetch(`/api/admin/users?query=${encodeURIComponent(s)}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(z.ok){const q=await z.json().catch(()=>({}));i(Array.isArray(q?.items)?q.items:[])}else i([])}catch(z){p(z?.message||"載入失敗")}finally{u(!1)}},J=async()=>{try{R(!0),E(null);const z=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify(v)});if(!z.ok)throw new Error(await z.text());E("帳號創建成功"),g(!1),b({username:"",email:"",password:"",role:"user",school_slug:""}),A()}catch(z){E(z?.message||"創建失敗")}finally{R(!1)}},ae=()=>{const z="ABCDEFGHJKMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789";let q="";for(let se=0;se<12;se++)q+=z.charAt(Math.floor(Math.random()*z.length));b({...v,password:q})},Y=async(z,q)=>{try{const se=await fetch(`/api/admin/users/${z}/school`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({school_slug:q||null})});if(!se.ok){const G=await se.json().catch(()=>({}));throw new Error(G.msg||"更新失敗")}E("學校綁定更新成功"),A()}catch(se){E(se.message||"更新失敗")}},Z=async(z,q)=>{try{const se=await fetch(`/api/admin/users/${z}/role`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({role:q})});if(!se.ok)throw new Error(await se.text());E("角色更新成功"),A()}catch(se){E(se?.message||"角色更新失敗")}},V=async(z,q)=>{try{const se=await fetch(`/api/admin/users/${z}/email`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({email:q})});if(!se.ok)throw new Error(await se.text());E("Email 更新成功"),A()}catch(se){E(se?.message||"Email 更新失敗")}},$=async z=>{if(confirm("確定要刪除此用戶嗎？此操作無法復原。"))try{const q=await fetch(`/api/admin/users/${z}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(!q.ok)throw new Error(await q.text());E("用戶刪除成功"),A()}catch(q){E(q?.message||"用戶刪除失敗")}};return h.useEffect(()=>{A()},[]),t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/admin/users"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-7xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-6",children:[t.jsx("div",{className:"flex items-center gap-3 mb-2",children:t.jsxs("button",{onClick:()=>window.history.back(),className:"flex items-center gap-2 text-muted hover:text-fg transition-colors",children:[t.jsx(Gr,{className:"w-4 h-4"}),"返回後台"]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"用戶管理"}),t.jsx("p",{className:"text-sm text-muted mt-1",children:"管理系統用戶帳號、角色和權限"})]}),t.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center gap-2 px-3 sm:px-4 py-2 whitespace-nowrap text-sm sm:text-base",children:[t.jsx(x0,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"新增用戶"}),t.jsx("span",{className:"sm:hidden",children:"新增"})]})]}),M&&t.jsx("div",{className:`mt-4 p-3 rounded-lg text-sm ${M.includes("失敗")?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"}`,children:M})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 shadow-soft mb-6",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[t.jsx("div",{className:"relative flex-1",children:t.jsx("input",{value:s,onChange:z=>a(z.target.value),placeholder:"搜尋用戶名或電子郵件",className:"w-full px-4 py-2 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})}),t.jsx("div",{className:"flex gap-2",children:t.jsxs("button",{onClick:A,disabled:d,className:"btn-secondary px-4 py-2 whitespace-nowrap flex items-center gap-2",children:[t.jsx(fd,{className:"w-4 h-4"}),d?"搜尋中...":"搜尋"]})})]}),f&&t.jsx("div",{className:"mt-3 p-2 rounded bg-red-50 border border-red-200",children:t.jsx("p",{className:"text-sm text-red-700",children:f})})]}),t.jsx("div",{className:"bg-surface border border-border rounded-2xl shadow-soft overflow-hidden",children:d?t.jsxs("div",{className:"p-8 text-center text-muted",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-3"}),"載入中..."]}):t.jsx("div",{className:"divide-y divide-border",children:l.length===0?t.jsxs("div",{className:"p-8 text-center text-muted",children:[t.jsx(gd,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),s?"找不到符合條件的用戶":"尚無用戶資料"]}):l.map(z=>t.jsx("div",{className:"p-4 hover:bg-surface-hover transition-colors",children:t.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:t.jsx("span",{className:"text-primary font-semibold text-lg",children:z.username.charAt(0).toUpperCase()})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium text-fg truncate",children:z.username}),t.jsx("div",{className:"text-sm text-muted truncate",children:z.email})]})]}),t.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[t.jsx("span",{className:"px-2 py-1 rounded-full bg-primary/10 text-primary border border-primary/20",children:rl(z.role)||z.role}),t.jsxs("span",{className:"text-muted",children:["註冊於 ",new Date(z.created_at).toLocaleDateString()]})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("select",{value:z.role,onChange:q=>Z(z.id,q.target.value),className:"px-3 py-1.5 text-sm bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary min-w-[140px]",title:"調整權限",children:O.map(q=>t.jsx("option",{value:q.value,children:q.label},q.value))}),t.jsx("select",{value:z.school?.slug||"",onChange:q=>Y(z.id,q.target.value),className:"px-3 py-1.5 text-sm bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary min-w-[140px]",title:"學校綁定",children:B.map(q=>t.jsx("option",{value:q.value,children:q.label},q.value))}),t.jsxs("button",{onClick:async()=>{const q=prompt(`為 ${z.username} 設定新 Email`,z.email);!q||q===z.email||await V(z.id,q)},className:"btn-secondary flex items-center gap-1 px-3 py-1.5 text-sm whitespace-nowrap",title:"修改 Email",children:[t.jsx(Kf,{className:"w-3 h-3"}),"Email"]}),t.jsxs("button",{onClick:async()=>{const q=prompt(`為 ${z.username} 設定新密碼（至少 8 碼）`);if(q)try{await fetch(`/api/admin/users/${z.id}/set_password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({password:q})}),E("密碼更新成功")}catch{E("密碼更新失敗")}},className:"btn-secondary flex items-center gap-1 px-3 py-1.5 text-sm whitespace-nowrap",title:"重設密碼",children:[t.jsx(Wc,{className:"w-3 h-3"}),"密碼"]}),t.jsx("button",{onClick:()=>$(z.id),className:"px-3 py-1.5 text-sm rounded-lg border text-red-600 border-red-300 hover:bg-red-50 transition-colors",title:"刪除用戶",children:t.jsx(ps,{className:"w-3 h-3"})})]})]})},z.id))})})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 w-full max-w-md shadow-dramatic",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-lg font-semibold dual-text",children:"新增用戶"}),t.jsx("button",{onClick:()=>g(!1),className:"p-1 rounded-lg hover:bg-surface-hover transition-colors",children:t.jsx(Eo,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium dual-text mb-2",children:"用戶名"}),t.jsx("input",{type:"text",value:v.username,onChange:z=>b({...v,username:z.target.value}),className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",placeholder:"輸入用戶名"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium dual-text mb-2",children:"電子郵件"}),t.jsx("input",{type:"email",value:v.email,onChange:z=>b({...v,email:z.target.value}),className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",placeholder:"user@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium dual-text mb-2",children:"密碼"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:v.password,onChange:z=>b({...v,password:z.target.value}),className:"flex-1 p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",placeholder:"至少 8 碼"}),t.jsx("button",{onClick:ae,className:"btn-secondary px-3 py-3 whitespace-nowrap",children:"隨機生成"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium dual-text mb-2",children:"角色"}),t.jsx("select",{value:v.role,onChange:z=>b({...v,role:z.target.value}),className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:O.map(z=>t.jsx("option",{value:z.value,children:z.label},z.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium dual-text mb-2",children:"所屬學校（可選）"}),t.jsx("select",{value:v.school_slug||"",onChange:z=>b({...v,school_slug:z.target.value}),className:"w-full p-3 bg-surface-hover border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:B.map(z=>t.jsx("option",{value:z.value,children:z.label},z.value))})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:()=>g(!1),className:"btn-secondary flex-1 py-2",children:"取消"}),t.jsx("button",{onClick:J,disabled:j||!v.username||!v.email||!v.password,className:"btn-primary flex-1 flex items-center justify-center gap-2 py-2",children:j?"創建中...":t.jsxs(t.Fragment,{children:[t.jsx(Xa,{className:"w-4 h-4"}),"創建帳號"]})})]})]})})]})}function nj(){const{role:s}=rr(),[a,l]=h.useState([]),[i,d]=h.useState(!0),[u,f]=h.useState(null),[p,x]=h.useState(null),[g,v]=h.useState(null),[b,j]=h.useState(!1),[R,M]=h.useState(null);h.useEffect(()=>{const I=document.documentElement;return I.getAttribute("data-theme")||I.setAttribute("data-theme","beige"),I.classList.add("theme-ready"),()=>I.classList.remove("theme-ready")},[]);async function E(I,A){const J=async Z=>fetch(I,{...A||{},headers:{...A?.headers||{},...Z?{Authorization:`Bearer ${Z}`}:{}}});let ae=localStorage.getItem("token")||void 0,Y=await J(ae);if(Y.status===401)try{const Z=await Y.clone().text(),V=Z?JSON.parse(Z):{},$=V?.error?.code||V?.code,z=localStorage.getItem("refresh_token")||void 0;if(z&&($==="JWT_EXPIRED"||$==="JWT_INVALID"||$==="JWT_MISSING")){const q=await fetch("/api/auth/refresh",{method:"POST",headers:{Authorization:`Bearer ${z}`}});if(q.ok){const se=await q.json();se?.access_token&&(localStorage.setItem("token",se.access_token),ae=se.access_token,Y=await J(ae))}}}catch{}return Y}const S=async()=>{try{d(!0),f(null);const J=await(await E(s==="dev_admin"||s==="campus_admin"?"/api/schools/admin":"/api/schools",{cache:"no-store"})).json().catch(()=>({}));l(Array.isArray(J?.items)?J.items:[])}catch(I){f(I?.message||"載入失敗")}finally{d(!1)}},k=async I=>{try{j(!0);const A=await E(`/api/schools/${I}/admin_overview`,{cache:"no-store"});if(!A.ok)throw new Error(await A.text());const J=await A.json();v(J.stats),x(I)}catch(A){f(A?.message||"載入統計失敗")}finally{j(!1)}},C=async()=>{const I=prompt("新學校代碼（a-z0-9-_）")?.trim();if(!I)return;const A=prompt("學校名稱")?.trim()||I;try{const J=await E("/api/schools",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:I,name:A})});if(!J.ok){alert(await J.text());return}S()}catch(J){alert(J?.message||"建立失敗")}},N=async I=>{const A=prompt("更新學校名稱",I.name||I.slug);if(A)try{const J=await E(`/api/schools/${I.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:A})});if(!J.ok){alert(await J.text());return}S()}catch(J){alert(J?.message||"更新失敗")}},O=async I=>{if(confirm(`確定要刪除「${I.name||I.slug}」嗎？`))try{let A=await E(`/api/schools/${I.id}`,{method:"DELETE"});if(A.status===409){if(!confirm("偵測到相關資料。是否強制刪除並清理關聯內容？"))return;A=await E(`/api/schools/${I.id}?force=1`,{method:"DELETE"})}if(!A.ok){alert(await A.text());return}S()}catch(A){alert(A?.message||"刪除失敗")}},B=async(I,A)=>{try{const J=new FormData;J.append("file",A);const ae=await E(`/api/schools/${I.id}/logo`,{method:"POST",body:J});if(!ae.ok){alert(await ae.text());return}S()}catch(J){alert(J?.message||"上傳失敗")}};h.useEffect(()=>{S()},[]);const w=({school:I,onClose:A})=>t.jsxs("div",{className:"absolute right-0 top-8 z-10 bg-white border border-gray-200 rounded-lg shadow-lg py-1 min-w-36",children:[t.jsxs("button",{onClick:()=>{k(I.slug),A()},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 flex items-center gap-2",children:[t.jsx(_o,{className:"w-4 h-4"}),"查看統計"]}),(s==="dev_admin"||s==="campus_admin")&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>{N(I),A()},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 flex items-center gap-2",children:[t.jsx(xd,{className:"w-4 h-4"}),"重新命名"]}),t.jsxs("label",{className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 flex items-center gap-2 cursor-pointer",children:[t.jsx(Ov,{className:"w-4 h-4"}),"上傳校徽",t.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:J=>{const ae=J.target.files?.[0];ae&&B(I,ae),A()}})]})]}),s==="dev_admin"&&t.jsxs("button",{onClick:()=>{O(I),A()},className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-600 flex items-center gap-2",children:[t.jsx(ps,{className:"w-4 h-4"}),"刪除學校"]})]});return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(Ge,{pathname:"/admin/schools"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-6xl px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm mb-6",children:[t.jsx("div",{className:"flex items-center gap-3 mb-4",children:t.jsxs("button",{onClick:()=>window.history.back(),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[t.jsx(Gr,{className:"w-4 h-4"}),"返回後台"]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:t.jsx(l0,{className:"w-5 h-5 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"學校管理"}),t.jsx("p",{className:"text-sm text-gray-600",children:"管理註冊學校和查看統計資料"})]})]}),s==="dev_admin"&&t.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx(Qf,{className:"w-4 h-4"}),"新增學校"]})]})]}),t.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:[t.jsxs("div",{className:"p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"已註冊學校"}),t.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[a.length," 所學校已入駐平台"]})]}),t.jsx("div",{className:"divide-y divide-gray-200",children:i?t.jsx("div",{className:"p-6 text-center text-gray-500",children:"載入中..."}):u?t.jsx("div",{className:"p-6 text-center text-red-600",children:u}):a.length===0?t.jsx("div",{className:"p-6 text-center text-gray-500",children:"尚無已註冊學校。學生首次透過 Google OAuth 登入時會自動建立學校。"}):a.map(I=>{const A=I.logo_path&&typeof I.logo_path=="string"?`https://cdn.serelix.xyz/${I.logo_path.replace(/^public\//,"")}`:null;return t.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"w-12 h-12 rounded-lg border border-gray-200 bg-gray-50 overflow-hidden",children:[A?t.jsx("img",{src:A,alt:I.name,className:"w-full h-full object-cover",onError:J=>{J.currentTarget.style.display="none",J.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,t.jsx("div",{className:`w-full h-full flex items-center justify-center text-xs text-gray-400 ${A?"hidden":""}`,children:"無徽章"})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-900",children:I.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[I.slug," • ID: ",I.id]})]})]}),t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>M(R===I.id?null:I.id),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(Uf,{className:"w-4 h-4"})}),R===I.id&&t.jsx(w,{school:I,onClose:()=>M(null)})]})]})},I.id)})})]})}),t.jsx("div",{children:p&&g?t.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[a.find(I=>I.slug===p)?.name," 統計"]}),t.jsx("button",{onClick:()=>{x(null),v(null)},className:"text-gray-400 hover:text-gray-600",children:"×"})]})}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(gd,{className:"w-4 h-4 text-blue-600"})}),t.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:g.users_total}),t.jsx("div",{className:"text-xs text-gray-600",children:"用戶數"})]}),t.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"flex items-center justify-center mb-2",children:t.jsx(tr,{className:"w-4 h-4 text-green-600"})}),t.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:g.posts_total}),t.jsx("div",{className:"text-xs text-gray-600",children:"貼文數"})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"活躍度"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"今日新增"}),t.jsxs("span",{className:"font-medium",children:[g.periods.today.posts," 貼文"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"本週新增"}),t.jsxs("span",{className:"font-medium",children:[g.periods.week.posts," 貼文"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"本月新增"}),t.jsxs("span",{className:"font-medium",children:[g.periods.month.posts," 貼文"]})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"內容分布"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"校內貼文"}),t.jsx("span",{className:"font-medium",children:g.cross_split.campus_posts})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"跨校貼文"}),t.jsx("span",{className:"font-medium",children:g.cross_split.cross_posts})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"媒體檔案"}),t.jsx("span",{className:"font-medium",children:g.media_total})]})]})]}),g.top_email_domains.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Email 網域"}),t.jsx("div",{className:"space-y-2",children:g.top_email_domains.slice(0,3).map((I,A)=>t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:I.domain}),t.jsx("span",{className:"font-medium",children:I.count})]},A))})]})]})]}):t.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm p-6",children:t.jsxs("div",{className:"text-center text-gray-500",children:[t.jsx(gs,{className:"w-8 h-8 mx-auto mb-3 text-gray-300"}),t.jsx("p",{className:"text-sm",children:"選擇學校查看統計資料"})]})})})]})]}),R&&t.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>M(null)})]})}function aj(){const[s,a]=h.useState(null),[l,i]=h.useState(!0),[d,u]=h.useState(null),[f,p]=h.useState(null);h.useEffect(()=>{const v=document.documentElement;return v.getAttribute("data-theme")||v.setAttribute("data-theme","beige"),v.classList.add("theme-ready"),()=>v.classList.remove("theme-ready")},[]);const x=async()=>{try{i(!0),u(null);const v=await fetch("/api/status/integrations",{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`},cache:"no-store"});if(!v.ok)throw new Error(`API 錯誤: ${v.status}`);const b=await v.json();a(b),p(new Date)}catch(v){u(v?.message||"載入失敗")}finally{i(!1)}};h.useEffect(()=>{x();const v=setInterval(x,3e4);return()=>clearInterval(v)},[]);const g=({title:v,status:b,description:j,icon:R,details:M,error:E})=>{const S={success:"border-success-border bg-success-bg text-success-text",warning:"border-warning-border bg-warning-bg text-warning-text",error:"border-danger-border bg-danger-bg text-danger-text",disabled:"border-border bg-surface-hover text-muted"},k={success:t.jsx(mr,{className:"w-5 h-5 text-success"}),warning:t.jsx(ct,{className:"w-5 h-5 text-warning"}),error:t.jsx(bn,{className:"w-5 h-5 text-danger"}),disabled:t.jsx(bn,{className:"w-5 h-5 text-muted"})};return t.jsxs("div",{className:`p-4 rounded-xl border ${S[b]} transition-all hover:shadow-medium`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(R,{className:"w-6 h-6"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-sm",children:v}),t.jsx("p",{className:"text-xs opacity-80 mt-1",children:j})]})]}),k[b]]}),M&&t.jsx("div",{className:"mt-3 text-xs space-y-1",children:M}),E&&t.jsx("div",{className:"mt-3 p-2 rounded bg-danger-bg border border-danger-border",children:t.jsx("p",{className:"text-xs text-danger-text font-mono",children:E})})]})};return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/admin/integrations"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-6xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-6",children:[t.jsx("div",{className:"flex items-center gap-3 mb-2",children:t.jsxs("button",{onClick:()=>window.history.back(),className:"flex items-center gap-2 text-muted hover:text-fg transition-colors",children:[t.jsx(Gr,{className:"w-4 h-4"}),"返回後台"]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold dual-text mb-2",children:"系統整合狀態"}),t.jsx("p",{className:"text-sm text-muted",children:"監控 Webhook、佇列服務和系統整合狀態"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[f&&t.jsxs("div",{className:"hidden sm:flex text-xs text-muted items-center gap-1",children:[t.jsx(ta,{className:"w-3 h-3"}),"更新於 ",f.toLocaleTimeString()]}),t.jsxs("button",{onClick:x,disabled:l,className:"btn-primary flex items-center gap-2 px-3 sm:px-4 py-2 text-sm sm:text-base",children:[t.jsx(_t,{className:`w-4 h-4 ${l?"animate-spin":""}`}),t.jsx("span",{className:"hidden sm:inline",children:"重新載入"}),t.jsx("span",{className:"sm:hidden",children:"刷新"})]})]})]})]}),d&&t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-4 mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[t.jsx(bn,{className:"w-5 h-5"}),t.jsx("span",{className:"font-medium",children:"載入錯誤"})]}),t.jsx("p",{className:"text-sm text-red-700 mt-1",children:d})]}),s&&t.jsx("div",{className:"bg-surface border border-border rounded-2xl p-4 mb-6 shadow-soft",children:t.jsx("div",{className:"flex items-center justify-center gap-3",children:s.ok?t.jsxs(t.Fragment,{children:[t.jsx(mr,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-green-800",children:"系統運行正常"}),t.jsx("p",{className:"text-sm text-green-600",children:"所有核心服務正常運作"})]})]}):t.jsxs(t.Fragment,{children:[t.jsx(ct,{className:"w-6 h-6 sm:w-8 sm:h-8 text-red-600"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-red-800",children:"系統異常"}),t.jsx("p",{className:"text-sm text-red-600",children:"檢測到服務異常，請檢查詳細狀態"})]})]})})}),l&&!s?t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-8 text-center shadow-soft",children:[t.jsx(_t,{className:"w-8 h-8 animate-spin mx-auto mb-3 text-primary"}),t.jsx("p",{className:"text-muted",children:"載入整合狀態中..."})]}):s?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6",children:[t.jsx(g,{title:"Discord Webhook",status:s.admin_webhook?.configured?"success":"disabled",description:"管理員通知和系統事件推送",icon:tr,details:s.admin_webhook?.configured?t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"目標主機:"}),t.jsx("span",{className:"font-mono text-xs sm:text-sm",children:s.admin_webhook.host})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Webhook ID:"}),t.jsx("span",{className:"font-mono text-xs sm:text-sm",children:s.admin_webhook.id_mask})]}),s.admin_webhook.last_delivery&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"最後推送:"}),t.jsx("span",{className:"text-xs sm:text-sm",children:new Date(s.admin_webhook.last_delivery).toLocaleString()})]})]}):t.jsx("p",{className:"text-xs opacity-80",children:"Webhook 未配置"}),error:s.admin_webhook?.error}),t.jsx(g,{title:"佇列系統",status:s.queue?.enabled?"success":"disabled",description:"背景任務處理和訊息佇列",icon:Bf,details:t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"狀態:"}),t.jsx("span",{children:s.queue?.enabled?"已啟用":"已停用"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"佇列大小:"}),t.jsxs("span",{children:[s.queue?.size||0," 項"]})]}),s.queue?.redis_connected!==void 0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Redis 連線:"}),t.jsx("span",{children:s.queue.redis_connected?"✅ 已連線":"❌ 斷線"})]})]})})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl shadow-soft overflow-hidden mb-6",children:[t.jsx("div",{className:"p-4 border-b border-border",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(er,{className:"w-5 h-5"}),t.jsx("h2",{className:"text-lg font-semibold dual-text",children:"最近管理員事件"})]})}),t.jsx("div",{className:"p-4",children:s.recent_admin_events&&s.recent_admin_events.length>0?t.jsx("div",{className:"space-y-3",children:s.recent_admin_events.map((v,b)=>t.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-surface-hover",children:[t.jsx("div",{className:`w-4 h-4 mt-0.5 rounded-full ${v.ok?"bg-green-500":"bg-red-500"}`}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"text-sm font-medium text-fg truncate",children:[v.kind==="post_approved"&&"貼文核准",v.kind==="comment_approved"&&"留言核准",v.kind==="comment_rejected"&&"留言拒絕",v.kind==="comment_deleted"&&"留言刪除",v.kind==="delete_request_approved"&&"刪文請求核准",v.kind==="delete_request_rejected"&&"刪文請求拒絕",v.kind==="simple_choice"&&"顏色投票",v.kind==="theme_proposal"&&"主題提案",v.kind||"管理員事件"]}),t.jsx("div",{className:"text-sm text-muted mt-1",children:v.ok?"操作成功":`操作失敗: ${v.error||"未知錯誤"}`}),t.jsx("div",{className:"text-xs text-muted mt-2",children:new Date(v.ts).toLocaleString()})]})]},b))}):t.jsxs("div",{className:"text-center py-8 text-muted",children:[t.jsx(er,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"近期無管理員事件記錄"}),t.jsx("p",{className:"text-xs mt-1",children:"系統運行正常，無異常事件"})]})})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl shadow-soft overflow-hidden mb-6",children:[t.jsx("div",{className:"p-4 border-b border-border",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(er,{className:"w-5 h-5"}),t.jsx("h2",{className:"text-lg font-semibold dual-text",children:"主機運行狀況"})]})}),t.jsx("div",{className:"p-4",children:s.system?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.system.hostname&&t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:"主機名稱"}),t.jsx("div",{className:"text-sm font-mono text-fg",children:s.system.hostname})]}),s.system.platform&&t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:"作業系統"}),t.jsx("div",{className:"text-sm font-mono text-fg line-clamp-2",children:s.system.platform})]}),s.system.uptime&&t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:"運行時間"}),t.jsxs("div",{className:"text-sm font-mono text-fg",children:[Math.floor(s.system.uptime/3600),"小時 ",Math.floor(s.system.uptime%3600/60),"分鐘"]})]}),s.system.loadavg&&t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-muted mb-1",children:"系統負載"}),t.jsxs("div",{className:"text-sm font-mono text-fg",children:[s.system.loadavg["1m"].toFixed(2)," / ",s.system.loadavg["5m"].toFixed(2)," / ",s.system.loadavg["15m"].toFixed(2)]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.system.cpu_percent!=null&&t.jsxs("div",{className:"bg-surface-hover rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"font-medium text-sm text-fg",children:"CPU 使用率"}),t.jsxs("span",{className:"text-lg font-bold text-fg",children:[s.system.cpu_percent.toFixed(1),"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:`h-3 rounded-full transition-all ${s.system.cpu_percent>80?"bg-red-500":s.system.cpu_percent>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(s.system.cpu_percent,100)}%`}})}),t.jsxs("div",{className:"flex justify-between text-xs text-muted mt-2",children:[t.jsx("span",{children:"0%"}),t.jsx("span",{children:"100%"})]})]}),s.system.memory&&t.jsxs("div",{className:"bg-surface-hover rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"font-medium text-sm text-fg",children:"記憶體使用率"}),t.jsxs("span",{className:"text-lg font-bold text-fg",children:[s.system.memory.percent.toFixed(1),"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:`h-3 rounded-full transition-all ${s.system.memory.percent>80?"bg-red-500":s.system.memory.percent>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(s.system.memory.percent,100)}%`}})}),t.jsxs("div",{className:"flex justify-between text-xs text-muted mt-2",children:[t.jsxs("span",{children:[Math.round(s.system.memory.available/1024/1024/1024),"GB 可用"]}),t.jsxs("span",{children:[Math.round(s.system.memory.total/1024/1024/1024),"GB 總計"]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3 sm:p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"}),t.jsx("h3",{className:"font-medium text-xs sm:text-sm text-fg",children:"使用者總數"})]}),t.jsx("div",{className:"text-lg font-bold text-fg",children:s.user_stats?s.user_stats.total:"N/A"}),t.jsx("div",{className:"text-xs text-muted",children:"註冊用戶"})]}),t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3 sm:p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),t.jsx("h3",{className:"font-medium text-xs sm:text-sm text-fg",children:"佇列任務"})]}),t.jsx("div",{className:"text-lg font-bold text-fg",children:s.queue?.size||0}),t.jsx("div",{className:"text-xs text-muted",children:"待處理"})]}),t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3 sm:p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${s.system?.db_cpu_percent!==void 0&&s.system?.db_cpu_percent!==null?"bg-green-500":"bg-gray-400"}`}),t.jsx("h3",{className:"font-medium text-xs sm:text-sm text-fg",children:"資料庫"})]}),t.jsx("div",{className:`text-lg font-bold ${s.system?.db_cpu_percent!==void 0&&s.system?.db_cpu_percent!==null?"text-green-600":"text-gray-500"}`,children:s.system?.db_cpu_percent!==void 0&&s.system?.db_cpu_percent!==null?"運行中":"N/A"}),t.jsx("div",{className:"text-xs text-muted",children:"服務狀態"})]}),t.jsxs("div",{className:"bg-surface-hover rounded-lg p-3 sm:p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${s.system?.cdn_cpu_percent!==void 0&&s.system?.cdn_cpu_percent!==null?"bg-green-500":"bg-gray-400"}`}),t.jsx("h3",{className:"font-medium text-xs sm:text-sm text-fg",children:"CDN"})]}),t.jsx("div",{className:`text-lg font-bold ${s.system?.cdn_cpu_percent!==void 0&&s.system?.cdn_cpu_percent!==null?"text-green-600":"text-gray-500"}`,children:s.system?.cdn_cpu_percent!==void 0&&s.system?.cdn_cpu_percent!==null?"運行中":"N/A"}),t.jsx("div",{className:"text-xs text-muted",children:"服務狀態"})]})]})]}):t.jsxs("div",{className:"text-center py-12 text-muted",children:[t.jsx(er,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),t.jsx("p",{className:"text-lg mb-2",children:"無法獲取主機運行狀況"}),t.jsx("p",{className:"text-sm",children:"系統可能未安裝 psutil 套件或權限不足"}),t.jsx("p",{className:"text-xs mt-2",children:"請聯繫系統管理員檢查系統監控配置"})]})})]}),t.jsxs("details",{className:"hidden lg:block mt-6",children:[t.jsx("summary",{className:"cursor-pointer text-sm text-muted hover:text-fg transition-colors",children:"🔧 查看原始 JSON 數據（開發用）"}),t.jsx("div",{className:"mt-3 bg-gray-900 rounded-xl p-4 overflow-auto",children:t.jsx("pre",{className:"text-xs text-green-400 whitespace-pre-wrap break-words",children:JSON.stringify(s,null,2)})})]})]}):null]})]})}function lj(){const{role:s,schoolId:a}=rr(),[l,i]=h.useState("about"),[d,u]=h.useState(""),[f,p]=h.useState(""),[x,g]=h.useState(!0),[v,b]=h.useState(!1),[j,R]=h.useState(null),[M,E]=h.useState(!1),[S,k]=h.useState(()=>s==="dev_admin"?"global":s==="cross_admin"?"cross":"school"),[C,N]=h.useState(""),[O,B]=h.useState([]),w=h.useRef(null);h.useEffect(()=>{const $=document.documentElement;return $.getAttribute("data-theme")||$.setAttribute("data-theme","beige"),$.classList.add("theme-ready"),()=>$.classList.remove("theme-ready")},[]),h.useEffect(()=>{(async()=>{try{const $=await fetch("/api/schools",{cache:"no-store"});if(!$.ok)return;const z=await $.json();if(Array.isArray(z?.items)&&B(z.items),s==="campus_admin"){const q=(z.items||[]).find(se=>Number(se.id)===Number(a));q&&N(q.slug)}}catch{}})()},[]);const I=async($,z=S,q)=>{try{g(!0),R(null);const se=new URLSearchParams;z&&se.set("scope",z);const G={};if(z==="school"){const T=q||C;T&&(G["X-School-Slug"]=T)}const ee=await(await fetch(`/api/pages/${$}?${se.toString()}`,{headers:G})).json();u(String(ee?.markdown||"")),p(String(ee?.html||""))}catch(se){R(se?.message||"載入失敗")}finally{g(!1)}};h.useEffect(()=>{I(l,S)},[l,S,C]);const A=async()=>{try{const z=await(await fetch("/api/pages/render",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({markdown:d})})).json();p(String(z?.html||""))}catch{}},J=($,z="",q="")=>{const se=w.current;if(!se)return;const G=se.selectionStart,re=se.selectionEnd,ee=d.slice(G,re),T=$+(ee||q)+z,K=d.slice(0,G)+T+d.slice(re);u(K),setTimeout(()=>{const fe=G+$.length+(ee||q).length;se.setSelectionRange(fe,fe),se.focus()},0)},ae=[{icon:Dv,action:()=>J("**","**","粗體文字"),title:"粗體"},{icon:Kv,action:()=>J("*","*","斜體文字"),title:"斜體"},{icon:Vf,action:()=>J("[","](https://)","連結文字"),title:"連結"},{icon:Yv,action:()=>J("- ","","清單項目"),title:"無序清單"},{icon:a0,action:()=>J("> ","","引用文字"),title:"引用"},{icon:Ff,action:()=>J("`","`","程式碼"),title:"行內程式碼"}],Y=()=>{const $=new Blob([d],{type:"text/markdown"}),z=URL.createObjectURL($),q=document.createElement("a");q.href=z,q.download=`${l}.md`,q.click(),URL.revokeObjectURL(z)},Z=$=>{const z=$.target.files?.[0];if(!z)return;const q=new FileReader;q.onload=se=>{const G=se.target?.result;u(G)},q.readAsText(z)},V=async()=>{try{b(!0),R(null);const $={markdown:d,scope:S};S==="school"&&($.school_slug=C);const z=await fetch(`/api/pages/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify($)});if(!z.ok)throw new Error(await z.text());R("已儲存"),A()}catch($){R($?.message||"儲存失敗")}finally{b(!1)}};return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/admin/pages"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-6xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4",children:[t.jsx("div",{className:"flex items-center gap-3 mb-2",children:t.jsxs("button",{onClick:()=>window.history.back(),className:"flex items-center gap-2 text-muted hover:text-fg transition-colors",children:[t.jsx(Gr,{className:"w-4 h-4"}),"返回後台"]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"頁面內容編輯"}),t.jsx("p",{className:"text-sm text-muted mt-1",children:"編輯關於我們、版規等頁面內容"})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:V,disabled:v,className:"btn-primary flex items-center gap-2 px-3 sm:px-4 py-2 text-sm sm:text-base",children:[t.jsx(Xa,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"儲存變更"}),t.jsx("span",{className:"sm:hidden",children:"儲存"})]})})]}),j&&t.jsx("div",{className:`mt-3 p-2 rounded-lg text-sm ${j.includes("失敗")?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"}`,children:j})]}),x?t.jsx("div",{className:"bg-surface border border-border rounded-2xl p-8 text-center text-muted",children:"載入中..."}):t.jsxs("div",{className:"bg-surface border border-border rounded-2xl shadow-soft overflow-hidden",children:[t.jsxs("div",{className:"border-b border-border p-4 flex flex-wrap gap-3 items-center",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm text-muted",children:"頁面"}),t.jsxs("select",{value:l,onChange:$=>i($.target.value),className:"px-3 py-1.5 text-sm rounded-lg border bg-surface-hover border-border",children:[t.jsx("option",{value:"about",children:"關於我們"}),t.jsx("option",{value:"rules",children:"版規"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm text-muted",children:"範圍"}),t.jsxs("select",{value:S,onChange:$=>k($.target.value),className:"px-3 py-1.5 text-sm rounded-lg border bg-surface-hover border-border",children:[s==="dev_admin"&&t.jsxs(t.Fragment,{children:[t.jsx("option",{value:"global",children:"全域"}),t.jsx("option",{value:"cross",children:"跨校"}),t.jsx("option",{value:"school",children:"校內"})]}),s==="cross_admin"&&t.jsx(t.Fragment,{children:t.jsx("option",{value:"cross",children:"跨校"})}),s==="campus_admin"&&t.jsx(t.Fragment,{children:t.jsx("option",{value:"school",children:"校內"})})]})]}),S==="school"&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm text-muted",children:"學校"}),t.jsx("select",{value:C,onChange:$=>N($.target.value),disabled:s==="campus_admin",className:"px-3 py-1.5 text-sm rounded-lg border bg-surface-hover border-border min-w-[160px]",children:O.map($=>t.jsxs("option",{value:$.slug,children:[$.name," (",$.slug,")"]},$.slug))})]}),t.jsx("div",{className:"ml-auto flex items-center gap-2",children:t.jsxs("button",{onClick:A,className:"btn-secondary flex items-center gap-2 px-3 py-1.5 text-sm",children:[t.jsx(gs,{className:"w-4 h-4"})," 預覽"]})})]}),!M&&t.jsx("div",{className:"border-b border-border p-3",children:t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ae.map(({icon:$,action:z,title:q},se)=>t.jsx("button",{onClick:z,title:q,className:"p-2 rounded-lg hover:bg-surface-hover transition-colors text-fg",children:t.jsx($,{className:"w-4 h-4"})},se)),t.jsx("div",{className:"w-px h-6 bg-border mx-2"}),t.jsx("button",{onClick:Y,title:"匯出 Markdown",className:"p-2 rounded-lg hover:bg-surface-hover transition-colors text-fg",children:t.jsx(md,{className:"w-4 h-4"})}),t.jsxs("label",{title:"匯入 Markdown",className:"p-2 rounded-lg hover:bg-surface-hover transition-colors cursor-pointer text-fg",children:[t.jsx(Jc,{className:"w-4 h-4"}),t.jsx("input",{type:"file",accept:".md,.txt",onChange:Z,className:"hidden"})]})]})}),t.jsxs("div",{className:"flex flex-col lg:flex-row min-h-[600px]",children:[!M&&t.jsx("div",{className:"flex-1 p-4",children:t.jsx("textarea",{ref:w,value:d,onChange:$=>u($.target.value),className:"form-control w-full h-[550px] font-mono text-sm resize-none",placeholder:`# 標題

這是一段內容

## 子標題

可以使用 **粗體** 和 *斜體* 等 Markdown 語法。

- 清單項目 1
- 清單項目 2

> 這是引用文字

\`行內程式碼\`

\`\`\`
程式碼區塊
\`\`\`

[連結文字](https://example.com)`})}),(M||!M&&f)&&t.jsxs("div",{className:`${M?"w-full":"flex-1 border-l border-border"} p-4`,children:[!M&&t.jsx("h3",{className:"font-semibold dual-text mb-3",children:"即時預覽"}),t.jsx("div",{className:"prose prose-sm max-w-none text-fg min-h-[500px]",children:f?t.jsx("div",{dangerouslySetInnerHTML:{__html:f}}):t.jsx("div",{className:"text-muted text-center py-8",children:"點擊「預覽」按鈕查看渲染結果"})})]})]})]})]})]})}function oj(){const s=en(),[a,l]=h.useState([]),[i,d]=h.useState(null),[u,f]=h.useState(!0),[p,x]=h.useState(null),[g,v]=h.useState(""),[b,j]=h.useState(""),[R,M]=h.useState(!0);h.useEffect(()=>{if(!jn()){s("/auth");return}E()},[s,g,b]);const E=async()=>{try{f(!0),x(null);const N=new URLSearchParams({limit:"50",stats:"true"});g&&N.append("type",g),b&&N.append("severity",b);const O=await fetch(`/api/admin/events?${N}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(O.ok){const B=await O.json();l(B.events||[]),d(B.statistics||null)}else{const B=await O.json().catch(()=>({}));x(B.error||"無法載入事件記錄")}}catch(N){console.error("Error loading events:",N),x("網路連線錯誤，請稍後再試")}finally{f(!1)}},S=N=>{switch(N){case"user_login":case"user_registered":case"user_logout":case"user_role_changed":case"user_password_changed":case"user_deleted":return zr;case"post_created":case"post_approved":case"post_rejected":case"post_deleted":return hd;case"comment_created":case"comment_approved":case"comment_rejected":case"comment_deleted":return tr;case"school_created":case"school_updated":case"school_deleted":return Qa;case"system_mode_changed":case"system_settings_changed":case"maintenance_mode":return Vs;case"failed_login":case"suspicious_activity":case"rate_limit_exceeded":return ct;case"delete_request_created":case"delete_request_approved":case"delete_request_rejected":return Gn;default:return er}},k=N=>{switch(N){case"critical":return"text-red-600 bg-red-50 dark:bg-red-900/20";case"high":return"text-orange-600 bg-orange-50 dark:bg-orange-900/20";case"medium":return"text-blue-600 bg-blue-50 dark:bg-blue-900/20";case"low":return"text-green-600 bg-green-50 dark:bg-green-900/20";default:return"text-gray-600 bg-gray-50 dark:bg-gray-900/20"}},C=N=>N.includes("rejected")||N.includes("failed")||N.includes("deleted")?"text-red-600":N.includes("approved")||N.includes("created")?"text-green-600":N.includes("login")||N.includes("logout")?"text-blue-600":"text-gray-600";return jn()?t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/admin/events"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-6xl px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-6",children:[t.jsx("div",{className:"flex items-center gap-3 mb-2",children:t.jsxs("button",{onClick:()=>s("/admin"),className:"flex items-center gap-2 text-muted hover:text-fg transition-colors",children:[t.jsx(Gr,{className:"w-4 h-4"}),"返回後台"]})}),t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"管理員事件記錄"}),t.jsx("p",{className:"text-sm text-muted mt-1",children:"查看系統中的重要操作記錄"})]}),R&&i&&t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-fg",children:"統計概覽"}),t.jsx("button",{onClick:()=>M(!1),className:"text-muted hover:text-fg transition-colors",children:t.jsx(bn,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-surface-hover rounded-xl p-4 text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-fg",children:i.total_events}),t.jsx("div",{className:"text-sm text-muted",children:"總事件數"})]}),t.jsxs("div",{className:"bg-surface-hover rounded-xl p-4 text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.events_24h}),t.jsx("div",{className:"text-sm text-muted",children:"24小時內"})]}),t.jsxs("div",{className:"bg-surface-hover rounded-xl p-4 text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.severity_distribution.low||0}),t.jsx("div",{className:"text-sm text-muted",children:"低風險"})]}),t.jsxs("div",{className:"bg-surface-hover rounded-xl p-4 text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:(i.severity_distribution.high||0)+(i.severity_distribution.critical||0)}),t.jsx("div",{className:"text-sm text-muted",children:"高風險"})]})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 shadow-soft mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-fg",children:"篩選條件"}),t.jsxs("button",{onClick:E,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm rounded-lg border hover:bg-surface/80 transition-colors disabled:opacity-50",children:[t.jsx(_t,{className:`w-4 h-4 ${u?"animate-spin":""}`}),"重新載入"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"事件類型"}),t.jsxs("select",{value:g,onChange:N=>v(N.target.value),className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-fg focus:outline-none focus:ring-2 focus:ring-primary/20",children:[t.jsx("option",{value:"",children:"全部類型"}),t.jsx("option",{value:"user_login",children:"用戶登入"}),t.jsx("option",{value:"user_registered",children:"用戶註冊"}),t.jsx("option",{value:"post_created",children:"貼文發布"}),t.jsx("option",{value:"post_approved",children:"貼文核准"}),t.jsx("option",{value:"post_rejected",children:"貼文拒絕"}),t.jsx("option",{value:"comment_created",children:"留言發布"}),t.jsx("option",{value:"comment_approved",children:"留言核准"}),t.jsx("option",{value:"comment_rejected",children:"留言拒絕"}),t.jsx("option",{value:"delete_request_approved",children:"刪文請求核准"}),t.jsx("option",{value:"delete_request_rejected",children:"刪文請求拒絕"}),t.jsx("option",{value:"system_mode_changed",children:"系統模式變更"}),t.jsx("option",{value:"failed_login",children:"登入失敗"}),t.jsx("option",{value:"suspicious_activity",children:"可疑活動"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-fg mb-2",children:"嚴重程度"}),t.jsxs("select",{value:b,onChange:N=>j(N.target.value),className:"w-full px-3 py-2 border border-border rounded-lg bg-surface text-fg focus:outline-none focus:ring-2 focus:ring-primary/20",children:[t.jsx("option",{value:"",children:"全部程度"}),t.jsx("option",{value:"low",children:"低"}),t.jsx("option",{value:"medium",children:"中"}),t.jsx("option",{value:"high",children:"高"}),t.jsx("option",{value:"critical",children:"嚴重"})]})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("button",{onClick:()=>{v(""),j("")},className:"w-full px-4 py-2 text-sm border border-border rounded-lg hover:bg-surface/80 transition-colors",children:"清除篩選"})})]})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl shadow-soft overflow-hidden",children:[t.jsx("div",{className:"p-4 border-b border-border",children:t.jsx("h2",{className:"text-lg font-semibold text-fg",children:"事件記錄"})}),u?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(Qs,{className:"w-8 h-8 mx-auto mb-4 text-muted animate-spin"}),t.jsx("p",{className:"text-muted",children:"載入中..."})]}):p?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(ct,{className:"w-12 h-12 mx-auto mb-4 text-muted"}),t.jsx("h3",{className:"text-lg font-semibold text-fg mb-2",children:"載入失敗"}),t.jsx("p",{className:"text-muted mb-4",children:p}),t.jsx("button",{onClick:E,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors",children:"重新載入"})]}):a.length===0?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(er,{className:"w-12 h-12 mx-auto mb-4 text-muted"}),t.jsx("h3",{className:"text-lg font-semibold text-fg mb-2",children:"無事件記錄"}),t.jsx("p",{className:"text-muted",children:"目前沒有任何事件記錄"})]}):t.jsx("div",{className:"divide-y divide-border",children:a.map((N,O)=>{const B=S(N.event_type);return t.jsx("div",{className:"p-4 hover:bg-surface-hover transition-colors",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:`p-2 rounded-lg ${C(N.event_type)}`,children:t.jsx(B,{className:"w-5 h-5"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h3",{className:"font-medium text-fg",children:N.title}),t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${k(N.severity)}`,children:N.severity_display})]}),t.jsx("p",{className:"text-sm text-muted mb-2",children:N.description}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ta,{className:"w-3 h-3"}),N.time_display]}),t.jsx("span",{children:N.time_ago}),N.actor_name&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(zr,{className:"w-3 h-3"}),N.actor_name]}),N.target_id&&t.jsxs("span",{children:["目標ID: ",N.target_id]})]})]})]})},O)})})]})]})]}):null}function ij(){const{isLoggedIn:s}=rr(),[a,l]=h.useState("account"),[i,d]=h.useState(""),[u,f]=h.useState(""),[p,x]=h.useState(""),[g,v]=h.useState(!1),[b,j]=h.useState(null),[R,M]=h.useState("");h.useEffect(()=>{const S=document.documentElement;return S.getAttribute("data-theme")||S.setAttribute("data-theme","beige"),S.classList.add("theme-ready"),()=>S.classList.remove("theme-ready")},[]);const E=async()=>{if(!p.trim()){j("err"),M("請輸入訊息");return}v(!0),j(null),M("");try{const S=await fetch("/api/support/report",{method:"POST",headers:{"Content-Type":"application/json",...localStorage.getItem("token")?{Authorization:`Bearer ${localStorage.getItem("token")}`}:{}},body:JSON.stringify({category:a,subject:i,email:u,message:p})}),k=await S.json().catch(()=>({}));if(!S.ok||k?.ok===!1)throw new Error(k?.msg||"提交失敗");j("ok"),M("已送出，我們會盡快回覆，請留意 Email 或站內通知。"),d(""),x("")}catch(S){j("err"),M(S?.message||"提交失敗，請稍後再試")}finally{v(!1)}};return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/support"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-3xl px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-6",children:[t.jsx("div",{className:"flex items-center gap-3 mb-2",children:t.jsxs("button",{onClick:()=>window.history.back(),className:"flex items-center gap-2 text-muted hover:text-fg transition-colors",children:[t.jsx(Gr,{className:"w-4 h-4"})," 返回"]})}),t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"聯絡管理員 / 狀況回報"}),t.jsx("p",{className:"text-sm text-muted mt-1",children:"如果遇到帳號註冊問題或其它狀況，請在此留言給管理員。"})]}),t.jsx("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft",children:t.jsxs("div",{className:"grid gap-4",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-muted mb-1",children:"分類"}),t.jsxs("select",{value:a,onChange:S=>l(S.target.value),className:"form-control w-full",children:[t.jsx("option",{value:"account",children:"帳號/登入問題"}),t.jsx("option",{value:"report",children:"問題回報"}),t.jsx("option",{value:"abuse",children:"濫用/檢舉"}),t.jsx("option",{value:"other",children:"其他"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-muted mb-1",children:"Email（可選）"}),t.jsx("input",{value:u,onChange:S=>f(S.target.value),placeholder:"方便聯絡您",className:"form-control w-full"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-muted mb-1",children:"主旨（可選）"}),t.jsx("input",{value:i,onChange:S=>d(S.target.value),placeholder:"簡述您的問題",className:"form-control w-full"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-muted mb-1",children:"內容"}),t.jsx("textarea",{value:p,onChange:S=>x(S.target.value),rows:8,placeholder:"請描述您的情況，例如錯誤訊息、發生步驟、影響帳號等。",className:"form-control w-full"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:E,disabled:g,className:"btn-primary flex items-center gap-2 px-4 py-2",children:[t.jsx(pd,{className:`w-4 h-4 ${g?"animate-pulse":""}`}),"送出"]}),b==="ok"&&t.jsxs("div",{className:"text-green-600 flex items-center gap-2 text-sm",children:[t.jsx(mr,{className:"w-4 h-4"})," ",R]}),b==="err"&&t.jsxs("div",{className:"text-rose-600 flex items-center gap-2 text-sm",children:[t.jsx(ct,{className:"w-4 h-4"})," ",R]})]})]})})]})]})}function cj(){const[s,a]=h.useState([]),[l,i]=h.useState(!0),[d,u]=h.useState(null);h.useEffect(()=>{const p=document.documentElement;return p.getAttribute("data-theme")||p.setAttribute("data-theme","beige"),p.classList.add("theme-ready"),()=>p.classList.remove("theme-ready")},[]);const f=async()=>{try{i(!0),u(null);const p=await fetch("/api/support/recent",{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`},cache:"no-store"}),x=await p.json().catch(()=>({}));if(!p.ok)throw new Error(x?.msg||"讀取失敗");a(Array.isArray(x?.items)?x.items:[])}catch(p){u(p?.message||"讀取失敗")}finally{i(!1)}};return h.useEffect(()=>{f()},[]),t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/admin/support"}),t.jsx(at,{}),t.jsxs("main",{className:"mx-auto max-w-5xl px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("button",{onClick:()=>window.history.back(),className:"flex items-center gap-2 text-muted hover:text-fg",children:[t.jsx(Gr,{className:"w-4 h-4"}),"返回"]}),t.jsxs("button",{onClick:f,disabled:l,className:"px-3 py-1.5 text-sm rounded-lg border hover:bg-surface/80 flex items-center gap-2",children:[t.jsx(_t,{className:`w-4 h-4 ${l?"animate-spin":""}`})," 重新整理"]})]}),t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text mt-2",children:"使用者回報 / 聯絡"}),t.jsx("p",{className:"text-sm text-muted",children:"檢視最近 50 則透過「聯絡管理員」送來的訊息（含 IP/ClientID/分類）。"})]}),t.jsx("div",{className:"bg-surface border border-border rounded-2xl shadow-soft overflow-hidden",children:l?t.jsx("div",{className:"p-8 text-center text-muted",children:"載入中..."}):d?t.jsx("div",{className:"p-8 text-center text-rose-600",children:d}):s.length===0?t.jsx("div",{className:"p-8 text-center text-muted",children:"目前沒有新回報"}):t.jsx("div",{className:"divide-y divide-border",children:s.map((p,x)=>t.jsx("div",{className:"p-4 hover:bg-surface-hover transition-colors",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"p-2 rounded-lg bg-surface border border-border",children:t.jsx(tr,{className:"w-4 h-4"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:"font-semibold text-fg",children:p.title||p.event_type_display||"回報"}),t.jsx("span",{className:"text-xs text-muted",children:new Date(p.timestamp).toLocaleString()}),p.severity&&t.jsxs("span",{className:"text-xs text-muted",children:["· ",p.severity]})]}),t.jsx("div",{className:"whitespace-pre-wrap text-sm text-fg mt-1 break-words",children:p.description}),t.jsxs("div",{className:"text-xs text-muted mt-1",children:[p.actor_name?`來自：${p.actor_name}`:"來自：訪客"," · ",p.metadata?.email?`Email: ${p.metadata.email} · `:"","IP: ",p.metadata?.ip||"-"," · Client: ",p.metadata?.client_id||"-"]})]})]})},x))})})]})]})}function dj(){const{pathname:s}=Ut();h.useEffect(()=>{const p=document.documentElement;return p.getAttribute("data-theme")||p.setAttribute("data-theme","beige"),p.classList.add("theme-ready"),()=>p.classList.remove("theme-ready")},[]);const[a,l]=h.useState(!0),[i,d]=h.useState(null),[u,f]=h.useState("");return h.useEffect(()=>{(async()=>{try{l(!0),d(null);const x=await(await fetch("/api/pages/about",{cache:"no-store"})).json();f(String(x?.html||""))}catch(p){d(p?.message||"載入失敗")}finally{l(!1)}})()},[]),t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:s}),t.jsx(at,{}),t.jsx("main",{className:"mx-auto max-w-3xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft",children:[t.jsx("h1",{className:"text-2xl font-semibold dual-text mb-3",children:"關於我們"}),a?t.jsx("div",{className:"text-muted",children:"載入中..."}):i?t.jsx("div",{className:"text-rose-600",children:i}):t.jsx("div",{className:"prose prose-sm max-w-none text-fg",dangerouslySetInnerHTML:{__html:u}})]})})]})}function uj(){const{pathname:s}=Ut(),[a,l]=h.useState(!0),[i,d]=h.useState(null),[u,f]=h.useState("");return h.useEffect(()=>{(async()=>{try{l(!0),d(null);const x=await(await fetch("/api/pages/rules",{cache:"no-store"})).json();f(String(x?.html||""))}catch(p){d(p?.message||"載入失敗")}finally{l(!1)}})()},[]),t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:s}),t.jsx(at,{}),t.jsx("main",{className:"mx-auto max-w-3xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft",children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text mb-3",children:"社群規範"}),a?t.jsx("div",{className:"text-muted",children:"載入中..."}):i?t.jsx("div",{className:"text-rose-600",children:i}):t.jsx("div",{className:"prose prose-sm max-w-none text-fg",dangerouslySetInnerHTML:{__html:u}})]})})]})}function mj(){return t.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:t.jsxs("div",{className:"max-w-lg w-full rounded-2xl border border-border bg-surface p-6 shadow-soft text-center",children:[t.jsx("div",{className:"mx-auto w-12 h-12 rounded-2xl bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center mb-3",children:t.jsx(Xf,{className:"w-6 h-6 text-rose-600 dark:text-rose-300"})}),t.jsx("h1",{className:"text-2xl font-bold dual-text mb-1",children:"沒有權限"}),t.jsx("p",{className:"text-sm text-muted mb-4",children:"你沒有存取此頁面的權限，或需要更高的角色身份。"}),t.jsxs("div",{className:"flex items-center justify-center gap-3",children:[t.jsxs("a",{href:"/",className:"px-3 py-2 rounded-xl border hover:bg-surface/80 flex items-center gap-2",children:[t.jsx(Zt,{className:"w-4 h-4"})," 回到首頁"]}),t.jsxs("button",{onClick:()=>history.back(),className:"px-3 py-2 rounded-xl border hover:bg-surface/80 flex items-center gap-2",children:[t.jsx(Gr,{className:"w-4 h-4"})," 返回上一頁"]})]})]})})}function af({token:s}){const[a,l]=h.useState(""),[i,d]=h.useState(""),[u,f]=h.useState([]),[p,x]=h.useState(!1),[g,v]=h.useState(null),[b,j]=h.useState([]),[R,M]=h.useState(!1),E=(()=>{try{const B=localStorage.getItem("school_id");return B?Number(B):null}catch{return null}})(),S=(()=>{try{return localStorage.getItem("school_slug")||localStorage.getItem("current_school_slug")||localStorage.getItem("selected_school_slug")||""}catch{return""}})(),[k,C]=h.useState(S);h.useEffect(()=>{(async()=>{try{const B=await fetch("/api/schools",{cache:"no-store"});if(!B.ok)return;const w=await B.json();Array.isArray(w?.items)&&j(w.items)}catch{}})()},[]),h.useEffect(()=>{const B=w=>{try{const I=w?.detail?.slug??localStorage.getItem("school_slug")??"";C(I||"")}catch{}};return window.addEventListener("fk_school_changed",B),()=>window.removeEventListener("fk_school_changed",B)},[]),h.useEffect(()=>{R&&!k&&(S?C(S):localStorage.getItem("role")==="dev_admin"&&b.length>0&&C(b[0].slug))},[R,S,b,k]);async function N(B){if(B.preventDefault(),v(null),!a.trim()){v("請輸入標題");return}if(E||localStorage.getItem("role")==="dev_admin"){M(!0);return}await O("")}async function O(B){x(!0);try{const w=new FormData;w.set("title",a.trim()),w.set("content",i.trim()),B&&w.set("school_slug",B);try{console.log("[PostComposer] submit school_slug =",B||"(cross)")}catch{}u.forEach(J=>w.append("files",J));const I=await Ld("/api/posts/with-media",w),A=Pd(I);v("已送出，等待審核"),l(""),d(""),f([]),console.log("created:",A)}catch(w){w instanceof Cr?v(`送出失敗：${w.message}`):w instanceof Error?v(`送出失敗：${w.message}`):v("送出失敗：未知錯誤")}finally{x(!1),M(!1)}}return t.jsxs("form",{onSubmit:N,className:"space-y-4 max-w-2xl mx-auto",children:[R&&t.jsxs("div",{className:"fixed inset-0 z-50",children:[t.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>M(!1)}),t.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[92%] sm:w-[480px] rounded-2xl border border-border bg-surface shadow-2xl p-4",children:[t.jsx("h3",{className:"font-semibold dual-text mb-2",children:"選擇發文範圍"}),t.jsx("p",{className:"text-sm text-muted mb-3",children:"請確認要發佈到哪裡："}),t.jsxs("div",{className:"space-y-2 mb-3",children:[E&&t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"scope",checked:k===(b.find(B=>B.id===E)?.slug||""),onChange:()=>C(b.find(B=>B.id===E)?.slug||"")}),t.jsxs("span",{className:"text-sm",children:["我的學校：",b.find(B=>B.id===E)?.name||"（未知）"]})]}),localStorage.getItem("role")==="dev_admin"&&b.map(B=>t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"scope",checked:k===B.slug,onChange:()=>C(B.slug)}),t.jsx("span",{className:"text-sm",children:B.name})]},B.id)),t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"radio",name:"scope",checked:k==="",onChange:()=>C("")}),t.jsx("span",{className:"text-sm",children:"跨校（全部）"})]})]}),t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx("button",{type:"button",className:"btn-ghost text-sm",onClick:()=>M(!1),children:"取消"}),t.jsx("button",{type:"button",className:"btn-primary text-sm",onClick:()=>O(k),children:"確認送出"})]})]})]}),t.jsx("input",{className:"form-control",placeholder:"標題",value:a,onChange:B=>l(B.target.value),maxLength:80}),t.jsx("textarea",{className:"form-control min-h-[140px]",placeholder:"內容（可留空）",value:i,onChange:B=>d(B.target.value)}),t.jsx(Sp,{value:u,onChange:f,maxCount:6}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"text-sm text-muted",children:[u.length," 個附件"]}),t.jsxs("div",{className:"text-sm text-muted",children:["發文者：",t.jsx(bp,{showIcon:!0})]})]}),t.jsx("button",{type:"submit",disabled:p,className:"btn-primary disabled:opacity-60",children:p?"送出中…":"發佈"})]}),g&&t.jsx("div",{className:"text-sm text-warning",children:g})]})}function hj(){const[s,a]=h.useState(!1),l=localStorage.getItem("token")||"";return h.useEffect(()=>{const i=()=>{a(window.innerWidth<768)};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),h.useEffect(()=>{const i=document.documentElement;return i.getAttribute("data-theme")||i.setAttribute("data-theme","beige"),i.classList.add("theme-ready"),()=>i.classList.remove("theme-ready")},[]),s?t.jsxs("div",{className:"min-h-screen flex flex-col bg-bg",children:[t.jsx("header",{className:"sticky top-0 z-30 bg-surface/95 backdrop-blur border-b border-border px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Er,{to:"/boards",className:"w-8 h-8 rounded-full hover:bg-surface-hover flex items-center justify-center transition-colors",children:t.jsx(Gr,{className:"w-5 h-5"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h1",{className:"font-semibold text-lg text-fg",children:"發表貼文"}),t.jsx("p",{className:"text-sm text-muted",children:"匿名分享你的想法"})]})]})}),t.jsx("div",{className:"flex-1 p-4 pb-24",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 shadow-soft",children:[t.jsx(af,{token:l}),!l&&t.jsx("div",{className:"mt-4 p-3 rounded-xl bg-warning/10 border border-warning/20",children:t.jsxs("div",{className:"text-sm text-warning-text",children:[t.jsx("strong",{children:"匿名模式："})," 您目前以匿名身分發文，系統會以裝置識別碼標示來源。"]})})]})}),t.jsx(Ed,{})]}):t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/create"}),t.jsxs("main",{className:"mx-auto max-w-4xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:[t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft mb-4",children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-semibold dual-text",children:"發布新貼文"}),t.jsx("p",{className:"text-sm text-muted mt-1",children:"創建新的討論話題，支援文字、圖片和影片。"})]}),t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-4 sm:p-6 shadow-soft",children:[t.jsx(af,{token:l}),!l&&t.jsx("div",{className:"mt-4 p-3 rounded-xl bg-amber-50 dark:bg-amber-900/20 border border-amber-300 dark:border-amber-700",children:t.jsxs("div",{className:"text-sm text-amber-800 dark:text-amber-200",children:[t.jsx("strong",{children:"匿名模式："})," 您目前以匿名身分發文，系統會以裝置識別碼標示來源。如需管理權限，請先登入。"]})})]})]})]})}var fj={};const lf={name:"自訂主題",description:"由您設計的專屬主題",colors:{primary:"#3b82f6",secondary:"#6366f1",accent:"#f59e0b",background:"#ffffff",surface:"#f8fafc",text:"#1f2937",textMuted:"#6b7280",border:"#e5e7eb",success:"#10b981",warning:"#f59e0b",error:"#ef4444"},fonts:{heading:"system-ui, -apple-system, sans-serif",body:"system-ui, -apple-system, sans-serif",mono:"'JetBrains Mono', 'Fira Code', monospace"},borderRadius:"0.75rem",spacing:{xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem"},shadows:{sm:"0 1px 2px 0 rgb(0 0 0 / 0.05)",md:"0 4px 6px -1px rgb(0 0 0 / 0.1)",lg:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},animations:{duration:"150ms",easing:"cubic-bezier(0.4, 0, 0.2, 1)"}};function pj(){const{isLoggedIn:s,user:a}=rr(),l=en(),[i,d]=h.useState(lf),[u,f]=h.useState("colors"),[p,x]=h.useState(!1),[g,v]=h.useState([]);h.useEffect(()=>{try{const C=localStorage.getItem("forumkit_custom_themes");C&&v(JSON.parse(C))}catch(C){console.error("載入主題失敗:",C)}},[]);const b=(C,N)=>{d(O=>{const B={...O},w=C.split(".");let I=B;for(let A=0;A<w.length-1;A++)I=I[w[A]];return I[w[w.length-1]]=N,B})},j=()=>{const C=document.documentElement;Object.entries(i.colors).forEach(([N,O])=>{C.style.setProperty(`--color-${N.replace(/([A-Z])/g,"-$1").toLowerCase()}`,O)}),C.style.setProperty("--border-radius",i.borderRadius),C.style.setProperty("--font-heading",i.fonts.heading),C.style.setProperty("--font-body",i.fonts.body),C.style.setProperty("--font-mono",i.fonts.mono),C.style.setProperty("--animation-duration",i.animations.duration),C.style.setProperty("--animation-easing",i.animations.easing)},R=async()=>{if(!s){alert("請先登入以儲存主題");return}try{const N=[...g.filter(O=>O.name!==i.name),i];v(N),localStorage.setItem("forumkit_custom_themes",JSON.stringify(N)),alert("主題已儲存至個人資料！")}catch{alert("儲存失敗，請檢查瀏覽器設定")}},M=async()=>{try{const C=fj.REACT_APP_DISCORD_WEBHOOK_URL||localStorage.getItem("discord_webhook_url");if(!C){alert("未設定 Discord Webhook，無法提交到平台");return}const N={embeds:[{title:"🎨 新主題提交",description:"用戶提交了新的主題設計",color:parseInt(i.colors.primary.replace("#",""),16),fields:[{name:"主題名稱",value:i.name,inline:!0},{name:"作者",value:a?.username||"匿名用戶",inline:!0},{name:"說明",value:i.description||"無說明",inline:!1},{name:"主色調",value:i.colors.primary,inline:!0},{name:"輔助色",value:i.colors.secondary,inline:!0},{name:"強調色",value:i.colors.accent,inline:!0}],timestamp:new Date().toISOString(),footer:{text:"ForumKit 主題設計工具 by Serelix Studio"}}],content:`\`\`\`json
${JSON.stringify(i,null,2)}
\`\`\``};await fetch(C,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N)}),alert("主題已提交給開發團隊審核！")}catch{alert("提交失敗，請檢查網路連線")}},E=()=>{const C=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),N=URL.createObjectURL(C),O=document.createElement("a");O.href=N,O.download=`${i.name.replace(/[^a-zA-Z0-9]/g,"_")}_theme.json`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(N)},S=C=>{const N=C.target.files?.[0];if(!N)return;const O=new FileReader;O.onload=B=>{try{const w=JSON.parse(B.target?.result);d({...lf,...w}),alert("主題匯入成功！")}catch{alert("主題檔案格式錯誤")}},O.readAsText(N)};h.useEffect(()=>{p&&j()},[i,p]);const k=({label:C,path:N,value:O})=>t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-sm font-medium",children:C}),t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx("input",{type:"color",value:O,onChange:B=>b(N,B.target.value),className:"w-12 h-10 rounded border border-gray-300"}),t.jsx("input",{type:"text",value:O,onChange:B=>b(N,B.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded text-sm",placeholder:"#000000"})]})]});return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>l("/"),className:"p-2 hover:bg-gray-100 rounded-lg",children:t.jsx(Zt,{className:"w-5 h-5"})}),t.jsx(s0,{className:"w-6 h-6 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"ForumKit 主題設計工具"}),t.jsx("p",{className:"text-sm text-gray-600",children:"設計屬於您的專屬主題"})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:()=>x(!p),className:`px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-2 ${p?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[t.jsx(gs,{className:"w-4 h-4"}),p?"停止預覽":"即時預覽"]})})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:t.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[t.jsx(f0,{className:"w-5 h-5 text-purple-600"}),"主題資訊"]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"主題名稱"}),t.jsx("input",{type:"text",value:i.name,onChange:C=>b("name",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"我的專屬主題"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"主題描述"}),t.jsx("input",{type:"text",value:i.description,onChange:C=>b("description",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"簡短描述您的主題"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[t.jsx("div",{className:"border-b border-gray-200",children:t.jsx("nav",{className:"flex",children:[{key:"colors",label:"色彩配置",icon:"🎨"},{key:"typography",label:"字體設定",icon:"📝"},{key:"layout",label:"佈局樣式",icon:"📐"},{key:"effects",label:"效果動畫",icon:"✨"}].map(C=>t.jsxs("button",{onClick:()=>f(C.key),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${u===C.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[t.jsx("span",{className:"mr-2",children:C.icon}),C.label]},C.key))})}),t.jsxs("div",{className:"p-6",children:[u==="colors"&&t.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"font-medium text-gray-900",children:"主要色彩"}),t.jsx(k,{label:"主色調",path:"colors.primary",value:i.colors.primary}),t.jsx(k,{label:"輔助色",path:"colors.secondary",value:i.colors.secondary}),t.jsx(k,{label:"強調色",path:"colors.accent",value:i.colors.accent})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"font-medium text-gray-900",children:"背景色彩"}),t.jsx(k,{label:"背景色",path:"colors.background",value:i.colors.background}),t.jsx(k,{label:"卡片色",path:"colors.surface",value:i.colors.surface}),t.jsx(k,{label:"邊框色",path:"colors.border",value:i.colors.border})]})]}),u==="typography"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"標題字體"}),t.jsx("input",{type:"text",value:i.fonts.heading,onChange:C=>b("fonts.heading",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"system-ui, -apple-system, sans-serif"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"內文字體"}),t.jsx("input",{type:"text",value:i.fonts.body,onChange:C=>b("fonts.body",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"system-ui, -apple-system, sans-serif"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"等寬字體"}),t.jsx("input",{type:"text",value:i.fonts.mono,onChange:C=>b("fonts.mono",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"'JetBrains Mono', 'Fira Code', monospace"})]})]}),u==="layout"&&t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"圓角大小"}),t.jsx("input",{type:"text",value:i.borderRadius,onChange:C=>b("borderRadius",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"0.75rem"})]})}),u==="effects"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"動畫時間"}),t.jsx("input",{type:"text",value:i.animations.duration,onChange:C=>b("animations.duration",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"150ms"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"緩動效果"}),t.jsx("input",{type:"text",value:i.animations.easing,onChange:C=>b("animations.easing",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"cubic-bezier(0.4, 0, 0.2, 1)"})]})]})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"主題預覽"}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:i.colors.primary}}),t.jsx("span",{children:"主色調"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:i.colors.secondary}}),t.jsx("span",{children:"輔助色"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:i.colors.accent}}),t.jsx("span",{children:"強調色"})]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 space-y-3",children:[t.jsx("h3",{className:"font-medium text-gray-900",children:"操作選項"}),t.jsxs("button",{onClick:R,disabled:!s,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[t.jsx(Xa,{className:"w-4 h-4"}),"儲存至個人資料"]}),t.jsxs("button",{onClick:M,className:"w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center justify-center gap-2",children:[t.jsx(Jc,{className:"w-4 h-4"}),"提交給平台"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:E,className:"flex-1 px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 flex items-center justify-center gap-2",children:[t.jsx(md,{className:"w-4 h-4"}),"匯出"]}),t.jsxs("label",{className:"flex-1 px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 flex items-center justify-center gap-2 cursor-pointer",children:[t.jsx(Jc,{className:"w-4 h-4"}),"匯入",t.jsx("input",{type:"file",accept:".json",onChange:S,className:"hidden"})]})]})]}),g.length>0&&t.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"已儲存的主題"}),t.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:g.map((C,N)=>t.jsxs("button",{onClick:()=>d(C),className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50",children:[t.jsx("div",{className:"font-medium text-sm",children:C.name}),t.jsx("div",{className:"text-xs text-gray-600",children:C.description}),t.jsx("div",{className:"flex gap-1 mt-2",children:[C.colors.primary,C.colors.secondary,C.colors.accent].map((O,B)=>t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:O}},B))})]},N))})]}),t.jsxs("div",{className:"bg-blue-50 rounded-xl border border-blue-200 p-4",children:[t.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"使用說明"}),t.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[t.jsx("li",{children:"• 修改設定後點擊「即時預覽」查看效果"}),t.jsx("li",{children:"• 登入用戶可將主題儲存至個人資料"}),t.jsx("li",{children:"• 「提交給平台」會將主題發送給開發團隊"}),t.jsx("li",{children:"• 可匯出主題檔案分享給其他用戶"})]})]})]})]})})]})}function of({children:s}){const{isLoggedIn:a}=rr();return a?t.jsx(t.Fragment,{children:s}):t.jsx(Uc,{to:"/auth",replace:!0})}function jr({children:s,allow:a}){const{isLoggedIn:l,role:i}=rr();return l?a.includes(i)?t.jsx(t.Fragment,{children:s}):t.jsx(Uc,{to:"/403",replace:!0}):t.jsx(Uc,{to:"/auth",replace:!0})}function et(){const s=Lf();let a="未知錯誤",l;if(Yn(s)){l=s.status;try{const i=s.data;a=Lo(l,i,`${s.status} ${s.statusText||""}`.trim())}catch{a=Lo(l,void 0,`${s.status} ${s.statusText||""}`.trim())}}else s instanceof Error?a=s.message:s&&typeof s=="object"&&(a=s?.message?String(s.message):JSON.stringify(s));return t.jsx(Ys,{status:l,message:a})}function xj(){const s=()=>{window.location.href="/api/auth/google/login"},a=()=>{window.location.href="/"};return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/error"}),t.jsx(at,{}),t.jsx("main",{className:"mx-auto max-w-6xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:t.jsx("div",{className:"max-w-lg mx-auto",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 sm:p-8 shadow-soft text-center",children:[t.jsx("div",{className:"mx-auto w-16 h-16 rounded-2xl bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center mb-4",children:t.jsx(ct,{className:"w-8 h-8 text-amber-700 dark:text-amber-300"})}),t.jsx("div",{className:"text-sm text-muted mb-2",children:"校外帳號登入錯誤"}),t.jsx("h1",{className:"text-2xl font-bold dual-text mb-3",children:"無法使用校外帳號"}),t.jsxs("div",{className:"text-sm text-muted mb-6 space-y-2",children:[t.jsx("p",{children:"您選擇的校外帳號目前無法使用，可能的原因："}),t.jsxs("ul",{className:"text-left space-y-1",children:[t.jsx("li",{children:"• 該學校的認證服務暫時不可用"}),t.jsx("li",{children:"• 網路連線問題"}),t.jsx("li",{children:"• 該學校尚未加入跨校聯盟"})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[t.jsxs("button",{onClick:s,className:"btn-primary flex items-center justify-center gap-2 px-4 py-2",children:[t.jsx(_t,{className:"w-4 h-4"}),"重新嘗試"]}),t.jsxs("button",{onClick:a,className:"btn-secondary flex items-center justify-center gap-2 px-4 py-2",children:[t.jsx(Zt,{className:"w-4 h-4"}),"回到首頁"]})]}),t.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:t.jsx("p",{className:"text-xs text-muted",children:"如需協助，請聯繫您的學校管理員或系統管理員"})})]})})})]})}function gj(){const[s]=Nv(),a=s.get("mode"),l=()=>{window.location.href="/api/auth/google/login"},i=()=>{window.location.href="/"},u=(()=>{switch(a){case"single":return{title:"單一模式限制",description:"目前系統處於單一模式，僅允許指定帳號登入",details:["• 僅允許系統指定的單一管理員帳號","• 其他用戶暫時無法登入","• 請聯繫系統管理員確認登入權限"]};case"admin_only":return{title:"管理組模式限制",description:"目前系統處於管理組模式，僅允許管理員登入",details:["• 僅允許管理員帳號登入","• 一般用戶暫時無法登入","• 請聯繫系統管理員確認登入權限"]};default:return{title:"登入限制",description:"目前系統限制登入功能",details:["• 系統暫時限制登入功能","• 請稍後再試或聯繫管理員","• 如有緊急需求請聯繫系統管理員"]}}})();return t.jsxs("div",{className:"min-h-screen",children:[t.jsx(Ge,{pathname:"/error"}),t.jsx(at,{}),t.jsx("main",{className:"mx-auto max-w-6xl px-3 sm:px-4 pt-20 sm:pt-24 md:pt-28 pb-8",children:t.jsx("div",{className:"max-w-lg mx-auto",children:t.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6 sm:p-8 shadow-soft text-center",children:[t.jsx("div",{className:"mx-auto w-16 h-16 rounded-2xl bg-red-100 dark:bg-red-900/30 flex items-center justify-center mb-4",children:t.jsx(Wf,{className:"w-8 h-8 text-red-700 dark:text-red-300"})}),t.jsx("div",{className:"text-sm text-muted mb-2",children:"登入限制"}),t.jsx("h1",{className:"text-2xl font-bold dual-text mb-3",children:u.title}),t.jsxs("div",{className:"text-sm text-muted mb-6 space-y-2",children:[t.jsx("p",{children:u.description}),t.jsx("ul",{className:"text-left space-y-1",children:u.details.map((f,p)=>t.jsx("li",{children:f},p))})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[t.jsxs("button",{onClick:l,className:"btn-primary flex items-center justify-center gap-2 px-4 py-2",children:[t.jsx(_t,{className:"w-4 h-4"}),"重新嘗試"]}),t.jsxs("button",{onClick:i,className:"btn-secondary flex items-center justify-center gap-2 px-4 py-2",children:[t.jsx(Zt,{className:"w-4 h-4"}),"回到首頁"]})]}),t.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:t.jsx("p",{className:"text-xs text-muted",children:"如需協助，請聯繫系統管理員"})})]})})})]})}Eb().catch(console.error);const yj=Cb();window.addEventListener("beforeunload",()=>{yj()});const vj=xv([{path:"/",element:t.jsx(Jb,{}),errorElement:t.jsx(et,{})},{path:"/auth",element:t.jsx(Yb,{}),errorElement:t.jsx(et,{})},{path:"/error/external-account",element:t.jsx(xj,{}),errorElement:t.jsx(et,{})},{path:"/error/login-restricted",element:t.jsx(gj,{}),errorElement:t.jsx(et,{})},{path:"/boards",element:t.jsx(Zb,{}),errorElement:t.jsx(et,{})},{path:"/about",element:t.jsx(dj,{}),errorElement:t.jsx(et,{})},{path:"/rules",element:t.jsx(uj,{}),errorElement:t.jsx(et,{})},{path:"/support",element:t.jsx(ij,{}),errorElement:t.jsx(et,{})},{path:"/posts/:id",element:t.jsx(Ep,{}),errorElement:t.jsx(et,{})},{path:"/theme-designer",element:t.jsx(pj,{}),errorElement:t.jsx(et,{})},{path:"/403",element:t.jsx(mj,{}),errorElement:t.jsx(et,{})},{path:"/create",element:t.jsx(of,{children:t.jsx(hj,{})}),errorElement:t.jsx(et,{})},{path:"/settings/profile",element:t.jsx(of,{children:t.jsx(nf,{})}),errorElement:t.jsx(et,{})},{path:"/mode",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin"],children:t.jsx(Gb,{})}),errorElement:t.jsx(et,{})},{path:"/admin",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"],children:t.jsx(tj,{})}),errorElement:t.jsx(et,{})},{path:"/admin/moderation",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"],children:t.jsx(ej,{})}),errorElement:t.jsx(et,{})},{path:"/admin/comments",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"],children:t.jsx(Cp,{})}),errorElement:t.jsx(et,{})},{path:"/my-violations",element:t.jsx(rj,{}),errorElement:t.jsx(et,{})},{path:"/admin/users",element:t.jsx(jr,{allow:["dev_admin","campus_admin"],children:t.jsx(sj,{})}),errorElement:t.jsx(et,{})},{path:"/admin/schools",element:t.jsx(jr,{allow:["dev_admin","campus_admin"],children:t.jsx(nj,{})}),errorElement:t.jsx(et,{})},{path:"/admin/integrations",element:t.jsx(jr,{allow:["dev_admin","cross_admin","campus_admin"],children:t.jsx(aj,{})}),errorElement:t.jsx(et,{})},{path:"/admin/pages",element:t.jsx(jr,{allow:["dev_admin","cross_admin","campus_admin"],children:t.jsx(lj,{})}),errorElement:t.jsx(et,{})},{path:"/admin/chat",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"],children:t.jsx(_p,{})}),errorElement:t.jsx(et,{})},{path:"/admin/events",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin","campus_moderator","cross_moderator"],children:t.jsx(oj,{})}),errorElement:t.jsx(et,{})},{path:"/admin/support",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin"],children:t.jsx(cj,{})}),errorElement:t.jsx(et,{})},{path:"/settings/admin",element:t.jsx(jr,{allow:["dev_admin","campus_admin","cross_admin"],children:t.jsx(nf,{})}),errorElement:t.jsx(et,{})}]);jg.createRoot(document.getElementById("root")).render(t.jsx(pg.StrictMode,{children:t.jsx(Lb,{children:t.jsx(Lv,{router:vj})})}));
